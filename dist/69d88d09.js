import{Q as w}from"./c0fd0898.js";import{Q as O}from"./c2746639.js";import{Q as N}from"./11ec1272.js";import{_ as b,A as m,o as d,x as r,h as n,dM as I,i as t,q as g,p,t as a,C as _,F as L,e as A,f as y,a7 as C,l as q,z as T,g as v,j as k,R as S}from"./7e207d24.js";import{x as j,h as R}from"./3829acca.js";import{I as f}from"./3b66e605.js";import{m as B}from"./8b740bdb.js";import{F as D}from"./75fe3d73.js";import"./48c23d68.js";import"./f0595305.js";import"./e96a218e.js";import"./aad6f44a.js";import"./1a2e572b.js";import"./99821dad.js";import"./fa5db05f.js";import"./3320b391.js";import"./d613a77f.js";import"./443638d3.js";import"./2fb128e4.js";import"./36cdb1ed.js";const F={name:"AgentsSelector",components:{Icon:f},props:{agents:{type:Array,required:!0},loading:{type:Boolean,default:!1}},data(){return{selectedIndex:0}},computed:{currentAgent(){return this.agents[this.selectedIndex]}},methods:{prevAgent(){this.selectedIndex>0&&this.selectedIndex--},nextAgent(){this.selectedIndex<this.agents.length-1&&this.selectedIndex++},getStatusClass(s){return{online:"bg-green-100 text-green-800 border-green-400",offline:"bg-red-100 text-red-800 border-red-400",overdue:"bg-yellow-100 text-yellow-800 border-yellow-400"}[s?.toLowerCase()]||"bg-gray-100 text-gray-800 border-gray-400"},getOSIcon(s){const e=s?.toLowerCase();return e.includes("windows")?"lucide:monitor":e.includes("linux")?"lucide:terminal":e.includes("mac")?"lucide:laptop":"lucide:help-circle"},async pingAgent(s){j(s.agent_id)}}},M={key:0,class:"text-center q-pa-md"},W={key:1,style:{"max-height":"300px"},class:"text-center overflow-auto"},H={class:"row items-center justify-center q-gutter-sm"},P=["disabled"],Q={class:"hostname-selector"},V=["disabled"],U={class:"text-sm text-gray-500 mt-1"},z={class:"ac jsb quick-item"},E={class:"flex items-center gap-1 quick-item-content"},Y={key:0,class:"ac jsb quick-item"},G={class:"flex items-center gap-1 quick-item-content"},J={class:"bg-yellow-100 text-yellow-800 text-xs font-medium me-2 px-2.5 py-0.5 rounded-sm border-yellow-400"},K={key:1,class:"ac jsb quick-item"},X={class:"flex items-center gap-1 quick-item-content"},Z={class:"bg-blue-100 text-blue-800 text-xs font-medium me-2 px-2.5 py-0.5 rounded-sm border-blue-400"},$={key:2,class:"ac jsb quick-item"},tt={class:"flex items-center gap-1 quick-item-content"},et={class:"bg-red-100 text-red-800 text-xs font-medium me-2 px-2.5 py-0.5 rounded-sm"},st={key:3,class:"ac jsb quick-item"},it={class:"flex items-center gap-1 quick-item-content"},nt={class:"bg-yellow-100 text-yellow-800 text-xs font-medium me-2 px-2.5 py-0.5 rounded-sm border-yellow-400"},ot={class:"ac jsb quick-item"},at={class:"flex items-center gap-1 quick-item-content"},dt={class:"bg-gray-100 text-gray-800 text-xs font-medium me-2 px-2.5 py-0.5 rounded-sm ac gap-2"},lt={key:2,class:"text-center q-pa-md"};function ct(s,e,l,u,c,i){const o=m("Icon");return d(),r(L,null,[l.loading?(d(),r("div",M,[n(I,{color:"primary",size:"32px"}),e[2]||(e[2]=t("div",{class:"text-grey"},"Loading agents...",-1))])):g("",!0),l.agents.length?(d(),r("div",W,[t("div",H,[t("button",{disabled:l.agents.length<=1||c.selectedIndex===0,onClick:e[0]||(e[0]=(...h)=>i.prevAgent&&i.prevAgent(...h)),class:"btn btn-none-primary"},[n(o,{icon:"lucide:chevron-left",class:"icon",width:"20",height:"20"})],8,P),t("div",Q,[n(o,{icon:"lucide:monitor",class:"icon",width:"16",height:"16"}),p(" "+a(i.currentAgent.hostname),1)]),t("button",{disabled:l.agents.length<=1||c.selectedIndex===l.agents.length-1,onClick:e[1]||(e[1]=(...h)=>i.nextAgent&&i.nextAgent(...h)),class:"btn btn-none-primary"},[n(o,{icon:"lucide:chevron-right",class:"icon",width:"20",height:"20"})],8,V)]),t("div",U,a(c.selectedIndex+1)+" of "+a(l.agents.length),1),t("div",z,[t("div",E,[n(o,{icon:"lucide:activity",width:"16",height:"16"}),e[3]||(e[3]=t("span",null,"Status",-1))]),t("div",{class:_([i.getStatusClass(i.currentAgent.status),"text-xs font-medium me-2 px-2.5 py-0.5 rounded-sm"])},a(i.currentAgent.status),3)]),i.currentAgent.logged_username&&i.currentAgent.logged_username!==""?(d(),r("div",Y,[t("div",G,[n(o,{icon:"lucide:user",width:"16",height:"16"}),e[4]||(e[4]=t("span",null,"Logged User",-1))]),t("div",J,a(i.currentAgent.logged_username),1)])):g("",!0),i.currentAgent.local_ips&&i.currentAgent.local_ips!==""?(d(),r("div",K,[t("div",X,[n(o,{icon:"mdi:public",width:"16",height:"16"}),e[5]||(e[5]=t("span",null,"Local IP",-1))]),t("div",Z,a(i.currentAgent.local_ips),1)])):g("",!0),i.currentAgent.needsReboot&&i.currentAgent.needsReboot!==""?(d(),r("div",$,[t("div",tt,[n(o,{icon:"lucide:refresh-ccw",width:"16",height:"16"}),e[6]||(e[6]=t("span",null,"Needs Reboot",-1))]),t("div",et,a(i.currentAgent.needsReboot?"YES":"NO"),1)])):g("",!0),i.currentAgent.maintenance_mode?(d(),r("div",st,[t("div",it,[n(o,{icon:"lucide:construction",width:"16",height:"16"}),e[7]||(e[7]=t("span",null,"Is in Maintenance",-1))]),t("div",nt,a(i.currentAgent.maintenance_mode?"Yes":"No"),1)])):g("",!0),t("div",ot,[t("div",at,[n(o,{icon:"lucide:cpu",width:"16",height:"16"}),e[8]||(e[8]=t("span",null,"Operating System",-1))]),t("div",dt,a(i.currentAgent.plat),1)])])):(d(),r("div",lt,e[9]||(e[9]=[t("div",{class:"text-grey"},"No agents found",-1)])))],64)}var rt=b(F,[["render",ct]]);const ht={components:{apexchart:B}},mt=Object.assign(ht,{__name:"Radial",props:{value:{type:Number,required:!0},width:{type:[Number,String],default:300},color:{type:String,default:"primary",validator:s=>["primary","success","warning","danger"].includes(s)}},setup(s){const e=s,l={primary:"#2563eb",success:"#60c063",warning:"#ffbb00",danger:"#f44336"},u=A(()=>l[e.color]),c=A(()=>({chart:{type:"radialBar",sparkline:{enabled:!0}},plotOptions:{radialBar:{startAngle:0,endAngle:360,hollow:{margin:0,size:"82%",background:"transparent"},track:{background:"#f0f0f0",strokeWidth:"58%",dropShadow:{enabled:!0,left:0,blur:5,opacity:.4,color:u.value}},dataLabels:{name:{show:!1},value:{show:!0,fontSize:"48px",color:u.value,fontFamily:"Albert",fontWeight:"600",formatter:i=>`${parseInt(i)}%`}}}},fill:{type:"solid",colors:[u.value]},stroke:{lineCap:"round"},labels:[""]}));return(i,o)=>{const h=m("apexchart");return d(),y(h,{type:"radialBar",width:s.width,series:[s.value],options:c.value},null,8,["width","series","options"])}}}),ut={name:"AgentStats",components:{Icon:f,AgentsList:rt,Radial:mt},data(){return{agents:[],users:null,isLoading:!0}},computed:{totalAgents(){return Array.isArray(this.agents)?this.agents.length:0},onlineAgents(){return Array.isArray(this.agents)?this.agents.filter(s=>s?.status==="online").length:0},onlineAgentsPercent(){const s=Number(this.totalAgents),e=Number(this.onlineAgents);return!Number.isFinite(s)||!Number.isFinite(e)||s===0?0:e/s*100},offlineAgents(){const s=Number(this.totalAgents),e=Number(this.onlineAgents);return Number.isFinite(s)&&Number.isFinite(e)?s-e:0},totalServers(){return Array.isArray(this.agents)?this.agents.filter(s=>s?.monitoring_type==="server").length:0},serversOnline(){return Array.isArray(this.agents)?this.agents.filter(s=>s?.monitoring_type==="server"&&s?.status==="online").length:0},totalWorkstations(){return Array.isArray(this.agents)?this.agents.filter(s=>s?.monitoring_type==="workstation").length:0},workstationsOnline(){return Array.isArray(this.agents)?this.agents.filter(s=>s?.monitoring_type==="workstation"&&s?.status==="online").length:0},totalWindows(){return Array.isArray(this.agents)?this.agents.filter(s=>s?.plat==="windows").length:0},totalLinux(){return Array.isArray(this.agents)?this.agents.filter(s=>s?.plat==="linux").length:0},totalMac(){return Array.isArray(this.agents)?this.agents.filter(s=>s?.plat==="mac").length:0},totalInMaintenanceMode(){return Array.isArray(this.agents)?this.agents.filter(s=>s?.maintenance_mode===!0).length:0},totalUsers(){return Array.isArray(this.users)?this.users.length:0},usersLoggedToday(){if(!Array.isArray(this.users))return 0;const s=new Date().toISOString().split("T")[0];return this.users.filter(e=>{const l=e?.last_login;return typeof l=="string"&&l.startsWith(s)}).length}},methods:{async loadAgents(){try{const s=await R();this.agents=Array.isArray(s)?s:[]}catch(s){console.error("Erro ao buscar agents:",s),this.agents=[]}},async loadUsers(){try{const s=await this.$axios.get("/accounts/users/");this.users=Array.isArray(s.data)?s.data:[]}catch(s){console.error("Erro ao buscar usu\xE1rios:",s),this.users=[]}},async refresh(){this.isLoading=!0,await Promise.all([this.loadAgents(),this.loadUsers()]),this.isLoading=!1}},mounted(){this.refresh(),C(()=>import("./228f4868.js"),["228f4868.js","871c5d27.css","7e207d24.js","2a510db4.css","c0fd0898.js","48c23d68.js","c2746639.js","75fe3d73.js","1dc1ae9c.css","f0595305.js","3829acca.js","1a2e572b.js","8b740bdb.js","ecc27f7e.css","e96a218e.js","aad6f44a.js","99821dad.js","fa5db05f.js","3b66e605.js","3320b391.js","130ac0aa.css","d613a77f.js","443638d3.js","2fb128e4.js","36cdb1ed.js","11ec1272.js","33631941.js","2fef4b81.css","5addef8f.js"])}},gt={class:"dash-title-container ac gap-1 p-2 mb-2 jsb"},_t={key:0,class:"p-3 w-full ac jc"},vt={key:1,class:""},yt={class:"row"},pt={class:"col-xl-6 col-lg-6 col-md-12 col-sm-12 p-1"},xt={style:{height:"350px"},class:"dash-card"},bt={class:"card-body"},ft={class:"row"},wt={class:"col col-xl-4 col-md-6 ac jc flex-col"},At={class:"text-sm typing-container"},kt={class:"font-semibold text-success"},St={class:"col col-xl-8 col-md-6 flex flex-col"},It={class:"dash-item"},Lt={class:"dash-item-content"},Ot={class:"dash-item-icon"},Nt={class:"dash-item-value bg-success"},Ct={class:"dash-item"},qt={class:"dash-item-content"},Tt={class:"dash-item-icon"},jt={class:"dash-item-value bg-red-500"},Rt={class:"dash-item"},Bt={class:"dash-item-content"},Dt={class:"dash-item-icon"},Ft={class:"dash-item-value bg-yellow-500"},Mt={class:"dash-item"},Wt={class:"dash-item-content"},Ht={class:"dash-item-icon"},Pt={class:"dash-item-value bg-blue-500"},Qt={class:"col-xl-6 col-lg-6 col-md-12 col-sm-12 p-1"},Vt={style:{height:"350px"},class:"dash-card"},Ut={class:"card-body"},zt={key:0,class:"row"},Et={class:"col-xl-4 col-lg-4 col-md-6 col-sm-12 p-1"},Yt={style:{height:"350px"},class:"dash-card md:mt-2 xl:mt-0 lg:mt-0"},Gt={class:"card-body"},Jt={class:"dash-item"},Kt={class:"dash-item-content"},Xt={class:"dash-item-icon"},Zt={class:"dash-item-value bg-blue-600"},$t={class:"dash-item"},te={class:"dash-item-content"},ee={class:"dash-item-icon"},se={class:"dash-item-value bg-red-800"},ie={class:"dash-item"},ne={class:"dash-item-content"},oe={class:"dash-item-icon"},ae={class:"dash-item-value bg-gray-900"},de={class:"col-xl-4 col-lg-4 col-md-6 col-sm-12 p-1"},le={style:{height:"350px"},class:"dash-card"},ce={class:"card-body"},re={class:"dash-item"},he={class:"dash-item-content"},me={class:"dash-item-icon"},ue={class:"dash-item-value bg-blue-500"},ge={class:"dash-item mb-2"},_e={class:"dash-item-content"},ve={class:"dash-item-icon"},ye={class:"dash-item-value bg-success"},pe={class:"dash-item"},xe={class:"dash-item-content"},be={class:"dash-item-icon"},fe={class:"dash-item-value bg-blue-500"},we={class:"dash-item"},Ae={class:"dash-item-content"},ke={class:"dash-item-icon"},Se={class:"dash-item-value bg-success"},Ie={class:"col-xl-4 col-lg-4 col-md-6 col-sm-12 p-1"},Le={style:{height:"350px"},class:"dash-card"},Oe={class:"card-body"},Ne={class:"dash-item"},Ce={class:"dash-item-content"},qe={class:"dash-item-icon"},Te={class:"dash-item-value bg-blue-500"},je={class:"dash-item"},Re={class:"dash-item-content"},Be={class:"dash-item-icon"},De={class:"dash-item-value bg-success"};function Fe(s,e,l,u,c,i){const o=m("Icon"),h=m("Radial"),x=m("AgentsList");return d(),r(L,null,[t("div",gt,[e[0]||(e[0]=t("div",{class:"dash-title text-sm text-blue-500 font-semibold"},"Home",-1)),n(o,{class:"icon text-lg cursor-pointer text-primary",icon:"lucide:rotate-cw",onClick:i.refresh},null,8,["onClick"])]),c.isLoading?(d(),r("div",_t,[n(I,{color:"primary",size:"1em"})])):(d(),r("div",vt,[t("div",yt,[t("div",pt,[t("div",xt,[e[6]||(e[6]=t("div",{class:"card-header"},[t("div",{class:"text-h6 font-semibold text-center"},"Devices Status")],-1)),t("div",bt,[t("div",ft,[t("div",wt,[n(h,{color:"success",value:i.onlineAgentsPercent,width:230},null,8,["value"]),t("div",At,[t("span",kt,a(i.onlineAgentsPercent)+"%",1),e[1]||(e[1]=p(" of devices online "))])]),t("div",St,[t("div",It,[t("div",Lt,[t("div",Ot,[n(o,{icon:"lucide:check-circle",class:"icon text-green-800",width:"24",height:"24"})]),e[2]||(e[2]=t("div",{class:"dash-item-title"},"Online",-1))]),t("div",Nt,a(i.onlineAgents),1)]),t("div",Ct,[t("div",qt,[t("div",Tt,[n(o,{icon:"lucide:x-circle",class:"icon text-red-800",width:"24",height:"24"})]),e[3]||(e[3]=t("div",{class:"dash-item-title"},"Offline",-1))]),t("div",jt,a(i.offlineAgents),1)]),t("div",Rt,[t("div",Bt,[t("div",Dt,[n(o,{icon:"lucide:construction",class:"icon text-yellow-700",width:"24",height:"24"})]),e[4]||(e[4]=t("div",{class:"dash-item-title"},"In Maintenance",-1))]),t("div",Ft,a(i.totalInMaintenanceMode),1)]),t("div",Mt,[t("div",Wt,[t("div",Ht,[n(o,{icon:"lucide:monitor",class:"icon text-blue-800",width:"24",height:"24"})]),e[5]||(e[5]=t("div",{class:"dash-item-title"},"Total",-1))]),t("div",Pt,a(i.totalAgents),1)])])])])])]),t("div",Qt,[t("div",Vt,[e[7]||(e[7]=t("div",{class:"card-header"},[t("div",{class:"text-h6 font-semibold text-center"},"Quick View")],-1)),t("div",Ut,[n(x,{loading:c.isLoading,agents:c.agents},null,8,["loading","agents"])])])])]),c.users&&c.agents?(d(),r("div",zt,[t("div",Et,[t("div",Yt,[e[11]||(e[11]=t("div",{class:"card-header"},[t("div",{class:"text-h6 font-semibold"},"Operating Systems")],-1)),t("div",Gt,[t("div",Jt,[t("div",Kt,[t("div",Xt,[n(o,{icon:"mdi:windows",class:"icon text-blue-500",width:"26",height:"26"})]),e[8]||(e[8]=t("div",{class:"dash-item-title"},"Windows Devices",-1))]),t("div",Zt,a(i.totalWindows),1)]),t("div",$t,[t("div",te,[t("div",ee,[n(o,{icon:"fa:linux",class:"icon text-red-800",width:"26",height:"26"})]),e[9]||(e[9]=t("div",{class:"dash-item-title"},"Linux Devices",-1))]),t("div",se,a(i.totalLinux),1)]),t("div",ie,[t("div",ne,[t("div",oe,[n(o,{icon:"fa:apple",class:"icon text-gray-500",width:"26",height:"26"})]),e[10]||(e[10]=t("div",{class:"dash-item-title"},"Mac Devices",-1))]),t("div",ae,a(i.totalMac),1)])])])]),t("div",de,[t("div",le,[e[16]||(e[16]=t("div",{class:"card-header"},[t("div",{class:"text-h6 font-semibold"},"Servers & Workstations")],-1)),t("div",ce,[t("div",re,[t("div",he,[t("div",me,[n(o,{icon:"lucide:server",class:"icon text-blue-800",width:"24",height:"24"})]),e[12]||(e[12]=t("div",{class:"dash-item-title"},"Total Servers",-1))]),t("div",ue,a(i.totalServers),1)]),t("div",ge,[t("div",_e,[t("div",ve,[n(o,{icon:"lucide:check-circle",class:"icon text-green-800",width:"24",height:"24"})]),e[13]||(e[13]=t("div",{class:"dash-item-title"},"Servers Online",-1))]),t("div",ye,a(i.serversOnline),1)]),n(q,{class:"my-2 opacity-40"}),t("div",pe,[t("div",xe,[t("div",be,[n(o,{icon:"lucide:server-cog",class:"icon text-blue-800",width:"24",height:"24"})]),e[14]||(e[14]=t("div",{class:"dash-item-title"},"Total Workstations",-1))]),t("div",fe,a(i.totalWorkstations),1)]),t("div",we,[t("div",Ae,[t("div",ke,[n(o,{icon:"lucide:check-circle",class:"icon text-green-800",width:"24",height:"24"})]),e[15]||(e[15]=t("div",{class:"dash-item-title"},"Workstations Online",-1))]),t("div",Se,a(i.workstationsOnline),1)])])])]),t("div",Ie,[t("div",Le,[e[19]||(e[19]=t("div",{class:"card-header"},[t("div",{class:"text-h6 font-semibold"},"Users")],-1)),t("div",Oe,[t("div",Ne,[t("div",Ce,[t("div",qe,[n(o,{icon:"mdi:account",class:"icon text-blue-800",width:"24",height:"24"})]),e[17]||(e[17]=t("div",{class:"dash-item-title"},"Total Users",-1))]),t("div",Te,a(i.totalUsers),1)]),t("div",je,[t("div",Re,[t("div",Be,[n(o,{icon:"mdi:account-clock",class:"icon text-green-800",width:"24",height:"24"})]),e[18]||(e[18]=t("div",{class:"dash-item-title"},"Logged in Today",-1))]),t("div",De,a(i.usersLoggedToday),1)])])])])])):g("",!0)]))],64)}var Me=b(ut,[["render",Fe]]);const We={name:"SidebarOnlyView",components:{NewDash:Me,Icon:f,FileBar:D},computed:{sidebarOpen:{get(){return this.$store.state.sidebarOpen},set(s){this.$store.commit("setSidebarOpen",s)}},...T({clientsTree:s=>s.tree,treeReady:s=>s.treeReady,selectedTree:{get(){return this.$store.state.selectedTree},set(s){this.$store.commit("setSelectedTree",s)}}}),allClientsActive(){return this.selectedTree===""},isSysadmin(){return this.$route.path==="/sysadmin"},isHome(){return this.$route.path==="/"}},methods:{goSysadmin(){this.$router.push("/sysadmin")},goHome(){this.$router.push("/")},getCustomIcon(){return"BusinessIcon"},clearTreeSelected(){this.$store.dispatch("refreshDashboard",!0)}},mounted(){this.$store.dispatch("loadTree")}},He={class:"flex flex-nowrap"},Pe={class:"dash-layout"};function Qe(s,e,l,u,c,i){const o=m("FileBar"),h=m("Icon"),x=m("NewDash");return d(),y(N,null,{default:v(()=>[n(o),t("div",He,[t("div",{class:_(["sidebar scroll sidebar-transition",{"sidebar-open":i.sidebarOpen,"sidebar-closed":!i.sidebarOpen}])},[n(O,{class:"p-2.5"},{default:v(()=>[k((d(),y(w,{class:"clients-nav mb-2",clickable:"",active:i.isHome,hover:"",onClick:i.goHome},{default:v(()=>[t("div",{class:_(["ac js semibold ",i.isHome?"active":""])},[t("div",{class:_(["ac",{"active-icon":i.isHome}])},[n(h,{icon:"lucide:house",class:"svg home-svg",width:"24",height:"24"})],2),e[0]||(e[0]=p(" Home "))],2)]),_:1},8,["active","onClick"])),[[S]]),k((d(),y(w,{class:"clients-nav mb-2",clickable:"",active:i.isSysadmin,hover:"",to:{path:"/sysadmin"}},{default:v(()=>[t("div",{class:_(["ac js semibold",i.isSysadmin?"active":""])},[t("div",{class:_(["ac",{"active-icon":i.isSysadmin}])},[n(h,{icon:"lucide:monitor-cog",class:"svg home-svg",width:"24",height:"24"})],2),e[1]||(e[1]=p(" Sysadmin "))],2)]),_:1},8,["active"])),[[S]])]),_:1})],2),t("div",Pe,[n(x)])])]),_:1})}var cs=b(We,[["render",Qe]]);export{cs as default};
