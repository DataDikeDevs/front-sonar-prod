import{N as f,bB as m,a as h,bd as x,_ as H,r as y,e as A,o as g,f as p,bC as C,B as E,g as d,bD as w,bE as P,bF as S,bG as v,h as b,p as _,t as M,x as V,q as c,bH as k}from"./5ab24b2e.js";import{Q as B,b as D,a as Y}from"./ecaf8470.js";import{Q as L}from"./f74f6403.js";function T(e){var t=e*1e3,r=new Date,o=60*1e3,s=o*60,i=s*24,a=i*30,u=i*365,n=r-t;return n<o?Math.round(n/1e3)+" seconds ago":n<s?Math.round(n/o)+" minutes ago":n<i?Math.round(n/s)+" hours ago":n<a?Math.round(n/i)+" days ago":n<u?Math.round(n/a)+" months ago":Math.round(n/u)+" years ago"}var W={methods:{bootTime(e){return T(e)},alertTime(e){return T(e)},notifySuccess(e,t=2e3){f.create({type:"positive",message:e,timeout:t})},notifyError(e,t=2e3){f.create({type:"negative",message:e,timeout:t})},notifyWarning(e,t=2e3){f.create({type:"warning",message:e,timeout:t})},notifyInfo(e,t=2e3){f.create({type:"info",message:e,timeout:t})},isValidThreshold(e,t,r=!1){return e===0&&t===0?(f.create({type:"negative",timeout:2e3,message:"Warning Threshold or Error Threshold need to be set"}),!1):!r&&e>t&&e>0&&t>0?(f.create({type:"negative",timeout:2e3,message:"Warning Threshold must be less than Error Threshold"}),!1):r&&e<t&&e>0&&t>0?(f.create({type:"negative",timeout:2e3,message:"Warning Threshold must be more than Error Threshold"}),!1):!0},isValidEmail(e){return/^(?=[a-zA-Z0-9@._%+-]{6,254}$)[a-zA-Z0-9._%+-]{1,64}@(?:[a-zA-Z0-9-]{1,63}\.){1,8}[a-zA-Z]{2,63}$/.test(e)},unixToString(e){if(!e)return"";let t=new Date(e*1e3);return m.formatDate(t,"MMM-D-YYYY - HH:mm")},dateStringToUnix(e){if(!e)return 0;const t=m.extractDate(e,"MM DD YYYY HH:mm");return parseInt(m.formatDate(t,"X"))},formatDjangoDate(e){if(!e)return"";const t=m.extractDate(e,"MM DD YYYY HH:mm");return m.formatDate(t,"MMM-DD-YYYY - HH:mm")},formatClientOptions(e){return e.map(t=>({label:t.name,value:t.id,sites:t.sites}))},formatSiteOptions(e){return e.map(t=>({label:t.name,value:t.id}))},capitalize(e){return e[0].toUpperCase()+e.substring(1)},getCustomFields(e){return h.patch("/core/customfields/",{model:e})},getAgentCount(e,t,r){if(t==="client")return e.find(o=>r===o.id).agent_count;{const o=e.map(s=>s.sites);for(let s of o)for(let i of s)if(i.id===r)return i.agent_count;return 0}},formatCustomFields(e,t){let r=[];for(let o of e)o.type==="multiple"?r.push({multiple_value:t[o.name],field:o.id}):o.type==="checkbox"?r.push({bool_value:t[o.name],field:o.id}):r.push({string_value:t[o.name],field:o.id});return r},async getScriptOptions(e=!1){let t=[];const{data:r}=await h.get("/scripts/");let o;e?o=r:o=r.filter(a=>a.script_type!=="builtin");let s=[],i=!1;return o.forEach(a=>{!!a.category&&!s.includes(a.category)?s.push(a.category):a.category||(i=!0)}),i&&s.push("Unassigned"),s.sort().forEach(a=>{t.push({category:a});let u=[];o.forEach(l=>{l.category===a?u.push({label:l.name,value:l.id,timeout:l.default_timeout,args:l.args,env_vars:l.env_vars}):a==="Unassigned"&&!l.category&&u.push({label:l.name,value:l.id,timeout:l.default_timeout,args:l.args,env_vars:l.env_vars})});const n=u.sort((l,O)=>l.label.localeCompare(O.label));t.push(...n)}),t},async getAgentOptions(e="agent_id"){const{data:t}=await h.get("/agents/?detail=false");return x(t,!1,e)},getNextAgentUpdateTime(){const e=new Date;let t;e.getMinutes()<=35?t=e.setMinutes(35):(t=m.addToDate(e,{hours:1}),t.setMinutes(35));const r=m.formatDate(t,"MMM D, YYYY"),o=m.formatDate(t,"h:mm A");return`${r} at ${o}`},truncateText(e){return e?e.length>=60?e.substring(0,60)+"...":e:""}}};const z={name:"tactical-dropdown",inheritAttrs:!1,props:{modelValue:!String,mapOptions:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},filterable:{type:Boolean,default:!1},options:!Array},setup(e){const t=y(!1),r=y(e.options);function o(i,a){a(()=>{if(i==="")t.value=!1;else{t.value=!0;const u=i.toLowerCase();e.mapOptions?r.value=e.options.filter(n=>n.category?!1:n.label.toLowerCase().indexOf(u)>-1):r.value=e.options.filter(n=>n.toLowerCase().indexOf(u)>-1)}})}const s=A(()=>e.filterable?"filter":null);return{filtered:t,filteredOptions:r,filterFn:o,filterEvent:s}}},N=["src"];function Q(e,t,r,o,s,i){return g(),p(L,v({dense:"","options-dense":"","onUpdate:modelValue":t[0]||(t[0]=a=>e.$emit("update:modelValue",a)),options:o.filtered?o.filteredOptions:r.options,"model-value":r.modelValue,"map-options":r.mapOptions,"emit-value":r.mapOptions,multiple:r.multiple,"use-chips":r.multiple,"use-input":r.filterable},{[k(o.filterEvent)]:o.filterFn},e.$attrs),C({option:d(a=>[a.opt.category?c("",!0):(g(),p(B,v({key:0},a.itemProps,{class:"q-pl-lg",key:r.mapOptions?a.opt.value:a.opt}),{default:d(()=>[b(Y,null,{default:d(()=>[b(D,{innerHTML:r.mapOptions?a.opt.label:a.opt},null,8,["innerHTML"])]),_:2},1024),o.filtered&&r.mapOptions&&a.opt.cat||a.opt.img_right?(g(),p(Y,{key:0,side:""},{default:d(()=>[_(M(a.opt.cat||"")+" ",1),a.opt.img_right?(g(),V("img",{key:0,src:a.opt.img_right,style:{height:"20px","max-width":"20px"}},null,8,N)):c("",!0)]),_:2},1024)):c("",!0)]),_:2},1040)),a.opt.category?(g(),p(D,{header:"",class:"q-pa-sm",key:a.opt.category},{default:d(()=>[_(M(a.opt.category),1)]),_:2},1024)):c("",!0)]),_:2},[E(e.$slots,(a,u)=>({name:u,fn:d(n=>[w(e.$slots,u,P(S(n||{})))])}))]),1040,["options","model-value","map-options","emit-value","multiple","use-chips","use-input"])}var Z=H(z,[["render",Q]]);export{Z as T,W as m};
