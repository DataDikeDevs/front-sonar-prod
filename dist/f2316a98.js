import{Q as C}from"./b10e6aed.js";import{_ as q,o as l,x as p,i as s,K as E,u as U,ei as I,r as i,a5 as R,M as z,f as w,g as a,h as o,s as _,m as b,E as Q,j as c,bR as x,dJ as N,t as h,q as V,l as $,B as D,H as F,n as G,p as M,F as j,v as A,I as H}from"./5ab24b2e.js";import{Q as J,a as P,b as K}from"./ecaf8470.js";import{Q as W,C as X}from"./cf5c9d2e.js";import{Q as Y}from"./e721170f.js";import{Q as Z,a as ee}from"./e97ed4ea.js";import{u as se}from"./996a7403.js";import{g as te,o as oe}from"./b24520dc.js";import{O as ae}from"./bf0c4274.js";import"./1f4fe988.js";var re="/f2b57d8b.png";const le={},ne={fill:"currentcolor",viewBox:"0 0 32 32",version:"1.1",xmlns:"http://www.w3.org/2000/svg"};function ie(T,d){return l(),p("svg",ne,d[0]||(d[0]=[s("g",{id:"SVGRepo_bgCarrier","stroke-width":"0"},null,-1),s("g",{id:"SVGRepo_tracerCarrier","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),s("g",{id:"SVGRepo_iconCarrier"},[s("path",{d:"M25 12h-1v-3.816c0-4.589-3.32-8.184-8.037-8.184-4.736 0-7.963 3.671-7.963 8.184v3.816h-1c-2.206 0-4 1.794-4 4v12c0 2.206 1.794 4 4 4h18c2.206 0 4-1.794 4-4v-12c0-2.206-1.794-4-4-4zM10 8.184c0-3.409 2.33-6.184 5.963-6.184 3.596 0 6.037 2.716 6.037 6.184v3.816h-12v-3.816zM27 28c0 1.102-0.898 2-2 2h-18c-1.103 0-2-0.898-2-2v-12c0-1.102 0.897-2 2-2h18c1.102 0 2 0.898 2 2v12zM16 18c-1.104 0-2 0.895-2 2 0 0.738 0.405 1.376 1 1.723v3.277c0 0.552 0.448 1 1 1s1-0.448 1-1v-3.277c0.595-0.346 1-0.985 1-1.723 0-1.105-0.895-2-2-2z"})],-1)]))}var de=q(le,[["render",ie]]);const ue={class:"login-card-1"},me={class:"login-logo-container"},ce={class:"form-group-2"},pe={class:"form-group-2"},fe=["type"],ve={key:0,class:"text-negative text-caption"},ge=["disabled"],we=["rules"],be={class:"btn btn-secondary",flat:"",label:"Cancel"},Te=E({__name:"LoginView",setup(T){const d=se();d.dark.set(!1);const B=()=>{d.dark.toggle()},y=U(),k=I(),f=i(null),S=i(null),n=R({username:"",password:""}),u=i(""),m=i(!1),v=i(!0),g=i([]);async function L(){try{const{totp:r}=await y.checkCredentials(n);r?(u.value="",m.value=!0):k.push({name:"TOTPSetup"})}catch(r){console.error(r)}}async function O(){try{await y.login({...n,twofactor:u.value}),k.push({name:"Home"})}catch(r){console.error(r)}finally{f.value?.reset(),S.value?.reset(),m.value=!1}}return z(async()=>{try{const r=await te();g.value=r.data.socialaccount.providers}catch(r){console.error(r)}}),(r,e)=>(l(),w(ee,null,{default:a(()=>[o(Z,null,{default:a(()=>[o(Y,{class:"login-page"},{default:a(()=>[o(_,{class:"login-card"},{default:a(()=>[s("div",ue,[e[10]||(e[10]=s("div",{class:""},[s("h2",{className:"welcome"},"WELCOME TO")],-1)),s("div",me,[o(ae,{onClick:B,class:"onlysonar"}),e[7]||(e[7]=s("div",{class:"login-title"},"Sonar",-1))]),o(b,null,{default:a(()=>[o(C,{ref_key:"form",ref:f,onSubmit:Q(L,["prevent"]),class:"q-gutter-md"},{default:a(()=>[s("div",ce,[c(s("input",{id:"username",type:"text",class:"form-control-2",placeholder:" ","onUpdate:modelValue":e[0]||(e[0]=t=>n.username=t),onBlur:e[1]||(e[1]=(...t)=>r.validateUsername&&r.validateUsername(...t))},null,544),[[x,n.username]]),e[8]||(e[8]=s("label",{htmlfor:"username"},"Username",-1))]),s("div",pe,[c(s("input",{type:v.value?"password":"text",id:"password",placeholder:" ",class:"form-control-2","onUpdate:modelValue":e[2]||(e[2]=t=>n.password=t),onBlur:e[3]||(e[3]=(...t)=>r.validatePassword&&r.validatePassword(...t))},null,40,fe),[[N,n.password]]),e[9]||(e[9]=s("label",{htmlfor:"password"},"Password",-1))]),o(de,{class:"password-icon",onClick:e[4]||(e[4]=t=>v.value=!v.value)}),r.passwordError?(l(),p("div",ve,h(r.passwordError),1)):V("",!0),s("button",{type:"submit",class:"btn-login btn",disabled:f.value?.hasError}," Sign In ",8,ge)]),_:1},512)]),_:1})]),e[12]||(e[12]=s("div",{class:"login-img-div login-card-2"},[s("img",{class:"login-img",src:re,alt:"Login"})],-1)),g.value?.length>0?(l(),w(b,{key:0},{default:a(()=>[e[11]||(e[11]=s("div",{class:"text-h6 text-center q-mb-md"},"Log in with SSO",-1)),o($),o(W,{dense:"",bordered:"",class:"q-pa-sm"},{default:a(()=>[(l(!0),p(j,null,D(g.value,t=>(l(),w(J,{key:t.id,onClick:ye=>F(oe)(t.id),clickable:"",class:"q-pa-xs hover-bg"},{default:a(()=>[o(P,{avatar:""},{default:a(()=>[o(G,{name:t.icon??"mdi-key",size:"sm",class:"text-primary"},null,8,["name"])]),_:2},1024),o(P,null,{default:a(()=>[o(K,null,{default:a(()=>[M(h(t.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})):V("",!0)]),_:1}),o(A,{persistent:"",modelValue:m.value,"onUpdate:modelValue":e[6]||(e[6]=t=>m.value=t)},{default:a(()=>[o(_,{style:{"min-width":"400px"}},{default:a(()=>[o(C,{ref_key:"formToken",ref:S,onSubmit:Q(O,["prevent"])},{default:a(()=>[e[15]||(e[15]=s("h5",{class:"text-dark text-xl text-center mt-3 font-semibold"},"Two-Factor Token",-1)),o(b,null,{default:a(()=>[c(s("input",{class:"form-control w-full","onUpdate:modelValue":e[5]||(e[5]=t=>u.value=t),rules:[t=>t&&t.length>0||"This field is required"]},null,8,we),[[x,u.value]])]),_:1}),o(H,{align:"right",class:"text-primary gap-2"},{default:a(()=>[c((l(),p("button",be,e[13]||(e[13]=[M(" Cancel ")]))),[[X]]),e[14]||(e[14]=s("button",{class:"btn btn-primary",flat:"",label:"Submit",type:"submit"}," Submit ",-1))]),_:1})]),_:1},512)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}))}});export{Te as default};
