import{aT as ft,P as gt,aU as _t,e as C,X as bt,U as Te,aW as yt,W as ht,a as we,r as D,_ as J,o,f as r,g as l,h as t,s as ye,p as i,t as b,j as S,Q as L,m as M,i as g,bM as ve,q as h,I as Ue,v as pe,A as E,k as Y,ab as kt,bB as vt,G as ie,bN as wt,z as pt,E as Ye,n as v,x as w,B as de,F as ue,D as Ce,l as ce,bO as Je,K as Ze,w as ge,H as _e,b as ae,bP as Ct,a3 as xt,bf as je,R as me,M as he,bQ as De,aa as qe,bR as St,bS as Vt,N as At,bz as Tt,C as fe}from"./7e207d24.js";import{Q as Pt}from"./5addef8f.js";import{u as re,d as $e,c as $,e as Be,f as j,j as Ut,g as se,b as Ne,a as z,Q as Ve}from"./f0595305.js";import{Q as qt,a as zt}from"./d613a77f.js";import{i as Dt,n as W,b as xe,a as le,j as Rt,k as Mt,l as Ot,o as Nt,m as Ht,p as et,q as It,f as Ft,g as Oe,t as Qt,w as Et,u as Lt,v as Wt,x as jt,d as tt,y as Bt,z as Gt,Q as lt,A as Le,B as Kt,C as Xt,D as Yt,E as Jt,F as Zt,G as $t,H as el,I as tl,J as ll}from"./3829acca.js";import{a as V,Q as at,b as be,f as Re}from"./48c23d68.js";import{k as al,_ as Me,m as nl,Q as nt,S as Ge,g as ol}from"./aad6f44a.js";import{Q as p,a as f,b as G}from"./c0fd0898.js";import{C as q,Q as te}from"./c2746639.js";import{P as sl,C as il,r as ot,u as rl,a as dl,e as ul,b as cl,f as ml,c as st,Q as Ae,m as fl,d as gl,g as _l,h as bl,i as yl,E as hl,D as kl,M as vl,j as wl,k as pl,W as Cl,l as xl,S as Sl,n as Vl,o as Al,p as Tl,A as Xe,q as Pl,s as Ul}from"./8b740bdb.js";import{u as ke}from"./e96a218e.js";import{Q as ze}from"./99821dad.js";import{T as Se,m as it}from"./1a2e572b.js";import{I as Pe}from"./3b66e605.js";import{E as He}from"./fa5db05f.js";const ql={...ft,min:{type:Number,default:0},max:{type:Number,default:100},color:String,centerColor:String,trackColor:String,fontSize:String,rounded:Boolean,thickness:{type:Number,default:.2,validator:s=>s>=0&&s<=1},angle:{type:Number,default:0},showValue:Boolean,reverse:Boolean,instantFeedback:Boolean},We=50,rt=2*We,dt=rt*Math.PI,zl=Math.round(dt*1e3)/1e3;var Dl=gt({name:"QCircularProgress",props:{...ql,value:{type:Number,default:0},animationSpeed:{type:[String,Number],default:600},indeterminate:Boolean},setup(s,{slots:e}){const{proxy:{$q:d}}=ht(),a=_t(s),u=C(()=>{const A=(d.lang.rtl===!0?-1:1)*s.angle;return{transform:s.reverse!==(d.lang.rtl===!0)?`scale3d(-1, 1, 1) rotate3d(0, 0, 1, ${-90-A}deg)`:`rotate3d(0, 0, 1, ${A-90}deg)`}}),k=C(()=>s.instantFeedback!==!0&&s.indeterminate!==!0?{transition:`stroke-dashoffset ${s.animationSpeed}ms ease 0s, stroke ${s.animationSpeed}ms ease`}:""),c=C(()=>rt/(1-s.thickness/2)),n=C(()=>`${c.value/2} ${c.value/2} ${c.value} ${c.value}`),m=C(()=>bt(s.value,s.min,s.max)),_=C(()=>s.max-s.min),O=C(()=>s.thickness/2*c.value),N=C(()=>{const A=(s.max-m.value)/_.value,Q=s.rounded===!0&&m.value<s.max&&A<.25?O.value/2*(1-A/.25):0;return dt*A+Q});function H({thickness:A,offset:Q,color:K,cls:P,rounded:T}){return Te("circle",{class:"q-circular-progress__"+P+(K!==void 0?` text-${K}`:""),style:k.value,fill:"transparent",stroke:"currentColor","stroke-width":A,"stroke-dasharray":zl,"stroke-dashoffset":Q,"stroke-linecap":T,cx:c.value,cy:c.value,r:We})}return()=>{const A=[];s.centerColor!==void 0&&s.centerColor!=="transparent"&&A.push(Te("circle",{class:`q-circular-progress__center text-${s.centerColor}`,fill:"currentColor",r:We-O.value/2,cx:c.value,cy:c.value})),s.trackColor!==void 0&&s.trackColor!=="transparent"&&A.push(H({cls:"track",thickness:O.value,offset:0,color:s.trackColor})),A.push(H({cls:"circle",thickness:O.value,offset:N.value,color:s.color,rounded:s.rounded===!0?"round":void 0}));const Q=[Te("svg",{class:"q-circular-progress__svg",style:u.value,viewBox:n.value,"aria-hidden":"true"},A)];return s.showValue===!0&&Q.push(Te("div",{class:"q-circular-progress__text absolute-full row flex-center content-center",style:{fontSize:s.fontSize}},e.default!==void 0?e.default():[Te("div",m.value)])),Te("div",{class:`q-circular-progress q-circular-progress--${s.indeterminate===!0?"in":""}determinate`,style:a.value,role:"progressbar","aria-valuemin":s.min,"aria-valuemax":s.max,"aria-valuenow":s.indeterminate===!0?void 0:m.value},yt(e.internal,Q))}}});const Ie="/winupdate";async function Rl(s,e={}){try{const{data:d}=await we.get(`${Ie}/${s}/`,{params:e});return d}catch(d){console.error(d)}}async function ut(s){const{data:e}=await we.post(`${Ie}/${s}/scan/`);return e}async function ct(s){const{data:e}=await we.post(`${Ie}/${s}/install/`);return e}async function Ml(s,e){const{data:d}=await we.put(`${Ie}/${s}/`,e);return d}const Ol={name:"AgentRecovery",emits:[...re.emits],props:{agent:!Object},setup(s){const{dialogRef:e,onDialogHide:d,onDialogOK:a}=re(),u=D({mode:"mesh"}),k=D(!1);async function c(){k.value=!0;try{const n=await Dt(s.agent.agent_id,u.value);W(n),a()}catch(n){console.error(n)}k.value=!1}return{state:u,loading:k,sendRecovery:c,dialogRef:e,onDialogHide:d}}},Nl={class:"q-gutter-sm"};function Hl(s,e,d,a,u,k){return o(),r(pe,{ref:"dialogRef",onHide:a.onDialogHide},{default:l(()=>[t(ye,{style:{"min-width":"50vw"}},{default:l(()=>[t(xe,null,{default:l(()=>[i(b(d.agent.hostname)+" Agent recovery ",1),t(le),S((o(),r(L,{dense:"",flat:"",icon:"close"},{default:l(()=>[t(V,{class:"bg-white text-primary"},{default:l(()=>e[2]||(e[2]=[i("Close")])),_:1})]),_:1})),[[q]])]),_:1}),t(ze,{onSubmit:a.sendRecovery},{default:l(()=>[t(M,null,{default:l(()=>[g("div",Nl,[t(ve,{dense:"",modelValue:a.state.mode,"onUpdate:modelValue":e[0]||(e[0]=c=>a.state.mode=c),val:"mesh",label:"Mesh Agent"},null,8,["modelValue"]),t(ve,{dense:"",modelValue:a.state.mode,"onUpdate:modelValue":e[1]||(e[1]=c=>a.state.mode=c),val:"tacagent",label:"Sonar Agent"},null,8,["modelValue"])])]),_:1}),a.state.mode==="mesh"?(o(),r(M,{key:0},{default:l(()=>e[3]||(e[3]=[i(" Fix issues with the Mesh Agent which handles take control, live terminal and file browser. ")])),_:1})):a.state.mode==="tacagent"?(o(),r(M,{key:1},{default:l(()=>e[4]||(e[4]=[i(" Fix issues with the Agent service. ")])),_:1})):h("",!0),t(Ue,{align:"right"},{default:l(()=>[S(t(L,{dense:"",flat:"",push:"",label:"Cancel"},null,512),[[q]]),t(L,{loading:a.loading,dense:"",flat:"",push:"",label:"Recover",color:"primary",type:"submit"},null,8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["onHide"])}var Il=J(Ol,[["render",Hl]]);const Fl={name:"PolicyAdd",components:{TacticalDropdown:Se},emits:["hide","ok","cancel"],props:{object:!Object,type:{required:!0,type:String,validator:function(s){return["agent","site","client"].includes(s)}}},mixins:[it],data(){return{selectedWorkstationPolicy:null,selectedServerPolicy:null,selectedAgentPolicy:null,blockInheritance:!1,options:[]}},methods:{submit(){if(this.type==="client"||this.type==="site"){if(this.object.workstation_policy===this.selectedWorkstationPolicy&&this.object.server_policy===this.selectedServerPolicy&&this.object.blockInheritance===this.blockInheritance){this.hide();return}}else if(this.type==="agent"){if(this.object.policy===this.selectedAgentPolicy&&this.object.block_policy_inheritance===this.blockInheritance){this.hide();return}}else return;this.$q.loading.show();let s={},e="";this.type==="client"?(e=`/clients/${this.object.id}/`,s={client:{server_policy:this.selectedServerPolicy,workstation_policy:this.selectedWorkstationPolicy,block_policy_inheritance:this.blockInheritance}}):this.type==="site"?(e=`/clients/sites/${this.object.id}/`,s={site:{server_policy:this.selectedServerPolicy,workstation_policy:this.selectedWorkstationPolicy,block_policy_inheritance:this.blockInheritance}}):this.type==="agent"&&(e=`/agents/${this.object.agent_id}/`,s={policy:this.selectedAgentPolicy,block_policy_inheritance:this.blockInheritance}),this.$axios.put(e,s).then(()=>{this.$q.loading.hide(),this.onOk(),this.notifySuccess("Policies Updated Successfully!")}).catch(()=>{this.$q.loading.hide()})},getPolicies(){this.$q.loading.show(),this.$axios.get("/automation/policies/").then(s=>{this.options=s.data.map(e=>({label:e.name,value:e.id})),this.$q.loading.hide()}).catch(()=>{this.$q.loading.hide()})},show(){this.$refs.dialog.show()},hide(){this.$refs.dialog.hide()},onHide(){this.$emit("hide")},onOk(){this.$emit("ok"),this.hide()}},mounted(){this.getPolicies(),this.type!=="agent"?(this.selectedServerPolicy=this.object.server_policy,this.selectedWorkstationPolicy=this.object.workstation_policy,this.blockInheritance=this.object.block_policy_inheritance):(this.selectedAgentPolicy=this.object.policy,this.blockInheritance=this.object.block_policy_inheritance)}};function Ql(s,e,d,a,u,k){const c=E("tactical-dropdown");return o(),r(pe,{ref:"dialog",onHide:k.onHide},{default:l(()=>[t(ye,{class:"q-dialog-plugin",style:{width:"60vw"}},{default:l(()=>[t(xe,null,{default:l(()=>[i(" Edit policies assigned to "+b(d.type)+" ",1),t(le),S((o(),r(L,{dense:"",flat:"",icon:"close"},{default:l(()=>[t(V,{class:"bg-white text-primary"},{default:l(()=>e[4]||(e[4]=[i("Close")])),_:1})]),_:1})),[[q]])]),_:1}),t(ze,{onSubmit:k.submit},{default:l(()=>[u.options.length>0?(o(),r(M,{key:0},{default:l(()=>[d.type==="client"||d.type==="site"?(o(),r(c,{key:0,class:"q-mb-md",modelValue:u.selectedServerPolicy,"onUpdate:modelValue":e[0]||(e[0]=n=>u.selectedServerPolicy=n),options:u.options,label:"Server Policy",outlined:"",clearable:"",mapOptions:"",filterable:""},null,8,["modelValue","options"])):h("",!0),d.type==="client"||d.type==="site"?(o(),r(c,{key:1,modelValue:u.selectedWorkstationPolicy,"onUpdate:modelValue":e[1]||(e[1]=n=>u.selectedWorkstationPolicy=n),options:u.options,label:"Workstation Policy",outlined:"",clearable:"",mapOptions:"",filterable:""},null,8,["modelValue","options"])):h("",!0),d.type==="agent"?(o(),r(c,{key:2,modelValue:u.selectedAgentPolicy,"onUpdate:modelValue":e[2]||(e[2]=n=>u.selectedAgentPolicy=n),options:u.options,label:"Policy",outlined:"",clearable:"",mapOptions:"",filterable:""},null,8,["modelValue","options"])):h("",!0),t(Y,{label:"Block policy inheritance",modelValue:u.blockInheritance,"onUpdate:modelValue":e[3]||(e[3]=n=>u.blockInheritance=n)},{default:l(()=>[t(V,null,{default:l(()=>[i("This "+b(d.type)+" will not inherit from higher policies",1)]),_:1})]),_:1},8,["modelValue"])]),_:1})):(o(),r(M,{key:1},{default:l(()=>e[5]||(e[5]=[i(" No Automation Policies have been setup. Go to Settings > Automation Manager ")])),_:1})),t(Ue,{align:"right"},{default:l(()=>[S(t(L,{dense:"",flat:"",label:"Cancel"},null,512),[[q]]),u.options.length>0?(o(),r(L,{key:0,dense:"",flat:"",label:"Submit",color:"primary",type:"submit"})):h("",!0)]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["onHide"])}var El=J(Fl,[["render",Ql]]);const Ll={name:"RebootLater",emits:[...re.emits],props:{agent:!Object},setup(s){const{dialogRef:e,onDialogHide:d,onDialogOK:a}=re(),u=ke(),k=D({datetime:kt(vt.addToDate(Date.now(),{hours:1}))}),c=D(!1);async function n(){c.value=!0;try{const m=await Rt(s.agent.agent_id,k.value);u.dialog({title:"Reboot pending",style:"width: 40vw",message:`A reboot has been scheduled for <strong>${m.time}</strong> on ${s.agent.hostname}.
            <br />It can be cancelled from the Pending Actions menu until the scheduled time.`,html:!0}).onDismiss(a)}catch(m){console.error(m)}c.value=!1}return{state:k,loading:c,scheduleReboot:n,dialogRef:e,onDialogHide:d}}};function Wl(s,e,d,a,u,k){return o(),r(pe,{ref:"dialogRef",onHide:a.onDialogHide},{default:l(()=>[t(ye,{class:"dialog-plugin",style:{"min-width":"30vw"}},{default:l(()=>[t(xe,null,{default:l(()=>[i(" Schedule reboot on "+b(d.agent.hostname)+" ",1),t(le),S((o(),r(L,{dense:"",flat:"",icon:"close"},{default:l(()=>[t(V,{class:"bg-white text-primary"},{default:l(()=>e[1]||(e[1]=[i("Close")])),_:1})]),_:1})),[[q]])]),_:1}),t(M,null,{default:l(()=>[t(ie,{type:"datetime-local",dense:"",label:"Reboot time","stack-label":"",filled:"",modelValue:a.state.datetime,"onUpdate:modelValue":e[0]||(e[0]=c=>a.state.datetime=c),hint:"Uses the agent's local time zone"},null,8,["modelValue"])]),_:1}),t(Ue,{align:"right"},{default:l(()=>[S(t(L,{dense:"",flat:"",push:"",label:"Cancel"},null,512),[[q]]),t(L,{loading:a.loading,dense:"",flat:"",push:"",label:"Schedule Reboot",color:"primary",onClick:a.scheduleReboot},null,8,["loading","onClick"])]),_:1})]),_:1})]),_:1},8,["onHide"])}var jl=J(Ll,[["render",Wl]]);const Bl={name:"EditAgent",emits:[...re.emits],components:{PatchPolicyForm:sl,CustomField:il,TacticalDropdown:Se},mixins:[it],props:{agent_id:!String},setup(){const{dialogRef:s,onDialogHide:e}=re();return{capitalize:wt,dialogRef:s,onDialogHide:e}},data(){return{customFields:[],custom_fields:{},agent:{},monTypes:["server","workstation"],client_options:[],splitterModel:25,tab:"general",timezone:null,tz_inherited:!0,original_tz:null,allTimezones:[],siteOptions:[]}},methods:{getAgentInfo(){this.$axios.get(`/agents/${this.agent_id}/`).then(s=>{this.agent=s.data,this.allTimezones=Object.freeze(s.data.all_timezones),s.data.time_zone===null?(this.timezone=s.data.timezone,this.original_tz=s.data.timezone):(this.tz_inherited=!1,this.timezone=s.data.time_zone,this.original_tz=s.data.time_zone);for(let e of this.customFields){const d=s.data.custom_fields.find(a=>a.field===e.id);e.type==="multiple"?d?this.custom_fields[e.name]=d.value:this.custom_fields[e.name]=[]:e.type==="checkbox"?d?this.custom_fields[e.name]=d.value:this.custom_fields[e.name]=!1:d?this.custom_fields[e.name]=d.value:this.custom_fields[e.name]=""}})},getSiteOptions(){this.$axios.get("/clients/").then(s=>{s.data.forEach(e=>{this.siteOptions.push({category:e.name}),e.sites.forEach(d=>this.siteOptions.push({label:d.name,value:d.id}))})})},editAgent(){const s=["created_by","created_time","modified_by","modified_time","all_timezones","timezone","wmi_detail","services","status","cpu_model","local_ips","make_model","physical_disks","graphics","checks","patches_last_installed","last_seen","applied_policies","effective_patch_policy","version","operating_system","plat","goarch","hostname","public_ip","total_ram","disks","boot_time","logged_in_username","last_logged_in_user","needs_reboot","choco_installed","policy","mesh_node_id","block_policy_inheritance","maintenance_mode","alert_template","client","site_name"];for(const e of s)delete this.agent[e];this.timezone!==this.original_tz&&(this.agent.time_zone=this.timezone),this.$axios.put(`/agents/${this.agent_id}/`,{...this.agent,custom_fields:this.formatCustomFields(this.customFields,this.custom_fields)}).then(()=>{this.$refs.dialogRef.hide(),this.$emit("ok"),this.notifySuccess("Agent was edited!")})},weekDaystoString(s){if(s.length===0)return"not set";let e="";for(let d in s)d===1?e+="Mon, ":d===2?e+="Tue, ":d===3?e+="Wed, ":d===4?e+="Thur, ":d===5?e+="Fri, ":d===6?e+="Sat, ":d===0&&(e+="Sun, ");return e.trimEnd(",")}},computed:{...pt(["dash_warning_color","dash_negative_color"])},mounted(){this.getCustomFields("agent").then(s=>{this.customFields=s.data.filter(e=>!e.hide_in_ui)}),this.getAgentInfo(),this.getSiteOptions()}},Gl={class:"text-h6"},Kl={class:"scroll",style:{height:"65vh","max-height":"65vh"}},Xl={class:"col-10"},Yl={class:"col-10"},Jl={key:0,class:"text-subtitle"};function Zl(s,e,d,a,u,k){const c=E("tactical-dropdown"),n=E("CustomField"),m=E("PatchPolicyForm");return o(),r(pe,{ref:"dialogRef",onHide:a.onDialogHide},{default:l(()=>[t(ye,{style:{"min-width":"800px"}},{default:l(()=>[t(al,{modelValue:u.splitterModel,"onUpdate:modelValue":e[12]||(e[12]=_=>u.splitterModel=_)},{before:l(()=>[t($e,{dense:"",modelValue:u.tab,"onUpdate:modelValue":e[0]||(e[0]=_=>u.tab=_),vertical:"",class:"text-primary"},{default:l(()=>[t($,{name:"general",label:"General"}),t($,{name:"customfields",label:"Custom Fields"}),t($,{name:"patch",label:"Patches"}),t($,{name:"policies",label:"Automation Policies"})]),_:1},8,["modelValue"])]),after:l(()=>[t(ze,{onSubmit:Ye(k.editAgent,["prevent"])},{default:l(()=>[t(M,{class:"row items-center"},{default:l(()=>[g("div",Gl,"Edit "+b(u.agent.hostname),1),t(le),S(t(L,{icon:"close",flat:"",round:"",dense:""},null,512),[[q]])]),_:1}),g("div",Kl,[t(Be,{modelValue:u.tab,"onUpdate:modelValue":e[11]||(e[11]=_=>u.tab=_),animated:"","transition-prev":"jump-up","transition-next":"jump-up"},{default:l(()=>[t(j,{name:"general"},{default:l(()=>[t(M,{class:"row"},{default:l(()=>[e[13]||(e[13]=g("div",{class:"col-2"},"Tenant:",-1)),e[14]||(e[14]=g("div",{class:"col-2"},null,-1)),t(c,{class:"col-8",modelValue:u.agent.site,"onUpdate:modelValue":e[1]||(e[1]=_=>u.agent.site=_),options:u.siteOptions,outlined:"",mapOptions:"",filterable:""},null,8,["modelValue","options"])]),_:1}),t(M,{class:"row"},{default:l(()=>[e[15]||(e[15]=g("div",{class:"col-2"},"Type:",-1)),e[16]||(e[16]=g("div",{class:"col-2"},null,-1)),t(at,{dense:"","options-dense":"",outlined:"",modelValue:u.agent.monitoring_type,"onUpdate:modelValue":e[2]||(e[2]=_=>u.agent.monitoring_type=_),options:u.monTypes,class:"col-8"},null,8,["modelValue","options"])]),_:1}),t(M,{class:"row"},{default:l(()=>[e[17]||(e[17]=g("div",{class:"col-2"},"Description:",-1)),e[18]||(e[18]=g("div",{class:"col-2"},null,-1)),t(ie,{outlined:"",dense:"",modelValue:u.agent.description,"onUpdate:modelValue":e[3]||(e[3]=_=>u.agent.description=_),class:"col-8"},null,8,["modelValue"])]),_:1}),t(M,{class:"row"},{default:l(()=>[e[19]||(e[19]=g("div",{class:"col-2"},"Timezone:",-1)),e[20]||(e[20]=g("div",{class:"col-2"},null,-1)),t(c,{filterable:"",clearable:"",outlined:"",dense:"","options-dense":"",modelValue:u.timezone,"onUpdate:modelValue":e[4]||(e[4]=_=>u.timezone=_),options:u.allTimezones,class:"col-8"},null,8,["modelValue","options"])]),_:1}),t(M,{class:"row"},{default:l(()=>[e[21]||(e[21]=g("div",{class:"col-10"},"Run checks every:",-1)),t(ie,{dense:"",type:"number",filled:"",label:"Seconds",modelValue:u.agent.check_interval,"onUpdate:modelValue":e[5]||(e[5]=_=>u.agent.check_interval=_),modelModifiers:{number:!0},class:"col-2",rules:[_=>!!_||"*Required",_=>_>=15||"Minimum is 15 seconds",_=>_<=86400||"Maximum is 86400 seconds"]},null,8,["modelValue","rules"])]),_:1}),t(M,{class:"row"},{default:l(()=>[g("div",Xl,[t(v,{class:"q-pr-sm",name:"fas fa-signal",size:"1.2em",color:s.dash_warning_color},null,8,["color"]),e[22]||(e[22]=i(" Mark an agent as ")),e[23]||(e[23]=g("span",{class:"text-weight-bold"},"offline",-1)),e[24]||(e[24]=i(" if it has not checked in after: "))]),t(ie,{dense:"",type:"number",filled:"",label:"Minutes",modelValue:u.agent.offline_time,"onUpdate:modelValue":e[6]||(e[6]=_=>u.agent.offline_time=_),modelModifiers:{number:!0},class:"col-2",rules:[_=>!!_||"*Required",_=>_>=2||"Minimum is 2 minutes",_=>_<9999999||"Maximum is 9999999 minutes"]},null,8,["modelValue","rules"])]),_:1}),t(M,{class:"row"},{default:l(()=>[g("div",Yl,[t(v,{class:"q-pr-sm",name:"fas fa-signal",size:"1.2em",color:s.dash_negative_color},null,8,["color"]),e[25]||(e[25]=i(" Mark an agent as ")),e[26]||(e[26]=g("span",{class:"text-weight-bold"},"overdue",-1)),e[27]||(e[27]=i(" if it has not checked in after: "))]),t(ie,{dense:"",type:"number",filled:"",label:"Minutes",modelValue:u.agent.overdue_time,"onUpdate:modelValue":e[7]||(e[7]=_=>u.agent.overdue_time=_),modelModifiers:{number:!0},class:"col-2",rules:[_=>!!_||"*Required",_=>_>=3||"Minimum is 3 minutes",_=>_<9999999||"Maximum is 9999999 minutes"]},null,8,["modelValue","rules"])]),_:1}),t(M,{class:"row"},{default:l(()=>[t(Y,{modelValue:u.agent.overdue_email_alert,"onUpdate:modelValue":e[8]||(e[8]=_=>u.agent.overdue_email_alert=_),label:"Get overdue email alerts"},null,8,["modelValue"]),t(Y,{modelValue:u.agent.overdue_text_alert,"onUpdate:modelValue":e[9]||(e[9]=_=>u.agent.overdue_text_alert=_),label:"Get overdue sms alerts"},null,8,["modelValue"]),t(Y,{modelValue:u.agent.overdue_dashboard_alert,"onUpdate:modelValue":e[10]||(e[10]=_=>u.agent.overdue_dashboard_alert=_),label:"Get overdue dashboard alerts"},null,8,["modelValue"])]),_:1})]),_:1}),t(j,{name:"customfields"},{default:l(()=>[u.customFields.length===0?(o(),w("div",Jl," No agent custom fields found. Go to **Settings > Global Settings > Custom Settings** ")):h("",!0),(o(!0),w(ue,null,de(u.customFields,_=>(o(),r(M,{key:_.id},{default:l(()=>[t(n,{modelValue:u.custom_fields[_.name],"onUpdate:modelValue":O=>u.custom_fields[_.name]=O,field:_},null,8,["modelValue","onUpdate:modelValue","field"])]),_:2},1024))),128))]),_:1}),t(j,{name:"patch"},{default:l(()=>[t(m,{agent:u.agent},null,8,["agent"])]),_:1}),t(j,{name:"policies"},{default:l(()=>[e[44]||(e[44]=g("div",{class:"text-subtitle2"},"Policies",-1)),t(te,{separator:"",padding:"",dense:""},{default:l(()=>[(o(!0),w(ue,null,de(u.agent.applied_policies,(_,O)=>(o(),r(p,{key:O},{default:l(()=>[t(f,null,{default:l(()=>[t(G,{overline:""},{default:l(()=>[i(b(a.capitalize(O).split("_").join(" ")),1)]),_:2},1024),t(G,null,{default:l(()=>[i(b(_?_.name:"None"),1)]),_:2},1024)]),_:2},1024),_?(o(),r(f,{key:0,side:""},{default:l(()=>[t(G,null,{default:l(()=>[g("i",null,b(_.active?"":"disabled"),1)]),_:2},1024)]),_:2},1024)):h("",!0)]),_:2},1024))),128))]),_:1}),e[45]||(e[45]=g("div",{class:"text-subtitle2"},"Alert Template",-1)),t(te,{dense:"",padding:""},{default:l(()=>[t(p,null,{default:l(()=>[t(f,null,{default:l(()=>[t(G,null,{default:l(()=>[i(b(u.agent.alert_template?u.agent.alert_template.name:"None"),1)]),_:1})]),_:1}),u.agent.alert_template?(o(),r(f,{key:0,side:""},{default:l(()=>[t(G,null,{default:l(()=>[g("i",null,b(u.agent.alert_template.is_active?"":"disabled"),1)]),_:1})]),_:1})):h("",!0)]),_:1})]),_:1}),e[46]||(e[46]=g("div",{class:"text-subtitle2"},"Effective Patch Policy",-1)),t(te,{separator:"",padding:"",dense:""},{default:l(()=>[t(p,null,{default:l(()=>[t(f,null,{default:l(()=>[t(G,{overline:""},{default:l(()=>e[28]||(e[28]=[i("Critical")])),_:1}),t(G,null,{default:l(()=>[i(b(u.agent.effective_patch_policy.critical!=="inherit"?a.capitalize(u.agent.effective_patch_policy.critical):"Do Nothing"),1)]),_:1})]),_:1})]),_:1}),t(p,null,{default:l(()=>[t(f,null,{default:l(()=>[t(G,{overline:""},{default:l(()=>e[29]||(e[29]=[i("Important")])),_:1}),t(G,null,{default:l(()=>[i(b(u.agent.effective_patch_policy.important!=="inherit"?a.capitalize(u.agent.effective_patch_policy.important):"Do Nothing"),1)]),_:1})]),_:1})]),_:1}),t(p,null,{default:l(()=>[t(f,null,{default:l(()=>[t(G,{overline:""},{default:l(()=>e[30]||(e[30]=[i("Moderate")])),_:1}),t(G,null,{default:l(()=>[i(b(u.agent.effective_patch_policy.moderate!=="inherit"?a.capitalize(u.agent.effective_patch_policy.moderate):"Do Nothing"),1)]),_:1})]),_:1})]),_:1}),t(p,null,{default:l(()=>[t(f,null,{default:l(()=>[t(G,{overline:""},{default:l(()=>e[31]||(e[31]=[i("Low")])),_:1}),t(G,null,{default:l(()=>[i(b(u.agent.effective_patch_policy.low!=="inherit"?a.capitalize(u.agent.effective_patch_policy.low):"Do Nothing"),1)]),_:1})]),_:1})]),_:1}),t(p,null,{default:l(()=>[t(f,null,{default:l(()=>[t(G,{overline:""},{default:l(()=>e[32]||(e[32]=[i("Other")])),_:1}),t(G,null,{default:l(()=>[i(b(u.agent.effective_patch_policy.other!=="inherit"?a.capitalize(u.agent.effective_patch_policy.other):"Do Nothing"),1)]),_:1})]),_:1})]),_:1}),t(p,null,{default:l(()=>[t(f,null,{default:l(()=>[t(G,{overline:""},{default:l(()=>e[33]||(e[33]=[i("Run Time Frequency")])),_:1}),t(G,null,{default:l(()=>[i(b(a.capitalize(u.agent.effective_patch_policy.run_time_frequency)),1)]),_:1})]),_:1}),u.agent.effective_patch_policy.run_time_frequency==="daily"?(o(),r(f,{key:0},{default:l(()=>[t(G,null,{default:l(()=>[e[34]||(e[34]=g("b",null,"week days:",-1)),i(" "+b(k.weekDaystoString(u.agent.effective_patch_policy.run_time_days))+" ",1),e[35]||(e[35]=g("b",null,"at hour:",-1)),i(" "+b(u.agent.effective_patch_policy.run_time_hour),1)]),_:1})]),_:1})):u.agent.effective_patch_policy.run_time_frequency==="monthly"?(o(),r(f,{key:1},{default:l(()=>[t(G,null,{default:l(()=>[e[36]||(e[36]=g("b",null,"Every month on day:",-1)),i(" "+b(u.agent.effective_patch_policy.run_time_day)+" ",1),e[37]||(e[37]=g("b",null,"at hour:",-1)),i(" "+b(u.agent.effective_patch_policy.run_time_hour),1)]),_:1})]),_:1})):(o(),r(f,{key:2},{default:l(()=>[t(G,null,{default:l(()=>e[38]||(e[38]=[i("None")])),_:1})]),_:1}))]),_:1}),t(p,null,{default:l(()=>[t(f,null,{default:l(()=>[t(G,{overline:""},{default:l(()=>e[39]||(e[39]=[i("Reboot after installation")])),_:1}),t(G,null,{default:l(()=>[i(b(u.agent.effective_patch_policy.reboot_after_install!=="inherit"?a.capitalize(u.agent.effective_patch_policy.reboot_after_install):"Do Nothing"),1)]),_:1})]),_:1})]),_:1}),t(p,null,{default:l(()=>[t(f,null,{default:l(()=>[t(G,{overline:""},{default:l(()=>e[40]||(e[40]=[i("Failed patch options")])),_:1}),u.agent.effective_patch_policy.reprocess_failed_inherit?(o(),r(G,{key:0},{default:l(()=>e[41]||(e[41]=[i("Do Nothing")])),_:1})):(o(),r(G,{key:1},{default:l(()=>[e[42]||(e[42]=g("b",null,"Reprocess failed patches:",-1)),i(" "+b(u.agent.effective_patch_policy.reprocess_failed?u.agent.effective_patch_policy.reprocess_failed_times:"Never")+" ",1),e[43]||(e[43]=g("b",null,"Email on fail:",-1)),i(" "+b(u.agent.effective_patch_policy.email_if_fail?"Yes":"Never"),1)]),_:1}))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),t(M,{class:"row items-center"},{default:l(()=>[t(L,{label:"Save",color:"primary",type:"submit"})]),_:1})]),_:1},8,["onSubmit"])]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["onHide"])}var $l=J(Bl,[["render",Zl]]);const ea={name:"SendCommand",components:{ScriptOutputCopyClip:Me},emits:[...re.emits],props:{agent:!Object},setup(s){const{dialogRef:e,onDialogHide:d}=re(),a=D({shell:s.agent.plat==="windows"?"cmd":"/bin/bash",cmd:null,timeout:30,custom_shell:null,run_as_user:!1}),u=D(!1),k=D(null);async function c(){u.value=!0,k.value=null;try{k.value=await Mt(s.agent.agent_id,a.value)}catch(n){console.error(n)}u.value=!1}return{state:a,loading:u,ret:k,runAsUserToolTip:ot,submit:c,cmdPlaceholder:nl,dialogRef:e,onDialogHide:d}}},ta={class:"q-gutter-sm"};function la(s,e,d,a,u,k){const c=E("script-output-copy-clip");return o(),r(pe,{ref:"dialogRef",onHide:a.onDialogHide,persistent:"",onKeydown:Je(a.onDialogHide,["esc"])},{default:l(()=>[t(ye,{class:"q-dialog-plugin",style:Ce({"min-width":a.ret?"70vw":"40vw"})},{default:l(()=>[t(xe,null,{default:l(()=>[i(" Send command on "+b(d.agent.hostname)+" ",1),t(le),S((o(),r(L,{dense:"",flat:"",icon:"close"},{default:l(()=>[t(V,{class:"bg-white text-primary"},{default:l(()=>e[9]||(e[9]=[i("Close")])),_:1})]),_:1})),[[q]])]),_:1}),t(ze,{onSubmit:a.submit},{default:l(()=>[t(M,null,{default:l(()=>[e[10]||(e[10]=g("p",null,"Shell",-1)),g("div",ta,[d.agent.plat!=="windows"?(o(),r(ve,{key:0,dense:"",modelValue:a.state.shell,"onUpdate:modelValue":[e[0]||(e[0]=n=>a.state.shell=n),e[1]||(e[1]=n=>a.state.custom_shell=null)],val:"/bin/bash",label:"Bash"},null,8,["modelValue"])):h("",!0),d.agent.plat!=="windows"?(o(),r(ve,{key:1,dense:"",modelValue:a.state.shell,"onUpdate:modelValue":e[2]||(e[2]=n=>a.state.shell=n),val:"custom",label:"Custom"},null,8,["modelValue"])):h("",!0),d.agent.plat==="windows"?(o(),r(ve,{key:2,dense:"",modelValue:a.state.shell,"onUpdate:modelValue":e[3]||(e[3]=n=>a.state.shell=n),val:"cmd",label:"CMD"},null,8,["modelValue"])):h("",!0),d.agent.plat==="windows"?(o(),r(ve,{key:3,dense:"",modelValue:a.state.shell,"onUpdate:modelValue":e[4]||(e[4]=n=>a.state.shell=n),val:"powershell",label:"Powershell"},null,8,["modelValue"])):h("",!0)])]),_:1}),d.agent.plat==="windows"?(o(),r(M,{key:0},{default:l(()=>[t(Y,{modelValue:a.state.run_as_user,"onUpdate:modelValue":e[5]||(e[5]=n=>a.state.run_as_user=n),label:"Run As User"},{default:l(()=>[t(V,null,{default:l(()=>[i(b(a.runAsUserToolTip),1)]),_:1})]),_:1},8,["modelValue"])]),_:1})):h("",!0),a.state.shell==="custom"?(o(),r(M,{key:1},{default:l(()=>[t(ie,{modelValue:a.state.custom_shell,"onUpdate:modelValue":e[6]||(e[6]=n=>a.state.custom_shell=n),outlined:"",label:"Custom shell","stack-label":"",placeholder:"/usr/bin/python3",rules:[n=>!!n||"*Required"]},null,8,["modelValue","rules"])]),_:1})):h("",!0),t(M,null,{default:l(()=>[t(ie,{modelValue:a.state.timeout,"onUpdate:modelValue":e[7]||(e[7]=n=>a.state.timeout=n),modelModifiers:{number:!0},dense:"",outlined:"",type:"number",style:{"max-width":"150px"},label:"Timeout (seconds)","stack-label":"",rules:[n=>!!n||"*Required",n=>n>=10||"Minimum is 10 seconds",n=>n<=3600||"Maximum is 3600 seconds"]},null,8,["modelValue","rules"])]),_:1}),t(M,null,{default:l(()=>[t(ie,{modelValue:a.state.cmd,"onUpdate:modelValue":e[8]||(e[8]=n=>a.state.cmd=n),outlined:"",label:"Command","stack-label":"",placeholder:a.cmdPlaceholder(a.state.shell),rules:[n=>!!n||"*Required"]},null,8,["modelValue","placeholder","rules"])]),_:1}),t(Ue,{align:"right"},{default:l(()=>[S(t(L,{flat:"",dense:"",push:"",label:"Cancel"},null,512),[[q]]),t(L,{loading:a.loading,flat:"",dense:"",push:"",label:"Send",color:"primary",type:"submit"},null,8,["loading"])]),_:1}),a.ret!==null?(o(),r(M,{key:2},{default:l(()=>[t(c,{label:"Output",data:a.ret},null,8,["data"]),e[11]||(e[11]=i()),t(ce)]),_:1})):h("",!0),a.ret!==null?(o(),r(M,{key:3,class:"q-pl-md q-pr-md q-pt-none q-ma-none scroll",style:{"max-height":"50vh"}},{default:l(()=>[g("pre",null,b(a.ret),1)]),_:1})):h("",!0)]),_:1},8,["onSubmit"])]),_:1},8,["style"])]),_:1},8,["onHide","onKeydown"])}var aa=J(ea,[["render",la]]);const na={class:"q-gutter-sm"},oa={key:1},sa={key:0},ia={key:1},ra=Ze({__name:"RunScript",props:{agent:{},script:{}},emits:[...re.emits],setup(s){const e=ae(),d=C(()=>e.state.hosted),a=C(()=>e.state.server_scripts_enabled),u=[{label:"Wait for Output",value:"wait"},{label:"Fire and Forget",value:"forget"},{label:"Email results",value:"email"},{label:"Save results to Custom Field",value:"collector"},{label:"Save results to Agent Notes",value:"note"}],k=s,{dialogRef:c,onDialogHide:n}=re(),{script:m,filterByPlatformOptions:_,defaultTimeout:O,defaultArgs:N,defaultEnvVars:H,syntax:A,link:Q}=rl({script:k.script,plat:k.agent.plat,onMount:!0}),{customFieldOptions:K}=dl({onMount:!0}),P=D({output:"wait",emails:[],emailMode:"default",custom_field:null,save_all_output:!1,script:m,args:N,env_vars:H,timeout:O,run_as_user:!1,run_on_server:!1}),T=D(null),B=D(!1),I=D(!1);async function F(){T.value=null,B.value=!0,T.value=await Ot(k.agent.agent_id,P.value),B.value=!1,P.value.output==="forget"&&(n(),T.value&&W(T.value))}function X(){Q.value&&Nt(Q.value)}return ge([()=>P.value.output,()=>P.value.emailMode],()=>P.value.emails=[]),(ne,x)=>(o(),r(pe,{ref_key:"dialogRef",ref:c,onHide:_e(n),persistent:"",onKeydown:Je(_e(n),["esc"]),maximized:I.value},{default:l(()=>[t(ye,{class:"dialog-plugin",style:{"min-width":"60vw"}},{default:l(()=>[t(xe,null,{default:l(()=>[i(" Run a script on "+b(ne.agent.hostname)+" ",1),t(le),t(L,{dense:"",flat:"",icon:"minimize",onClick:x[0]||(x[0]=y=>I.value=!1),disable:!I.value},{default:l(()=>[I.value?(o(),r(V,{key:0,class:"bg-white text-primary"},{default:l(()=>x[15]||(x[15]=[i("Minimize")])),_:1})):h("",!0)]),_:1},8,["disable"]),t(L,{dense:"",flat:"",icon:"crop_square",onClick:x[1]||(x[1]=y=>I.value=!0),disable:I.value},{default:l(()=>[I.value?h("",!0):(o(),r(V,{key:0,class:"bg-white text-primary"},{default:l(()=>x[16]||(x[16]=[i("Maximize")])),_:1}))]),_:1},8,["disable"]),S((o(),r(L,{dense:"",flat:"",icon:"close"},{default:l(()=>[t(V,{class:"bg-white text-primary"},{default:l(()=>x[17]||(x[17]=[i("Close")])),_:1})]),_:1})),[[q]])]),_:1}),t(ze,{onSubmit:Ye(F,["prevent"])},{default:l(()=>[t(M,null,{default:l(()=>[t(Se,{rules:[y=>!!y||"*Required"],modelValue:P.value.script,"onUpdate:modelValue":x[2]||(x[2]=y=>P.value.script=y),options:_e(_),label:"Select script",outlined:"",mapOptions:"",filterable:""},{after:l(()=>[t(L,{size:"sm",round:"",dense:"",flat:"",icon:"info",onClick:X},{default:l(()=>[_e(A)?(o(),r(V,{key:0,class:"bg-white text-primary text-body1",innerHTML:_e(Ct)(_e(A))},null,8,["innerHTML"])):h("",!0)]),_:1})]),_:1},8,["rules","modelValue","options"])]),_:1}),t(M,null,{default:l(()=>[t(Se,{modelValue:P.value.args,"onUpdate:modelValue":x[3]||(x[3]=y=>P.value.args=y),label:"Script Arguments (press Enter after typing each argument)",filled:"","use-input":"",multiple:"","hide-dropdown-icon":"","input-debounce":"0","new-value-mode":"add"},null,8,["modelValue"])]),_:1}),t(M,null,{default:l(()=>[t(Se,{modelValue:P.value.env_vars,"onUpdate:modelValue":x[4]||(x[4]=y=>P.value.env_vars=y),label:_e(ul),filled:"","use-input":"",multiple:"","hide-dropdown-icon":"","input-debounce":"0","new-value-mode":"add"},null,8,["modelValue","label"])]),_:1}),P.value.run_on_server?h("",!0):(o(),r(M,{key:0},{default:l(()=>[t(xt,{modelValue:P.value.output,"onUpdate:modelValue":x[5]||(x[5]=y=>P.value.output=y),options:u,color:"primary",inline:"",dense:""},null,8,["modelValue"])]),_:1})),P.value.output==="email"?(o(),r(M,{key:1},{default:l(()=>[g("div",na,[t(ve,{dense:"",modelValue:P.value.emailMode,"onUpdate:modelValue":x[6]||(x[6]=y=>P.value.emailMode=y),val:"default",label:"Use email addresses from global settings"},null,8,["modelValue"]),t(ve,{dense:"",modelValue:P.value.emailMode,"onUpdate:modelValue":x[7]||(x[7]=y=>P.value.emailMode=y),val:"custom",label:"Custom emails"},null,8,["modelValue"])])]),_:1})):h("",!0),P.value.emailMode==="custom"&&P.value.output==="email"?(o(),r(M,{key:2},{default:l(()=>[t(Se,{modelValue:P.value.emails,"onUpdate:modelValue":x[8]||(x[8]=y=>P.value.emails=y),label:"Email recipients (press Enter after typing each email)",filled:"","use-input":"",multiple:"","hide-dropdown-icon":"","input-debounce":"0","new-value-mode":"add"},null,8,["modelValue"])]),_:1})):h("",!0),P.value.output==="collector"?(o(),r(M,{key:3},{default:l(()=>[t(Se,{rules:[y=>!!y||"*Required"],outlined:"",modelValue:P.value.custom_field,"onUpdate:modelValue":x[9]||(x[9]=y=>P.value.custom_field=y),options:_e(K),label:"Select custom field",mapOptions:"",filterable:""},null,8,["rules","modelValue","options"]),t(Y,{modelValue:P.value.save_all_output,"onUpdate:modelValue":x[10]||(x[10]=y=>P.value.save_all_output=y),label:"Save all output"},null,8,["modelValue"])]),_:1})):h("",!0),t(M,null,{default:l(()=>[ne.agent.plat==="windows"&&!P.value.run_on_server?(o(),r(Y,{key:0,modelValue:P.value.run_as_user,"onUpdate:modelValue":x[11]||(x[11]=y=>P.value.run_as_user=y),label:"Run As User"},{default:l(()=>[t(V,null,{default:l(()=>[i(b(_e(ot)),1)]),_:1})]),_:1},8,["modelValue"])):h("",!0),d.value?h("",!0):(o(),r(Y,{key:1,disable:!a.value,modelValue:P.value.run_on_server,"onUpdate:modelValue":[x[12]||(x[12]=y=>P.value.run_on_server=y),x[13]||(x[13]=y=>T.value=null)],label:"Run On Server"},{default:l(()=>[a.value?(o(),r(V,{key:1},{default:l(()=>x[19]||(x[19]=[i("Run the script on the server in the context of this agent.")])),_:1})):(o(),r(V,{key:0},{default:l(()=>x[18]||(x[18]=[i("Enable server side scripts globally to activate this feature.")])),_:1}))]),_:1},8,["disable","modelValue"]))]),_:1}),t(M,null,{default:l(()=>[t(ie,{modelValue:P.value.timeout,"onUpdate:modelValue":x[14]||(x[14]=y=>P.value.timeout=y),modelModifiers:{number:!0},dense:"",outlined:"",type:"number",style:{"max-width":"150px"},label:"Timeout (seconds)","stack-label":"",rules:[y=>!!y||"*Required",y=>y>=5||"Minimum is 5 seconds"]},null,8,["modelValue","rules"])]),_:1}),t(Ue,{align:"right"},{default:l(()=>[S(t(L,{label:"Cancel"},null,512),[[q]]),t(L,{loading:B.value,disabled:B.value,label:"Run",color:"primary",type:"submit"},null,8,["loading","disabled"])]),_:1}),T.value!==null?(o(),r(M,{key:4,class:"q-pl-md q-pr-md q-pt-none q-ma-none scroll",style:{"max-height":"50vh"}},{default:l(()=>[P.value.run_on_server?h("",!0):(o(),r(Me,{key:0,label:"Output",data:T.value},null,8,["data"])),t(ce),P.value.run_on_server?h("",!0):(o(),w("pre",oa,b(T.value),1)),P.value.run_on_server?(o(),r(M,{key:2,class:"scroll"},{default:l(()=>[g("div",null,[x[20]||(x[20]=i(" Run Time: ")),g("code",null,b(T.value.execution_time)+" seconds",1),x[21]||(x[21]=g("br",null,null,-1)),x[22]||(x[22]=i("Return Code: ")),g("code",null,b(T.value.retcode),1),x[23]||(x[23]=g("br",null,null,-1))]),x[24]||(x[24]=g("br",null,null,-1)),T.value.stdout?(o(),w("div",sa,[t(Me,{label:"Standard Output",data:T.value.stdout},null,8,["data"]),t(ce),g("pre",null,b(T.value.stdout),1)])):h("",!0),T.value.stderr?(o(),w("div",ia,[t(Me,{label:"Standard Error",data:T.value.stderr},null,8,["data"]),t(ce),g("pre",null,b(T.value.stderr),1)])):h("",!0)]),_:1})):h("",!0)]),_:1})):h("",!0)]),_:1})]),_:1})]),_:1},8,["onHide","onKeydown","maximized"]))}}),da=Ze({__name:"IntegrationsContextMenu",props:{type:{},id:{}},setup(s){return(e,d)=>(o(),r(be,{anchor:"top end",self:"top start"},{default:l(()=>[t(te,null,{default:l(()=>[(o(!0),w(ue,null,de(e.$integrations[e.type+"MenuIntegrations"],a=>S((o(),r(p,{key:a.name,dense:"",clickable:"",onClick:u=>a.type==="dialog"?e.$q.dialog({component:a.component,componentProps:a.props?a.props(e.id,e.type):void 0}):void 0,to:a.type==="route"?a.uri:void 0},{default:l(()=>[t(f,null,{default:l(()=>[i(b(a.name),1)]),_:2},1024)]),_:2},1032,["onClick","to"])),[[q]])),128))]),_:1})]),_:1}))}}),ua={name:"AgentActionMenu",components:{IntegrationsContextMenu:da},props:{agent:!Object},setup(){const s=ke(),e=ae(),d=je("refreshDashboard"),a=D([]),u=D([]),k=D(!1);function c(y){s.dialog({component:$l,componentProps:{agent_id:y}}).onOk(d)}function n(y){s.dialog({component:cl,componentProps:{agent:y}})}async function m(){k.value=!0;try{if(a.value=(await Ft()).filter(y=>y.action_type==="web").sort((y,R)=>y.name.localeCompare(R.name)),a.value.length===0){Oe("No URL Actions configured. Go to Settings > General Settings > URL Actions");return}}catch(y){console.error(y)}finally{k.value=!1}}function _(y){s.dialog({component:aa,componentProps:{agent:y}})}function O(y,R=void 0){s.dialog({component:ra,componentProps:{agent:y,script:R}})}async function N(){u.value=[],k.value=!0;try{const R=(await ml({showCommunityScripts:e.state.showCommunityScripts})).filter(oe=>!!oe.favorite);if(R.length===0){Oe("You don't have any scripts favorited!");return}u.value=R.map(oe=>({label:oe.name,value:oe.id,timeout:oe.default_timeout,args:oe.args})).sort((oe,Qe)=>oe.label.localeCompare(Qe.label))}catch(y){console.error(y)}}async function H(y){let R={maintenance_mode:!y.maintenance_mode};try{await Qt(y.agent_id,R),W(`Maintenance mode was ${y.maintenance_mode?"disabled":"enabled"} on ${y.hostname}`),e.commit("setRefreshSummaryTab",!0),d()}catch(oe){console.error(oe)}}async function A(y){try{await ut(y.agent_id),W(`Scan will be run shortly on ${y.hostname}`)}catch(R){console.error(R)}}async function Q(y){try{const R=await ct(y.agent_id);W(R)}catch(R){console.error(R)}}async function K(y){try{const R=await st(y.agent_id);W(R)}catch(R){console.error(R)}}async function P(y){try{const R=await Et(y.agent_id);W(R)}catch(R){console.error(R)}}function T(y){s.dialog({component:jl,componentProps:{agent:y}}).onOk(d)}function B(y){s.dialog({title:"Are you sure?",message:`Reboot ${y.hostname} now`,cancel:!0,persistent:!0}).onOk(async()=>{s.loading.show();try{await Lt(y.agent_id),W(`${y.hostname} will now be restarted`),s.loading.hide()}catch(R){s.loading.hide(),console.error(R)}})}function I(y){s.dialog({title:'Please type <code style="color:red">yes</code> in the box below to confirm shutdown.',prompt:{model:"",type:"text",isValid:R=>R==="yes"},cancel:!0,ok:{label:"Shutdown",color:"negative"},persistent:!0,html:!0}).onOk(async()=>{s.loading.show();try{await Wt(y.agent_id),W(`${y.hostname} will now be shutdown`),s.loading.hide()}catch(R){s.loading.hide(),console.error(R)}})}function F(y){s.dialog({component:El,componentProps:{type:"agent",object:y}}).onOk(d)}function X(y){s.dialog({component:Il,componentProps:{agent:y}})}async function ne(y){try{s.loading.show();const R=await jt(y.agent_id);s.loading.hide(),R.status==="offline"?s.dialog({title:"Agent offline",message:`${y.hostname} cannot be contacted.
                  Would you like to continue with the uninstall?
                  If so, the agent will need to be manually uninstalled from the computer.`,cancel:{label:"No",color:"negative"},ok:{label:"Yes",color:"positive"},persistent:!0}).onOk(()=>x(y)).onCancel(()=>{}):R.status==="online"?x(y):tt("Something went wrong")}catch(R){s.loading.hide(),console.error(R)}}function x(y){s.dialog({title:'Please type <code style="color:red">yes</code> in the box below to confirm deletion.',prompt:{model:"",type:"text",isValid:R=>R==="yes"},cancel:!0,ok:{label:"Uninstall",color:"negative"},persistent:!0,html:!0}).onOk(async()=>{try{const R=await Bt(y.agent_id);W(R),d(!1,!0)}catch(R){console.error(R)}})}return{urlActions:a,favoriteScripts:u,runRemoteBackground:Ht,showEditAgent:c,showPendingActionsModal:n,runTakeControl:et,getURLActions:m,runURLAction:It,showSendCommand:_,showRunScript:O,getFavoriteScripts:N,toggleMaintenance:H,runPatchStatusScan:A,installPatches:Q,runChecks:K,showRebootLaterModal:T,rebootNow:B,shutdown:I,showPolicyAdd:F,showAgentRecovery:X,pingAgent:ne,wakeUp:P}}};function ca(s,e,d,a,u,k){const c=E("integrations-context-menu");return o(),r(te,{dense:"",style:{"min-width":"200px"}},{default:l(()=>[S((o(),r(p,{class:"acc-item",clickable:"",onClick:e[0]||(e[0]=n=>a.showEditAgent(d.agent.agent_id))},{default:l(()=>[t(f,{side:""},{default:l(()=>[t(v,{class:"icon",size:"xs",name:"fas fa-edit"})]),_:1}),t(f,null,{default:l(()=>[i("Edit "+b(d.agent.hostname),1)]),_:1})]),_:1})),[[q]]),S((o(),r(p,{class:"acc-item",clickable:"",onClick:e[1]||(e[1]=n=>a.showPendingActionsModal(d.agent))},{default:l(()=>[t(f,{side:""},{default:l(()=>[t(v,{class:"icon",size:"xs",name:"far fa-clock"})]),_:1}),t(f,null,{default:l(()=>e[17]||(e[17]=[i("Pending Agent Actions")])),_:1})]),_:1})),[[q]]),d.agent.plat!=="linux"?S((o(),r(p,{key:0,clickable:"",class:"acc-item",onClick:e[2]||(e[2]=n=>a.runTakeControl(d.agent.agent_id))},{default:l(()=>[t(f,{side:""},{default:l(()=>[t(v,{class:"icon",size:"xs",name:"fas fa-desktop"})]),_:1}),t(f,null,{default:l(()=>e[18]||(e[18]=[i("Take Control")])),_:1})]),_:1})),[[me],[q]]):S((o(),r(p,{key:1,clickable:"",class:"acc-item",onClick:e[3]||(e[3]=n=>a.runRemoteBackground(d.agent.agent_id,d.agent.plat))},{default:l(()=>[t(f,{side:""},{default:l(()=>[t(v,{class:"icon",size:"xs",name:"fas fa-desktop"})]),_:1}),t(f,null,{default:l(()=>e[19]||(e[19]=[i("Take Control")])),_:1})]),_:1})),[[me],[q]]),S((o(),r(p,{class:"acc-item",clickable:"",onClick:a.getURLActions},{default:l(()=>[t(f,{side:""},{default:l(()=>[t(v,{class:"icon",size:"xs",name:"open_in_new"})]),_:1}),t(f,null,{default:l(()=>e[20]||(e[20]=[i("Run URL Action")])),_:1}),t(f,{side:""},{default:l(()=>[t(v,{class:"icon",name:"keyboard_arrow_right"})]),_:1}),t(be,{"auto-close":"",anchor:"top end",self:"top start"},{default:l(()=>[t(te,null,{default:l(()=>[(o(!0),w(ue,null,de(a.urlActions,n=>S((o(),r(p,{key:n.id,dense:"",clickable:"",onClick:m=>a.runURLAction({agent_id:d.agent.agent_id,action:n.id})},{default:l(()=>[i(b(n.name),1)]),_:2},1032,["onClick"])),[[q]])),128))]),_:1})]),_:1})]),_:1},8,["onClick"])),[[me]]),S((o(),r(p,{class:"acc-item",clickable:"",onClick:e[4]||(e[4]=n=>a.showSendCommand(d.agent))},{default:l(()=>[t(f,{side:""},{default:l(()=>[t(v,{class:"icon",size:"xs",name:"fas fa-terminal"})]),_:1}),t(f,null,{default:l(()=>e[21]||(e[21]=[i("Send Command")])),_:1})]),_:1})),[[me],[q]]),S((o(),r(p,{class:"acc-item",clickable:"",onClick:e[5]||(e[5]=n=>a.showRunScript(d.agent))},{default:l(()=>[t(f,{side:""},{default:l(()=>[t(v,{class:"icon",size:"xs",name:"fas fa-terminal"})]),_:1}),t(f,null,{default:l(()=>e[22]||(e[22]=[i("Run Script")])),_:1})]),_:1})),[[me],[q]]),S((o(),r(p,{class:"acc-item",clickable:"",onClick:a.getFavoriteScripts},{default:l(()=>[t(f,{side:""},{default:l(()=>[t(v,{class:"icon",size:"xs",name:"star"})]),_:1}),t(f,null,{default:l(()=>e[23]||(e[23]=[i("Run Favorited Script")])),_:1}),t(f,{side:""},{default:l(()=>[t(v,{class:"icon",name:"keyboard_arrow_right"})]),_:1}),t(be,{"auto-close":"",anchor:"top end",self:"top start"},{default:l(()=>[t(te,null,{default:l(()=>[(o(!0),w(ue,null,de(a.favoriteScripts,n=>S((o(),r(p,{key:n.value,dense:"",clickable:"",onClick:m=>a.showRunScript(d.agent,n.value)},{default:l(()=>[i(b(n.label),1)]),_:2},1032,["onClick"])),[[q]])),128))]),_:1})]),_:1})]),_:1},8,["onClick"])),[[me]]),e[37]||(e[37]=i(" > ")),S((o(),r(p,{class:"acc-item",clickable:"",onClick:e[6]||(e[6]=n=>a.toggleMaintenance(d.agent))},{default:l(()=>[t(f,{side:""},{default:l(()=>[t(v,{class:"icon",size:"xs",name:"construction"})]),_:1}),t(f,null,{default:l(()=>[i(b(d.agent.maintenance_mode?"Disable Maintenance Mode":"Enable Maintenance Mode"),1)]),_:1})]),_:1})),[[q]]),t(p,{class:"acc-item",clickable:""},{default:l(()=>[t(f,{side:""},{default:l(()=>[t(v,{class:"icon",size:"xs",name:"system_update"})]),_:1}),t(f,null,{default:l(()=>e[24]||(e[24]=[i("Patch Management")])),_:1}),t(f,{side:""},{default:l(()=>[t(v,{class:"icon",name:"keyboard_arrow_right"})]),_:1}),t(be,{"auto-close":"",anchor:"top right",self:"top left"},{default:l(()=>[t(te,{dense:"",style:{"min-width":"100px"}},{default:l(()=>[S((o(),r(p,{class:"acc-item",clickable:"",onClick:e[7]||(e[7]=n=>a.runPatchStatusScan(d.agent))},{default:l(()=>[t(f,null,{default:l(()=>e[25]||(e[25]=[i("Run Patch Status Scan")])),_:1})]),_:1})),[[me]]),S((o(),r(p,{class:"acc-item",clickable:"",onClick:e[8]||(e[8]=n=>a.installPatches(d.agent))},{default:l(()=>[t(f,null,{default:l(()=>e[26]||(e[26]=[i("Install Patches Now")])),_:1})]),_:1})),[[me]])]),_:1})]),_:1})]),_:1}),S((o(),r(p,{class:"acc-item",clickable:"",onClick:e[9]||(e[9]=n=>a.runChecks(d.agent))},{default:l(()=>[t(f,{side:""},{default:l(()=>[t(v,{class:"icon",size:"xs",name:"fas fa-check-double"})]),_:1}),t(f,null,{default:l(()=>e[27]||(e[27]=[i("Run Checks")])),_:1})]),_:1})),[[q]]),S((o(),r(p,{class:"acc-item",clickable:"",onClick:e[10]||(e[10]=n=>a.wakeUp(d.agent))},{default:l(()=>[t(f,{side:""},{default:l(()=>[t(v,{class:"icon",size:"xs",name:"offline_bolt"})]),_:1}),t(f,null,{default:l(()=>e[28]||(e[28]=[i("Wake-Up (WoL)")])),_:1})]),_:1})),[[q]]),t(p,{class:"acc-item",clickable:""},{default:l(()=>[t(f,{side:""},{default:l(()=>[t(v,{class:"icon",size:"xs",name:"power_settings_new"})]),_:1}),t(f,null,{default:l(()=>e[29]||(e[29]=[i("Reboot")])),_:1}),t(f,{side:""},{default:l(()=>[t(v,{class:"icon",name:"keyboard_arrow_right"})]),_:1}),t(be,{"auto-close":"",anchor:"top right",self:"top left"},{default:l(()=>[t(te,{dense:"",style:{"min-width":"100px"}},{default:l(()=>[S((o(),r(p,{class:"acc-item",clickable:"",onClick:e[11]||(e[11]=n=>a.rebootNow(d.agent))},{default:l(()=>[t(f,null,{default:l(()=>e[30]||(e[30]=[i("Now")])),_:1})]),_:1})),[[me]]),S((o(),r(p,{class:"acc-item",clickable:"",onClick:e[12]||(e[12]=n=>a.showRebootLaterModal(d.agent))},{default:l(()=>[t(f,null,{default:l(()=>e[31]||(e[31]=[i("Later")])),_:1})]),_:1})),[[me]])]),_:1})]),_:1})]),_:1}),S((o(),r(p,{class:"acc-item",clickable:"",onClick:e[13]||(e[13]=n=>a.shutdown(d.agent))},{default:l(()=>[t(f,{side:""},{default:l(()=>[t(v,{class:"icon",size:"xs",name:"power"})]),_:1}),t(f,null,{default:l(()=>e[32]||(e[32]=[i("Shutdown")])),_:1})]),_:1})),[[q]]),S((o(),r(p,{class:"acc-item",clickable:"",onClick:e[14]||(e[14]=n=>a.showPolicyAdd(d.agent))},{default:l(()=>[t(f,{side:""},{default:l(()=>[t(v,{class:"icon",size:"xs",name:"policy"})]),_:1}),t(f,null,{default:l(()=>e[33]||(e[33]=[i("Assign Automation Policy")])),_:1})]),_:1})),[[q]]),s.$integrations&&s.$integrations.agentMenuIntegrations&&s.$integrations.agentMenuIntegrations.length>0?(o(),r(p,{key:2,class:"acc-item",clickable:""},{default:l(()=>[t(f,{side:""},{default:l(()=>[t(v,{class:"icon",size:"xs",name:"analytics"})]),_:1}),t(f,null,{default:l(()=>e[34]||(e[34]=[i("Reporting")])),_:1}),t(f,{side:""},{default:l(()=>[t(v,{class:"icon",name:"keyboard_arrow_right"})]),_:1}),t(c,{type:"agent",id:d.agent.agent_id},null,8,["id"])]),_:1})):h("",!0),S((o(),r(p,{class:"acc-item",clickable:"",onClick:e[15]||(e[15]=n=>a.showAgentRecovery(d.agent))},{default:l(()=>[t(f,{side:""},{default:l(()=>[t(v,{class:"icon",size:"xs",name:"fas fa-first-aid"})]),_:1}),t(f,null,{default:l(()=>e[35]||(e[35]=[i("Agent Recovery")])),_:1})]),_:1})),[[q]]),S((o(),r(p,{class:"acc-item",clickable:"",onClick:e[16]||(e[16]=n=>a.pingAgent(d.agent))},{default:l(()=>[t(f,{side:""},{default:l(()=>[t(v,{class:"icon",size:"xs",name:"delete"})]),_:1}),t(f,null,{default:l(()=>e[36]||(e[36]=[i("Remove Agent")])),_:1})]),_:1})),[[q]]),t(ce)]),_:1})}var ma=J(ua,[["render",ca]]);const fa={name:"SummaryTab",components:{AgentActionMenu:ma,Icon:Pe},setup(){const s=ae(),e=C(()=>s.state.selectedRow),d=C(()=>s.state.refreshSummaryTab),a=C(()=>s.state.dash_info_color),u=C(()=>s.state.dash_positive_color),k=C(()=>s.state.dash_negative_color),c=C(()=>s.state.dash_warning_color),n=D(null),m=D(null),_=D(!1),O=C(()=>n.value.plat==="windows"?n.value.wmi_detail.bios?.[0]?.[0]?.SerialNumber:n.value.wmi_detail.serialnumber),N=C(()=>n.value.cpu_model?.length>1?`${n.value.cpu_model.length}x ${n.value.cpu_model[0]}`:n.value.cpu_model[0]);function H(T){return T<80?u.value:T>=80&&T<95?c.value:k.value}const A=C(()=>{if(!n.value.disks)return[];const T=Object.entries(n.value.disks),B=[];for(let[I,F]of T)B.push(F);return B}),Q=C(()=>{if(!n.value.custom_fields)return[];if(!m.value)return[];const T=[];for(const B of n.value.custom_fields){const I=m.value.find(F=>F.id===B.field);I&&!I.hide_in_summary&&B.value?.length>0&&T.push({name:I.name,value:B.value})}return T});async function K(){_.value=!0,n.value=await Le(e.value),m.value=await Kt(),s.commit("setRefreshSummaryTab",!1),s.commit("setAgentPlatform",n.value.plat),_.value=!1}async function P(){_.value=!0,n.value=await Le(e.value);try{const T=await Xt(e.value);await K(),W(T)}catch(T){console.error(T)}_.value=!1}return ge(e,T=>{T&&K()}),ge(d,T=>{T&&e.value&&K(),s.commit("setRefreshSummaryTab",!1)}),he(()=>{e.value&&K()}),{summary:n,customFields:Q,loading:_,selectedAgent:e,disks:A,dash_info_color:a,dash_positive_color:u,dash_warning_color:c,dash_negative_color:k,serial_number:O,cpu:N,store:s,getSummary:K,refreshSummary:P,diskBarColor:H,runTakeControl:et,openAgentWindow:Gt}}},ga={key:0,class:"text-sm p-3 font-semibold"},_a={key:1,class:"q-pa-md flex flex-center"},ba={key:2,class:""},ya={class:"ac"},ha={key:0,class:"inline-flex items-center gap-1 bg-red-100 text-red-800 text-xs font-medium me-2 px-2.5 py-0.5 rounded-sm dark:bg-red-900 dark:text-red-300"},ka={key:1,class:"inline-flex items-center gap-1 bg-yellow-100 text-yellow-800 text-xs font-medium me-2 px-2.5 py-0.5 rounded-sm dark:bg-yellow-900 dark:text-yellow-300"},va={key:2,class:"inline-flex items-center gap-1 bg-green-100 text-green-800 text-xs font-medium me-2 px-2.5 py-0.5 rounded-sm dark:bg-green-900 dark:text-green-300"},wa={class:"navbar-hostname"},pa={key:0},Ca={class:"navbar-opsys"},xa={class:"row top-border"},Sa={class:"col-5"},Va={class:"detail-icon desktop"},Aa={class:"detail-icon"},Ta={class:"detail-icon"},Pa={class:"detail-icon"},Ua={class:"detail-icon"},qa={class:"detail-icon"},za={class:"detail-icon"},Da={class:"detail-icon"},Ra={class:"detail-icon"},Ma={class:"col-4 px-6"},Oa={class:"ac gap-3"},Na={class:"font-semibold text-lg"},Ha={class:"text-gray-400 font-semibold"},Ia={class:"col-3 px-2"},Fa={key:0},Qa={key:4},Ea={key:1},La={key:2,class:"text-subtitle2 text-bold block q-mt-xl"};function Wa(s,e,d,a,u,k){const c=E("Icon"),n=E("AgentActionMenu");return a.selectedAgent?!a.summary&&a.loading?(o(),w("div",_a,[t(Dl,{indeterminate:"",size:"10px",color:"primary",class:"q-ma-md"})])):a.summary?(o(),w("div",ba,[t(xe,{dense:"",style:{"background-color":"transparent",height:"45px"}},{default:l(()=>[g("button",{class:"btn-sm btn btn-none-primary",onClick:e[0]||(e[0]=(...m)=>a.refreshSummary&&a.refreshSummary(...m))},[t(c,{icon:"lucide:rotate-cw",width:"20",height:"20",class:""})]),g("div",ya,[a.summary.status==="offline"?(o(),w("span",ha,[t(c,{icon:"lucide:circle-x",width:"14",height:"14",class:"text-white"}),e[3]||(e[3]=i(" Offline "))])):a.summary.status==="overdue"?(o(),w("span",ka,[t(c,{icon:"lucide:cloud-alert",width:"14",height:"14",class:"text-white"}),e[4]||(e[4]=i(" Overdue "))])):(o(),w("span",va,[t(c,{icon:"lucide:check",width:"14",height:"14",class:"text-white"}),e[5]||(e[5]=i(" Online "))]))]),g("div",wa,b(a.summary.hostname),1),a.summary.maintenance_mode?(o(),w("span",pa,[e[7]||(e[7]=i(" \u2022 ")),t(lt,{color:"green"},{default:l(()=>e[6]||(e[6]=[i("Maintenance Mode")])),_:1})])):h("",!0),g("div",Ca,"\u2022 Agent v"+b(a.summary.version),1),t(le),g("button",{class:"btn btn-none-primary btn-sm mr-4 gap-2",onClick:e[1]||(e[1]=m=>a.runTakeControl(a.selectedAgent))},[t(c,{icon:"lucide:app-window",width:"20",height:"20"}),t(V,null,{default:l(()=>e[8]||(e[8]=[i("Popout")])),_:1})]),g("button",{class:"btn btn-none-primary btn-sm mr-1",onClick:e[2]||(e[2]=m=>a.runTakeControl(a.selectedAgent))},[t(c,{icon:"lucide:joystick",width:"20",height:"20"}),t(V,null,{default:l(()=>e[9]||(e[9]=[i("Remote Control")])),_:1})]),t(nt,{dense:"",flat:"","no-caps":"",class:"btn btn-none-primary btn-sm"},{label:l(()=>[t(c,{icon:"lucide:ellipsis-vertical",width:"20",height:"20"}),t(V,null,{default:l(()=>e[10]||(e[10]=[i("Other actions")])),_:1})]),default:l(()=>[t(n,{agent:a.summary},null,8,["agent"])]),_:1})]),_:1}),g("div",xa,[g("div",Sa,[e[11]||(e[11]=g("div",{class:"detail-header"},[g("h3",{class:"card-title text-lg font-semibold"},"Hardware Details")],-1)),t(te,{dense:""},{default:l(()=>[t(p,{class:"detail-item"},{default:l(()=>[t(f,{avatar:""},{default:l(()=>[g("div",Va,[t(c,{icon:"lucide:monitor"})])]),_:1}),t(f,{class:"detail-label"},{default:l(()=>[i(b(a.summary.make_model),1)]),_:1})]),_:1}),t(p,{class:"detail-item"},{default:l(()=>[t(f,{avatar:""},{default:l(()=>[g("div",Aa,[t(c,{icon:"lucide:cpu"})])]),_:1}),t(f,{class:"detail-label"},{default:l(()=>[i(b(a.cpu),1)]),_:1})]),_:1}),t(p,{class:"detail-item"},{default:l(()=>[t(f,{avatar:""},{default:l(()=>[g("div",Ta,[t(c,{icon:"lucide:app-window-mac"})])]),_:1}),t(f,{class:"detail-label"},{default:l(()=>[i(b(a.summary.operating_system),1)]),_:1})]),_:1}),t(p,{class:"detail-item"},{default:l(()=>[t(f,{avatar:""},{default:l(()=>[g("div",Pa,[t(c,{icon:"lucide:memory-stick"})])]),_:1}),t(f,{class:"detail-label"},{default:l(()=>[i(b(a.summary.total_ram)+" GB RAM",1)]),_:1})]),_:1}),(o(!0),w(ue,null,de(a.summary.physical_disks,(m,_)=>(o(),r(p,{class:"detail-item",key:m+_},{default:l(()=>[t(f,{class:"detail-item",avatar:""},{default:l(()=>[g("div",Ua,[t(c,{icon:"lucide:hard-drive"})])]),_:1}),t(f,{class:"detail-label"},{default:l(()=>[i(b(m),1)]),_:2},1024)]),_:2},1024))),128)),t(p,{class:"detail-item"},{default:l(()=>[t(f,{avatar:""},{default:l(()=>[g("div",qa,[t(c,{icon:"lucide:tv"})])]),_:1}),t(f,{class:"detail-label"},{default:l(()=>[i(b(a.summary.graphics),1)]),_:1})]),_:1}),a.serial_number?(o(),r(p,{key:0,class:"detail-item"},{default:l(()=>[t(f,{avatar:""},{default:l(()=>[g("div",za,[t(c,{icon:"lucide:barcode"})])]),_:1}),t(f,{class:"detail-label"},{default:l(()=>[i(b(a.serial_number),1)]),_:1})]),_:1})):h("",!0),t(p,{class:"detail-item"},{default:l(()=>[t(f,{avatar:""},{default:l(()=>[g("div",Da,[t(c,{icon:"lucide:globe"})])]),_:1}),t(f,{class:"detail-label"},{default:l(()=>[i("Public IP: "+b(a.summary.public_ip),1)]),_:1})]),_:1}),t(p,{class:"detail-item"},{default:l(()=>[t(f,{avatar:""},{default:l(()=>[g("div",Ra,[t(c,{icon:"lucide:network"})])]),_:1}),t(f,{class:"detail-label"},{default:l(()=>[i("LAN IP: "+b(a.summary.local_ips),1)]),_:1})]),_:1})]),_:1})]),g("div",Ma,[e[12]||(e[12]=g("div",{class:"detail-header"},[g("h3",{class:"card-title text-lg font-semibold"},"Disks")],-1)),(o(!0),w(ue,null,de(a.disks,m=>(o(),w("div",{class:"disk-item",key:m.device},[g("div",Oa,[g("span",null,[t(c,{icon:"lucide:hard-drive",width:"20",height:"20"})]),g("h4",Na,b(m.device)+" ("+b(m.fstype)+") ",1)]),t(Ut,{rounded:"",size:"15px",value:m.percent/100,color:a.diskBarColor(m.percent),class:"q-mt-sm"},null,8,["value","color"]),g("span",Ha,b(m.free)+" free of "+b(m.total),1)]))),128))]),g("div",Ia,[e[13]||(e[13]=g("div",{class:"detail-header"},[g("h3",{class:"card-title text-lg font-semibold"},"Checks Status")],-1)),e[14]||(e[14]=g("br",null,null,-1)),a.summary.checks.total!==0?(o(),w("div",Fa,[a.summary.checks.passing?(o(),r(Re,{key:0,square:"",size:"lg"},{default:l(()=>[t(De,{size:"lg",square:"",icon:"done",color:a.dash_positive_color,"text-color":"white"},null,8,["color"]),g("small",null,b(a.summary.checks.passing)+" checks passing",1)]),_:1})):h("",!0),a.summary.checks.failing?(o(),r(Re,{key:1,square:"",size:"lg"},{default:l(()=>[t(De,{size:"lg",square:"",icon:"cancel",color:a.dash_negative_color,"text-color":"white"},null,8,["color"]),g("small",null,b(a.summary.checks.failing)+" checks failing",1)]),_:1})):h("",!0),a.summary.checks.warning?(o(),r(Re,{key:2,square:"",size:"lg"},{default:l(()=>[t(De,{size:"lg",square:"",icon:"warning",color:a.dash_warning_color,"text-color":"white"},null,8,["color"]),g("small",null,b(a.summary.checks.warning)+" checks warning",1)]),_:1})):h("",!0),a.summary.checks.info?(o(),r(Re,{key:3,square:"",size:"lg"},{default:l(()=>[t(De,{size:"lg",square:"",icon:"info",color:a.dash_info_color,"text-color":"white"},null,8,["color"]),g("small",null,b(a.summary.checks.info)+" checks info",1)]),_:1})):h("",!0),a.summary.checks.total!==0&&a.summary.checks.passing===0&&a.summary.checks.failing===0&&a.summary.checks.warning===0&&a.summary.checks.info===0?(o(),w("span",Qa,b(a.summary.checks.total)+" checks awaiting first synchronization",1)):h("",!0)])):(o(),w("div",Ea,"No checks")),a.customFields.length>0?(o(),w("span",La,"Custom Fields")):h("",!0),t(te,{dense:""},{default:l(()=>[(o(!0),w(ue,null,de(a.customFields,(m,_)=>(o(),r(p,{key:m+_},{default:l(()=>[t(f,{thumbnail:""},{default:l(()=>[t(v,{name:"fas fa-user",size:"xs"})]),_:1}),t(f,null,{default:l(()=>[i(b(m.name)+": "+b(m.value),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),e[15]||(e[15]=g("div",{class:"col-1"},null,-1))]),t(Ae,{showing:a.loading,color:"primary"},null,8,["showing"])])):h("",!0):(o(),w("div",ga," No agent selected "))}var ja=J(fa,[["render",Wa]]);const Ba={name:"CheckGraph",emits:["hide","ok","cancel"],components:{apexchart:fl},props:{check:!Object},data(){return{history:[],results:[],timeFilter:1,timeFilterOptions:[{value:1,label:"Last 24 Hours"},{value:7,label:"Last 7 Days"},{value:30,label:"Last 30 Days"},{value:0,label:"Everything"}],chartOptions:{tooltip:{x:{format:"dd MMM h:mm:sst"}},chart:{id:"chart2",type:"line",toolbar:{show:!0},animations:{enabled:!1}},colors:["#027BE3"],stroke:{width:3},dataLabels:{enabled:!1},fill:{opacity:1},markers:{size:1},xaxis:{type:"datetime",labels:{datetimeUTC:!1}},noData:{text:"No Data"},theme:{mode:this.$q.dark.isActive?"dark":"light"}}}},computed:{title(){return this.check.readable_desc+" history"},showChart(){return!this.$q.loading.isActive&&this.history.length>0},seriesName(){return this.check.check_type==="cpuload"?"CPU Load":this.check.check_type==="memory"?"Memory Usage":this.check.check_type==="diskspace"?"Disk Space Remaining":this.check.check_type==="script"?"Script Results":this.check.check_type==="eventlog"||this.check.check_type==="winsvc"||this.check.check_type==="ping"?"Status":""}},methods:{getChartData(){this.$q.loading.show(),this.$axios.patch(`/checks/${this.check.check_result.id}/history/`,{timeFilter:this.timeFilter}).then(s=>{this.history=Object.freeze(s.data),(this.check.check_type!=="cpuload"||this.check.check_type!=="memory"||this.check.check_type!=="diskspace")&&(this.results=Object.freeze(s.data)),this.$q.loading.hide()}).catch(()=>{this.$q.loading.hide()})},show(){this.$refs.dialog.show()},hide(){this.$refs.dialog.hide()},onHide(){this.$emit("hide")}},mounted(){this.check.check_type==="cpuload"||this.check.check_type==="memory"||this.check.check_type==="diskspace"?(this.chartOptions.annotations={position:"front",yaxis:[]},this.check.error_threshold&&this.chartOptions.annotations.yaxis.push({y:this.check.error_threshold,strokeDashArray:0,borderColor:"#C10015",label:{position:"left",offsetX:100,borderColor:"#C10015",style:{color:"#FFF",background:"#C10015"},text:"Error Threshold"}}),this.check.warning_threshold&&this.chartOptions.annotations.yaxis.push({y:this.check.warning_threshold,strokeDashArray:0,borderColor:"#ff9800",label:{position:"left",offsetX:100,borderColor:"#ff9800",style:{color:"#FFF",background:"#ff9800"},text:"Warning Threshold"}}),this.chartOptions.yaxis={min:0,max:100,labels:{formatter:s=>s+"%"}},this.check.check_type==="diskspace"&&(this.chartOptions.yaxis.reversed=!0)):(this.chartOptions.yaxis={min:-1,max:2,tickAmount:0,reversed:!0,forceNiceScale:!0,labels:{minWidth:50,formatter:s=>s===0?"Passing":s===1?"Failing":""}},this.chartOptions.tooltip.y={title:{formatter:()=>""},formatter:(s,{dataPointIndex:e})=>{let d="";return this.check.check_type==="script"?(d+="Return Code: "+this.results[e].results.retcode+"<br/>",d+="Std Out: "+this.results[e].results.stdout+"<br/>",d+="Err Out: "+this.results[e].results.errout+"<br/>",d+="Execution Time: "+this.results[e].results.execution_time+"<br/>"):d+=this.results[e].results,d}}),this.getChartData()}},Ga={class:"row"},Ka={key:0,class:"q-pa-md"};function Xa(s,e,d,a,u,k){const c=E("apexchart");return o(),r(pe,{ref:"dialog",onHide:k.onHide},{default:l(()=>[t(ye,{class:"q-dialog-plugin",style:{"min-width":"80vw","min-height":"65vh","overflow-x":"hidden"}},{default:l(()=>[t(xe,null,{default:l(()=>[t(L,{onClick:k.getChartData,class:"q-mr-sm",dense:"",flat:"",push:"",icon:"refresh"},null,8,["onClick"]),i(" "+b(k.title)+" ",1),t(le),S((o(),r(L,{dense:"",flat:"",icon:"close"},{default:l(()=>[t(V,{class:"bg-white text-primary"},{default:l(()=>e[1]||(e[1]=[i("Close")])),_:1})]),_:1})),[[q]])]),_:1}),g("div",Ga,[k.showChart?h("",!0):(o(),w("span",Ka,"No Data")),t(le),t(at,{modelValue:u.timeFilter,"onUpdate:modelValue":[e[0]||(e[0]=n=>u.timeFilter=n),k.getChartData],"emit-value":"","map-options":"",style:{width:"200px"},options:u.timeFilterOptions,outlined:"",dense:"",class:"q-pr-md q-pt-md"},null,8,["modelValue","options","onUpdate:modelValue"])]),k.showChart?(o(),r(c,{key:0,class:"q-pt-md",type:"line",height:"70%",options:u.chartOptions,series:[{name:k.seriesName,data:u.history}]},null,8,["options","series"])):h("",!0)]),_:1})]),_:1},8,["onHide"])}var Ya=J(Ba,[["render",Xa]]);const Ja=[{name:"smsalert",field:"text_alert",align:"left"},{name:"emailalert",field:"email_alert",align:"left"},{name:"dashboardalert",field:"dashboard_alert",align:"left"},{name:"policystatus",align:"left"},{name:"statusicon",align:"left"},{name:"desc",field:"readable_desc",label:"Description",align:"left",sortable:!0},{name:"moreinfo",label:"More Info",field:"more_info",align:"left",sortable:!0},{name:"datetime",label:"Last Run",field:"last_run",align:"left",sortable:!0},{name:"assignedtasks",label:"Assigned Tasks",field:"assigned_task",align:"left",sortable:!0}],Za={name:"ChecksTab",setup(){const s=ae(),e=C(()=>s.state.selectedRow),d=C(()=>s.state.tabHeight),a=C(()=>s.state.agentPlatform),u=C(()=>s.getters.formatDate),k=C(()=>s.state.dash_info_color),c=C(()=>s.state.dash_positive_color),n=C(()=>s.state.dash_negative_color),m=C(()=>s.state.dash_warning_color),_=ke(),O=je("refreshDashboard"),N=D([]),H=D(!1),A=D({rowsPerPage:0,sortBy:"status",descending:!1});function Q(U,Z){try{const ee=U.split(`
`),Ee=[];for(const Ke of ee)Z.every(mt=>Ke.includes(mt))&&Ee.push(Ke);return Ee.length>0?Ee.join(`
`):"Last Output"}catch(ee){return console.error(ee),"Last Output"}}function K(U){try{return U.stdout&&U.stdout.trim()!==""?U.stdout.substring(0,60):U.stderr&&U.stderr.trim()!==""?U.stderr.substring(0,60):"Last Output"}catch(Z){return console.error(Z),"Last Output"}}function P(U){return U.check_result.alert_severity?U.check_result.alert_severity:U.alert_severity}async function T(){try{const U=await st(e.value);W(U)}catch(U){console.error(U)}}async function B(){H.value=!0,N.value=await Yt(e.value),H.value=!1}async function I(U,Z){if(!U.policy){H.value=!1;try{const ee=await gl(U.id,Z);await B(),W(ee)}catch(ee){console.error(ee)}H.value=!1}}function F(U){_.dialog({title:"Are you sure?",message:`Delete ${U.readable_desc}`,cancel:!0,ok:{label:"Delete",color:"negative"},persistent:!0}).onOk(async()=>{H.value=!0;try{const Z=await _l(U.id);await B(),W(Z)}catch(Z){console.error(Z)}H.value=!1})}async function X(U){U.check_result.status?U.check_result.status==="passing"&&Oe("Check is already passing"):Oe("Check hasn't run yet"),H.value=!0;try{const Z=await bl(U.check_result.id);await B(),W(Z),O(!1,!1)}catch(Z){console.error(Z)}H.value=!1}function ne(){_.dialog({title:"Are you sure?",message:"Reset all checks status",cancel:!0,ok:{label:"Reset",color:"negative"},persistent:!0}).onOk(async()=>{H.value=!0;try{const U=await yl(e.value);await B(),W(U)}catch(U){console.error(U)}H.value=!1})}function x(U){_.dialog({component:hl,componentProps:{evtLogData:U}})}function y(U){_.dialog({component:Ya,componentProps:{check:U}})}function R(U){_.dialog({component:Ge,componentProps:{scriptInfo:U}})}function oe(U){_.dialog({title:U.readable_desc,style:"width: 50vw; max-width: 60vw",message:`<pre>${U.check_result.more_info}</pre>`,html:!0})}function Qe(U,Z){if(Z&&Z.policy)return;let ee;if(U==="diskspace")ee=kl;else if(U==="memory")ee=vl;else if(U==="cpuload")ee=wl;else if(U==="ping")ee=pl;else if(U==="winsvc")ee=Cl;else if(U==="eventlog")ee=xl;else if(U==="script")ee=Sl;else return;_.dialog({component:ee,componentProps:{check:Z,parent:Z?void 0:{agent:e.value},plat:U==="script"?a.value:void 0}}).onOk(B)}return ge(e,U=>{U&&B()}),he(()=>{e.value&&B()}),{checks:N,loading:H,pagination:A,tabHeight:d,selectedAgent:e,agentPlatform:a,dash_info_color:k,dash_positive_color:c,dash_warning_color:m,dash_negative_color:n,columns:Ja,getChecks:B,editCheck:I,deleteCheck:F,resetCheckStatus:X,truncateText:qe,formatDate:u,getAlertSeverity:P,runChecks:T,resetAllChecks:ne,grep:Q,processOutput:K,showScriptOutput:R,showCheckModal:Qe,showCheckGraphModal:y,showEventInfo:x,showPingInfo:oe}},components:{Icon:Pe}},$a={key:0,class:"q-pa-sm p-3 font-semibold"},en={key:1},tn=["onClick"],ln=["onClick"],an=["onClick"],nn=["onClick"],on={key:4};function sn(s,e,d,a,u,k){const c=E("Icon");return a.selectedAgent?(o(),w("div",en,[t(Ve,{dense:"","table-class":{"table-bgcolor":!s.$q.dark.isActive,"table-bgcolor-dark":s.$q.dark.isActive},class:"tabs-tbl-sticky",style:Ce({"max-height":a.tabHeight}),rows:a.checks,columns:a.columns,"row-key":"id","binary-state-sort":"",pagination:a.pagination,"onUpdate:pagination":e[10]||(e[10]=n=>a.pagination=n),loading:a.loading,"rows-per-page-options":[0],"virtual-scroll":"","no-data-label":"No checks"},{loading:l(()=>[t(Ae,{showing:"",color:"primary"})]),top:l(()=>[g("button",{class:"btn btn-none-primary mr-2",onClick:e[0]||(e[0]=(...n)=>a.getChecks&&a.getChecks(...n))},[t(c,{icon:"lucide:rotate-cw",width:"20",height:"20",class:"icon mr-2"})]),t(nt,{class:"btn btn-primary mr-2",style:{height:"31px"},icon:"add",label:"New","no-caps":"",dense:"",flat:""},{default:l(()=>[t(te,{dense:"",style:{"min-width":"200px"}},{default:l(()=>[a.agentPlatform==="windows"?S((o(),r(p,{key:0,clickable:"",onClick:e[1]||(e[1]=n=>a.showCheckModal("diskspace"))},{default:l(()=>[t(f,{side:""},{default:l(()=>[t(v,{size:"xs",name:"far fa-hdd"})]),_:1}),t(f,null,{default:l(()=>e[11]||(e[11]=[i("Disk Space Check")])),_:1})]),_:1})),[[q]]):h("",!0),S((o(),r(p,{clickable:"",onClick:e[2]||(e[2]=n=>a.showCheckModal("ping"))},{default:l(()=>[t(f,{side:""},{default:l(()=>[t(v,{size:"xs",name:"fas fa-network-wired"})]),_:1}),t(f,null,{default:l(()=>e[12]||(e[12]=[i("Ping Check")])),_:1})]),_:1})),[[q]]),a.agentPlatform==="windows"?S((o(),r(p,{key:1,clickable:"",onClick:e[3]||(e[3]=n=>a.showCheckModal("cpuload"))},{default:l(()=>[t(f,{side:""},{default:l(()=>[t(v,{size:"xs",name:"fas fa-microchip"})]),_:1}),t(f,null,{default:l(()=>e[13]||(e[13]=[i("CPU Load Check")])),_:1})]),_:1})),[[q]]):h("",!0),a.agentPlatform==="windows"?S((o(),r(p,{key:2,clickable:"",onClick:e[4]||(e[4]=n=>a.showCheckModal("memory"))},{default:l(()=>[t(f,{side:""},{default:l(()=>[t(v,{size:"xs",name:"fas fa-memory"})]),_:1}),t(f,null,{default:l(()=>e[14]||(e[14]=[i("Memory Check")])),_:1})]),_:1})),[[q]]):h("",!0),a.agentPlatform==="windows"?S((o(),r(p,{key:3,clickable:"",onClick:e[5]||(e[5]=n=>a.showCheckModal("winsvc"))},{default:l(()=>[t(f,{side:""},{default:l(()=>[t(v,{size:"xs",name:"fas fa-cogs"})]),_:1}),t(f,null,{default:l(()=>e[15]||(e[15]=[i("Windows Service Check")])),_:1})]),_:1})),[[q]]):h("",!0),S((o(),r(p,{clickable:"",onClick:e[6]||(e[6]=n=>a.showCheckModal("script"))},{default:l(()=>[t(f,{side:""},{default:l(()=>[t(v,{size:"xs",name:"fas fa-terminal"})]),_:1}),t(f,null,{default:l(()=>e[16]||(e[16]=[i("Script Check")])),_:1})]),_:1})),[[q]]),a.agentPlatform==="windows"?S((o(),r(p,{key:4,clickable:"",onClick:e[7]||(e[7]=n=>a.showCheckModal("eventlog"))},{default:l(()=>[t(f,{side:""},{default:l(()=>[t(v,{size:"xs",name:"fas fa-clipboard-list"})]),_:1}),t(f,null,{default:l(()=>e[17]||(e[17]=[i("Event Log Check")])),_:1})]),_:1})),[[q]]):h("",!0)]),_:1})]),_:1}),g("button",{class:"btn btn-primary mr-2",onClick:e[8]||(e[8]=(...n)=>a.runChecks&&a.runChecks(...n))},[t(c,{icon:"lucide:play",width:"20",height:"20",class:"icon mr-2"}),e[18]||(e[18]=g("span",null,"Run Checks Now",-1))]),g("button",{class:"btn btn-primary",onClick:e[9]||(e[9]=(...n)=>a.resetAllChecks&&a.resetAllChecks(...n))},[t(c,{icon:"lucide:list-restart",width:"20",height:"20",class:"icon mr-2"}),e[19]||(e[19]=g("span",null,"Reset All Checks Status",-1))])]),"header-cell-smsalert":l(n=>[t(se,{"auto-width":"",props:n},{default:l(()=>[t(v,{name:"phone_android",size:"1.5em"},{default:l(()=>[t(V,null,{default:l(()=>e[20]||(e[20]=[i("SMS Alert")])),_:1})]),_:1})]),_:2},1032,["props"])]),"header-cell-emailalert":l(n=>[t(se,{"auto-width":"",props:n},{default:l(()=>[t(v,{name:"email",size:"1.5em"},{default:l(()=>[t(V,null,{default:l(()=>e[21]||(e[21]=[i("Email Alert")])),_:1})]),_:1})]),_:2},1032,["props"])]),"header-cell-dashboardalert":l(n=>[t(se,{"auto-width":"",props:n},{default:l(()=>[t(v,{name:"notifications",size:"1.5em"},{default:l(()=>[t(V,null,{default:l(()=>e[22]||(e[22]=[i("Dashboard Alert")])),_:1})]),_:1})]),_:2},1032,["props"])]),"header-cell-statusicon":l(n=>[t(se,{"auto-width":"",props:n},null,8,["props"])]),"header-cell-policystatus":l(n=>[t(se,{"auto-width":"",props:n},null,8,["props"])]),body:l(n=>[t(Ne,{props:n,class:"cursor-pointer",onDblclick:m=>a.showCheckModal(n.row.check_type,n.row)},{default:l(()=>[t(be,{"context-menu":""},{default:l(()=>[t(te,{dense:"",style:{"min-width":"200px"}},{default:l(()=>[S((o(),r(p,{clickable:"",onClick:m=>a.showCheckModal(n.row.check_type,n.row),disable:!!n.row.policy},{default:l(()=>[t(f,{side:""},{default:l(()=>[t(v,{name:"edit"})]),_:1}),t(f,null,{default:l(()=>e[23]||(e[23]=[i("Edit")])),_:1})]),_:2},1032,["onClick","disable"])),[[q]]),S((o(),r(p,{clickable:"",onClick:m=>a.deleteCheck(n.row),disable:!!n.row.policy},{default:l(()=>[t(f,{side:""},{default:l(()=>[t(v,{name:"delete"})]),_:1}),t(f,null,{default:l(()=>e[24]||(e[24]=[i("Delete")])),_:1})]),_:2},1032,["onClick","disable"])),[[q]]),t(ce),S((o(),r(p,{clickable:"",onClick:m=>a.resetCheckStatus(n.row)},{default:l(()=>[t(f,{side:""},{default:l(()=>[t(v,{name:"info"})]),_:1}),t(f,null,{default:l(()=>e[25]||(e[25]=[i("Reset Check Status")])),_:1})]),_:2},1032,["onClick"])),[[q]]),t(ce),S((o(),r(p,{clickable:""},{default:l(()=>[t(f,null,{default:l(()=>e[26]||(e[26]=[i("Close")])),_:1})]),_:1})),[[q]])]),_:2},1024)]),_:2},1024),t(z,null,{default:l(()=>[n.row.alert_template&&n.row.alert_template.always_text!=null?(o(),r(Y,{key:0,modelValue:n.row.alert_template.always_text,"onUpdate:modelValue":m=>n.row.alert_template.always_text=m,disable:"",dense:""},{default:l(()=>[t(V,null,{default:l(()=>[i(" Setting is overridden by alert template: "+b(n.row.alert_template.name),1)]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue"])):(o(),r(Y,{key:1,dense:"","onUpdate:modelValue":[m=>a.editCheck(n.row,{text_alert:!n.row.text_alert}),m=>n.row.text_alert=m],modelValue:n.row.text_alert,disable:!!n.row.policy},null,8,["onUpdate:modelValue","modelValue","disable"]))]),_:2},1024),t(z,null,{default:l(()=>[n.row.alert_template&&n.row.alert_template.always_email!=null?(o(),r(Y,{key:0,modelValue:n.row.alert_template.always_email,"onUpdate:modelValue":m=>n.row.alert_template.always_email=m,disable:"",dense:""},{default:l(()=>[t(V,null,{default:l(()=>[i(" Setting is overridden by alert template: "+b(n.row.alert_template.name),1)]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue"])):(o(),r(Y,{key:1,dense:"","onUpdate:modelValue":[m=>a.editCheck(n.row,{email_alert:!n.row.email_alert}),m=>n.row.email_alert=m],modelValue:n.row.email_alert,disable:!!n.row.policy},null,8,["onUpdate:modelValue","modelValue","disable"]))]),_:2},1024),t(z,null,{default:l(()=>[n.row.alert_template&&n.row.alert_template.always_alert!==null?(o(),r(Y,{key:0,modelValue:n.row.alert_template.always_alert,"onUpdate:modelValue":m=>n.row.alert_template.always_alert=m,disable:"",dense:""},{default:l(()=>[t(V,null,{default:l(()=>[i(" Setting is overridden by alert template: "+b(n.row.alert_template.name),1)]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue"])):(o(),r(Y,{key:1,dense:"","onUpdate:modelValue":[m=>a.editCheck(n.row,{dashboard_alert:!n.row.dashboard_alert}),m=>n.row.dashboard_alert=m],modelValue:n.row.dashboard_alert,disable:!!n.row.policy},null,8,["onUpdate:modelValue","modelValue","disable"]))]),_:2},1024),n.row.policy?(o(),r(z,{key:0},{default:l(()=>[t(v,{style:{"font-size":"1.3rem"},name:"policy"},{default:l(()=>[t(V,null,{default:l(()=>e[27]||(e[27]=[i("This check is managed by a policy")])),_:1})]),_:1})]),_:1})):n.row.overridden_by_policy?(o(),r(z,{key:1},{default:l(()=>[t(v,{style:{"font-size":"1.3rem"},name:"remove_circle_outline"},{default:l(()=>[t(V,null,{default:l(()=>e[28]||(e[28]=[i("This check is overriden by a policy")])),_:1})]),_:1})]),_:1})):(o(),r(z,{key:2})),Object.keys(n.row.check_result).length===0?(o(),r(z,{key:3})):n.row.check_result.status==="passing"?(o(),r(z,{key:4},{default:l(()=>[t(v,{style:{"font-size":"1.3rem"},color:a.dash_positive_color,name:"check_circle"},{default:l(()=>[t(V,null,{default:l(()=>e[29]||(e[29]=[i("Passing")])),_:1})]),_:1},8,["color"])]),_:1})):n.row.check_result.status==="failing"?(o(),r(z,{key:5},{default:l(()=>[a.getAlertSeverity(n.row)==="info"?(o(),r(v,{key:0,style:{"font-size":"1.3rem"},color:a.dash_info_color,name:"info"},{default:l(()=>[t(V,null,{default:l(()=>e[30]||(e[30]=[i("Informational")])),_:1})]),_:1},8,["color"])):a.getAlertSeverity(n.row)==="warning"?(o(),r(v,{key:1,style:{"font-size":"1.3rem"},color:a.dash_warning_color,name:"warning"},{default:l(()=>[t(V,null,{default:l(()=>e[31]||(e[31]=[i("Warning")])),_:1})]),_:1},8,["color"])):(o(),r(v,{key:2,style:{"font-size":"1.3rem"},color:a.dash_negative_color,name:"error"},{default:l(()=>[t(V,null,{default:l(()=>e[32]||(e[32]=[i("Error")])),_:1})]),_:1},8,["color"]))]),_:2},1024)):(o(),r(z,{key:6})),t(z,null,{default:l(()=>[g("span",null,[i(b(a.truncateText(n.row.readable_desc,40))+" ",1),n.row.readable_desc.length>40?(o(),r(V,{key:0},{default:l(()=>[i(b(n.row.readable_desc),1)]),_:2},1024)):h("",!0)])]),_:2},1024),t(z,null,{default:l(()=>[n.row.check_result.id?(o(),w("span",{key:0,style:{cursor:"pointer","text-decoration":"underline"},class:"text-primary",onClick:m=>a.showCheckGraphModal(n.row)},"Show Run History",8,tn)):h("",!0),e[33]||(e[33]=i(" \xA0\xA0\xA0 ")),n.row.check_type==="ping"&&n.row.check_result.id?(o(),w("span",{key:1,style:{cursor:"pointer","text-decoration":"underline"},class:"text-primary",onClick:m=>a.showPingInfo(n.row)},b(a.grep(n.row.check_result.more_info,["transmitted","received","packet loss"])),9,ln)):n.row.check_type==="script"&&n.row.check_result.id?(o(),w("span",{key:2,style:{cursor:"pointer","text-decoration":"underline"},class:"text-primary",onClick:m=>a.showScriptOutput(n.row.check_result)},b(a.processOutput(n.row.check_result)),9,an)):n.row.check_type==="eventlog"&&n.row.check_result.id?(o(),w("span",{key:3,style:{cursor:"pointer","text-decoration":"underline"},class:"text-primary",onClick:m=>a.showEventInfo(n.row)},"Last Output",8,nn)):["diskspace","cpuload","memory"].includes(n.row.check_type)||n.row.check_type==="winsvc"&&n.row.check_result.id?(o(),w("span",on,b(n.row.check_result.more_info),1)):h("",!0)]),_:2},1024),t(z,null,{default:l(()=>[i(b(n.row.check_result.last_run?a.formatDate(n.row.check_result.last_run):"Never"),1)]),_:2},1024),n.row.assignedtasks.length>1?(o(),r(z,{key:7},{default:l(()=>[i(b(n.row.assignedtasks.length)+" Tasks",1)]),_:2},1024)):n.row.assignedtasks.length===1?(o(),r(z,{key:8},{default:l(()=>[i(b(n.row.assignedtasks[0].name),1)]),_:2},1024)):(o(),r(z,{key:9}))]),_:2},1032,["props","onDblclick"])]),_:1},8,["table-class","style","rows","columns","pagination","loading"])])):(o(),w("div",$a," No agent selected "))}var rn=J(Za,[["render",sn]]);const dn=[{name:"enabled",align:"left",field:"enabled"},{name:"smsalert",field:"text_alert",align:"left"},{name:"emailalert",field:"email_alert",align:"left"},{name:"dashboardalert",field:"dashboard_alert",align:"left"},{name:"policystatus",align:"left"},{name:"collector",label:"Collector",field:"custom_field",align:"left",sortable:!0},{name:"status",align:"left"},{name:"name",label:"Name",field:"name",align:"left",sortable:!0},{name:"sync_status",label:"Sync Status",field:"sync_status",align:"left",sortable:!0},{name:"moreinfo",label:"More Info",field:"more_info",align:"left",sortable:!0},{name:"datetime",label:"Last Run Time",field:"last_run",align:"left",sortable:!0},{name:"schedule",label:"Schedule",field:"schedule",align:"left",sortable:!0},{name:"assignedcheck",label:"Assigned Check",field:"assigned_check",align:"left",sortable:!0}],un={name:"AutomatedTasksTab",setup(){const s=ae(),e=C(()=>s.state.selectedRow),d=C(()=>s.state.tabHeight),a=C(()=>s.state.agentPlatform),u=C(()=>s.getters.formatDate),k=C(()=>s.state.dash_info_color),c=C(()=>s.state.dash_positive_color),n=C(()=>s.state.dash_negative_color),m=C(()=>s.state.dash_warning_color),_=ke(),O=D([]),N=D(!1),H=D({rowsPerPage:0,sortBy:"name",descending:!1});async function A(){N.value=!0;try{const F=await Jt(e.value);O.value=F.filter(X=>X.sync_status!=="pendingdeletion")}catch(F){console.error(F)}N.value=!1}async function Q(F,X){if(!F.policy){N.value=!0;try{const ne=await Vl(F.id,X);W(ne),A()}catch(ne){console.error(ne)}N.value=!1}}function K(F){F.policy||_.dialog({title:"Are you sure?",message:`Delete ${F.name} task`,cancel:!0,persistent:!0}).onOk(async()=>{N.value=!0;try{const X=await Al(F.id);W(X),A()}catch(X){console.error(X)}N.value=!1})}async function P(F){if(!F.enabled){tt("Task cannot be run when it's disabled. Enable it first.");return}N.value=!0;try{const X=await Tl(F.id,F.policy?{agent_id:e.value}:{});W(X)}catch(X){console.error(X)}N.value=!1}function T(){_.dialog({component:Xe,componentProps:{parent:{agent:e.value},plat:a.value}}).onOk(()=>{A()})}function B(F){F.policy||_.dialog({component:Xe,componentProps:{task:F,parent:{agent:e.value},plat:a.value}}).onOk(()=>{A()})}function I(F){_.dialog({component:Ge,componentProps:{scriptInfo:F.task_result}})}return ge(e,F=>{F&&A()}),he(()=>{e.value&&A()}),{tasks:O,loading:N,pagination:H,selectedAgent:e,tabHeight:d,agentPlatform:a,dash_info_color:k,dash_positive_color:c,dash_warning_color:m,dash_negative_color:n,columns:dn,formatDate:u,getTasks:A,editTask:Q,runWinTask:P,deleteTask:K,showAddTask:T,showEditTask:B,showScriptOutput:I,truncateText:qe}},components:{Icon:Pe}},cn={key:0,class:"q-pa-sm p-3 font-semibold"},mn={key:1},fn=["onClick"],gn={key:0};function _n(s,e,d,a,u,k){const c=E("Icon");return a.selectedAgent?(o(),w("div",mn,[t(Ve,{dense:"","table-class":{"table-bgcolor":!s.$q.dark.isActive,"table-bgcolor-dark":s.$q.dark.isActive},class:"tabs-tbl-sticky",style:Ce({"max-height":a.tabHeight}),rows:a.tasks,columns:a.columns,"row-key":"id","binary-state-sort":"","virtual-scroll":"",pagination:a.pagination,"onUpdate:pagination":e[2]||(e[2]=n=>a.pagination=n),loading:a.loading,"rows-per-page-options":[0],"no-data-label":"No tasks"},{top:l(()=>[g("button",{class:"btn btn-none-primary mr-2",onClick:e[0]||(e[0]=(...n)=>a.getTasks&&a.getTasks(...n))},[t(c,{icon:"lucide:rotate-cw",width:"20",height:"20",class:"icon mr-2"})]),g("button",{class:"btn btn-primary mr-2",onClick:e[1]||(e[1]=(...n)=>a.showAddTask&&a.showAddTask(...n))},[t(c,{icon:"lucide:plus",width:"20",height:"20",class:"icon mr-2"}),e[3]||(e[3]=g("span",null,"Add Task",-1))])]),loading:l(()=>[t(Ae,{showing:"",color:"primary"})]),"header-cell-enabled":l(n=>[t(se,{"auto-width":"",props:n},{default:l(()=>[t(v,{name:"power_settings_new",size:"1.5em"},{default:l(()=>[t(V,null,{default:l(()=>e[4]||(e[4]=[i("Enabled")])),_:1})]),_:1})]),_:2},1032,["props"])]),"header-cell-smsalert":l(n=>[t(se,{"auto-width":"",props:n},{default:l(()=>[t(v,{name:"phone_android",size:"1.5em"},{default:l(()=>[t(V,null,{default:l(()=>e[5]||(e[5]=[i("SMS Alert")])),_:1})]),_:1})]),_:2},1032,["props"])]),"header-cell-emailalert":l(n=>[t(se,{"auto-width":"",props:n},{default:l(()=>[t(v,{name:"email",size:"1.5em"},{default:l(()=>[t(V,null,{default:l(()=>e[6]||(e[6]=[i("Email Alert")])),_:1})]),_:1})]),_:2},1032,["props"])]),"header-cell-dashboardalert":l(n=>[t(se,{"auto-width":"",props:n},{default:l(()=>[t(v,{name:"notifications",size:"1.5em"},{default:l(()=>[t(V,null,{default:l(()=>e[7]||(e[7]=[i("Dashboard Alert")])),_:1})]),_:1})]),_:2},1032,["props"])]),"header-cell-policystatus":l(n=>[t(se,{"auto-width":"",props:n},null,8,["props"])]),"header-cell-collector":l(n=>[t(se,{"auto-width":"",props:n},{default:l(()=>[t(v,{name:"mdi-database-arrow-up",size:"1.5em"},{default:l(()=>[t(V,null,{default:l(()=>e[8]||(e[8]=[i("Collector Task")])),_:1})]),_:1})]),_:2},1032,["props"])]),"header-cell-status":l(n=>[t(se,{"auto-width":"",props:n},null,8,["props"])]),body:l(n=>[t(Ne,{props:n,class:"cursor-pointer",onDblclick:m=>a.showEditTask(n.row)},{default:l(()=>[t(be,{"context-menu":""},{default:l(()=>[t(te,{dense:"",style:{"min-width":"200px"}},{default:l(()=>[S((o(),r(p,{clickable:"",onClick:m=>a.runWinTask(n.row)},{default:l(()=>[t(f,{side:""},{default:l(()=>[t(v,{name:"play_arrow"})]),_:1}),t(f,null,{default:l(()=>e[9]||(e[9]=[i("Run task now")])),_:1})]),_:2},1032,["onClick"])),[[q]]),n.row.policy?h("",!0):S((o(),r(p,{key:0,clickable:"",onClick:m=>a.showEditTask(n.row)},{default:l(()=>[t(f,{side:""},{default:l(()=>[t(v,{name:"edit"})]),_:1}),t(f,null,{default:l(()=>e[10]||(e[10]=[i("Edit")])),_:1})]),_:2},1032,["onClick"])),[[q]]),n.row.policy?h("",!0):S((o(),r(p,{key:1,clickable:"",onClick:m=>a.deleteTask(n.row)},{default:l(()=>[t(f,{side:""},{default:l(()=>[t(v,{name:"delete"})]),_:1}),t(f,null,{default:l(()=>e[11]||(e[11]=[i("Delete")])),_:1})]),_:2},1032,["onClick"])),[[q]]),t(ce),S((o(),r(p,{clickable:""},{default:l(()=>[t(f,null,{default:l(()=>e[12]||(e[12]=[i("Close")])),_:1})]),_:1})),[[q]])]),_:2},1024)]),_:2},1024),t(z,null,{default:l(()=>[t(Y,{dense:"","onUpdate:modelValue":[m=>a.editTask(n.row,{enabled:!n.row.enabled}),m=>n.row.enabled=m],modelValue:n.row.enabled,disable:!!n.row.policy},null,8,["onUpdate:modelValue","modelValue","disable"])]),_:2},1024),t(z,null,{default:l(()=>[n.row.alert_template&&n.row.alert_template.always_text!==null?(o(),r(Y,{key:0,modelValue:n.row.alert_template.always_text,"onUpdate:modelValue":m=>n.row.alert_template.always_text=m,disable:"",dense:""},{default:l(()=>[t(V,null,{default:l(()=>[i(" Setting is overridden by alert template: "+b(n.row.alert_template.name),1)]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue"])):(o(),r(Y,{key:1,dense:"","onUpdate:modelValue":[m=>a.editTask(n.row,{text_alert:!n.row.text_alert}),m=>n.row.text_alert=m],modelValue:n.row.text_alert,disable:!!n.row.policy},null,8,["onUpdate:modelValue","modelValue","disable"]))]),_:2},1024),t(z,null,{default:l(()=>[n.row.alert_template&&n.row.alert_template.always_email!==null?(o(),r(Y,{key:0,modelValue:n.row.alert_template.always_email,"onUpdate:modelValue":m=>n.row.alert_template.always_email=m,disable:"",dense:""},{default:l(()=>[t(V,null,{default:l(()=>[i(" Setting is overridden by alert template: "+b(n.row.alert_template.name),1)]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue"])):(o(),r(Y,{key:1,dense:"","onUpdate:modelValue":[m=>a.editTask(n.row,{email_alert:!n.row.email_alert}),m=>n.row.email_alert=m],modelValue:n.row.email_alert,disable:!!n.row.policy},null,8,["onUpdate:modelValue","modelValue","disable"]))]),_:2},1024),t(z,null,{default:l(()=>[n.row.alert_template&&n.row.alert_template.always_alert!==null?(o(),r(Y,{key:0,modelValue:n.row.alert_template.always_alert,"onUpdate:modelValue":m=>n.row.alert_template.always_alert=m,disable:"",dense:""},{default:l(()=>[t(V,null,{default:l(()=>[i(" Setting is overridden by alert template: "+b(n.row.alert_template.name),1)]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue"])):(o(),r(Y,{key:1,dense:"","onUpdate:modelValue":[m=>a.editTask(n.row,{dashboard_alert:!n.row.dashboard_alert}),m=>n.row.dashboard_alert=m],modelValue:n.row.dashboard_alert,disable:!!n.row.policy},null,8,["onUpdate:modelValue","modelValue","disable"]))]),_:2},1024),t(z,null,{default:l(()=>[n.row.policy?(o(),r(v,{key:0,style:{"font-size":"1.3rem"},name:"policy"},{default:l(()=>[t(V,null,{default:l(()=>e[13]||(e[13]=[i("This task is managed by a policy")])),_:1})]),_:1})):h("",!0)]),_:2},1024),t(z,null,{default:l(()=>[n.row.custom_field?(o(),r(v,{key:0,style:{"font-size":"1.3rem"},name:"check"},{default:l(()=>[t(V,null,{default:l(()=>e[14]||(e[14]=[i("The task updates a custom field on the agent")])),_:1})]),_:1})):h("",!0)]),_:2},1024),Object.keys(n.row.task_result).length===0?(o(),r(z,{key:0})):n.row.task_result.status==="passing"?(o(),r(z,{key:1},{default:l(()=>[t(v,{style:{"font-size":"1.3rem"},color:a.dash_positive_color,name:"check_circle"},{default:l(()=>[t(V,null,{default:l(()=>e[15]||(e[15]=[i("Passing")])),_:1})]),_:1},8,["color"])]),_:1})):n.row.task_result.status==="failing"?(o(),r(z,{key:2},{default:l(()=>[n.row.alert_severity==="info"?(o(),r(v,{key:0,style:{"font-size":"1.3rem"},color:a.dash_info_color,name:"info"},{default:l(()=>[t(V,null,{default:l(()=>e[16]||(e[16]=[i("Informational")])),_:1})]),_:1},8,["color"])):n.row.alert_severity==="warning"?(o(),r(v,{key:1,style:{"font-size":"1.3rem"},color:a.dash_warning_color,name:"warning"},{default:l(()=>[t(V,null,{default:l(()=>e[17]||(e[17]=[i("Warning")])),_:1})]),_:1},8,["color"])):(o(),r(v,{key:2,style:{"font-size":"1.3rem"},color:a.dash_negative_color,name:"error"},{default:l(()=>[t(V,null,{default:l(()=>e[18]||(e[18]=[i("Error")])),_:1})]),_:1},8,["color"]))]),_:2},1024)):(o(),r(z,{key:3})),t(z,null,{default:l(()=>[i(b(n.row.name),1),n.row?.win_task_name?(o(),r(V,{key:0,delay:700},{default:l(()=>[i(b(n.row.win_task_name),1)]),_:2},1024)):h("",!0)]),_:2},1024),n.row.task_result.sync_status==="notsynced"?(o(),r(z,{key:4},{default:l(()=>e[19]||(e[19]=[i("Will sync on next agent checkin")])),_:1})):n.row.task_result.sync_status==="synced"?(o(),r(z,{key:5},{default:l(()=>e[20]||(e[20]=[i("Synced with agent")])),_:1})):n.row.task_result.sync_status==="pendingdeletion"?(o(),r(z,{key:6},{default:l(()=>e[21]||(e[21]=[i("Pending deletion on agent")])),_:1})):(o(),r(z,{key:7},{default:l(()=>e[22]||(e[22]=[i("Waiting for task creation on agent")])),_:1})),n.row.task_result.retcode!==null||n.row.task_result.stdout||n.row.task_result.stderr?(o(),r(z,{key:8},{default:l(()=>[g("span",{style:{cursor:"pointer","text-decoration":"underline"},class:"text-primary",onClick:m=>a.showScriptOutput(n.row)},"output",8,fn)]),_:2},1024)):(o(),r(z,{key:9},{default:l(()=>e[23]||(e[23]=[i("Awaiting output")])),_:1})),n.row.task_result.last_run?(o(),r(z,{key:10},{default:l(()=>[i(b(a.formatDate(n.row.task_result.last_run)),1)]),_:2},1024)):(o(),r(z,{key:11},{default:l(()=>e[24]||(e[24]=[i("Has not run yet")])),_:1})),t(z,null,{default:l(()=>[i(b(a.truncateText(n.row.schedule,70))+" ",1),n.row.schedule.length>70?(o(),r(V,{key:0},{default:l(()=>[i(b(n.row.schedule),1)]),_:2},1024)):h("",!0)]),_:2},1024),t(z,null,{default:l(()=>[n.row.check_name?(o(),w("span",gn,[i(b(a.truncateText(n.row.check_name,40))+" ",1),n.row.check_name.length>40?(o(),r(V,{key:0},{default:l(()=>[i(b(n.row.check_name),1)]),_:2},1024)):h("",!0)])):h("",!0)]),_:2},1024)]),_:2},1032,["props","onDblclick"])]),_:1},8,["table-class","style","rows","columns","pagination","loading"])])):(o(),w("div",cn," No agent selected "))}var bn=J(un,[["render",_n]]);const yn=[{name:"action",field:"action",align:"left"},{name:"installed",field:"installed",align:"left"},{name:"severity",label:"Severity",field:"severity",align:"left",sortable:!0},{name:"title",label:"Name",field:"title",align:"left",sortable:!0},{name:"description",label:"More Info",field:"description",align:"left",sortable:!0},{name:"date_installed",label:"Installed On",field:"date_installed",align:"left",sortable:!0}],hn={name:"WindowsUpdates",components:{ExportTableBtn:He},setup(){const s=ae(),e=C(()=>s.state.selectedRow),d=C(()=>s.state.tabHeight),a=C(()=>s.state.agentPlatform),u=C(()=>s.getters.formatDate),k=C(()=>s.state.dash_positive_color),c=C(()=>s.state.dash_negative_color),n=C(()=>s.state.dash_warning_color),m=ke(),_=je("refreshDashboard"),O=D([]),N=D(""),H=D({rowsPerPage:0,sortBy:"installed",descending:!1}),A=D(!1);async function Q(){A.value=!0,O.value=await Rl(e.value),A.value=!1}async function K(I,F){A.value=!0;try{const X=await Ml(I,{action:F});await Q(e.value),W(X),_()}catch(X){console.error(X)}A.value=!1}async function P(){A.value=!0;try{const I=await ut(e.value);W(I)}catch(I){console.error(I)}A.value=!1}async function T(){A.value=!0;try{const I=await ct(e.value);W(I)}catch(I){console.error(I)}A.value=!1}function B(I){const F=m.dark.isActive?"white":"";let X="";I.more_info_urls.forEach(x=>{X+=`<a style='color: ${F}' href='${x}' target='_blank'>${x}</a><br/>`});let ne=I.categories.join(", ");m.dialog({title:I.title,message:`<b>Categories:</b> ${ne}<br/><br/><b>Description</b><br/>`+I.description.split(". ").join(".<br />")+`<br/><br/><b>Support Urls</b><br/>${X}`,html:!0,fullWidth:!0})}return ge(e,I=>{I&&Q()}),he(()=>{e.value&&Q()}),{updates:O,filter:N,pagination:H,loading:A,selectedAgent:e,tabHeight:d,agentPlatform:a,dash_positive_color:k,dash_warning_color:n,dash_negative_color:c,columns:yn,getUpdates:Q,editWinUpdate:K,updateScan:P,installUpdates:T,showUpdateDetails:B,notifySuccess:W,truncateText:qe,formatDate:u}}},kn={key:0,class:"q-pa-sm p-3 font-semibold"},vn={key:1,class:"q-pa-sm"},wn={key:2},pn={style:{cursor:"pointer","text-decoration":"underline"},class:"text-primary"};function Cn(s,e,d,a,u,k){const c=E("export-table-btn");return a.selectedAgent?a.agentPlatform.toLowerCase()!=="windows"?(o(),w("div",vn," Only supported for Windows Devices ")):(o(),w("div",wn,[t(Ve,{dense:"","table-class":{"table-bgcolor":!s.$q.dark.isActive,"table-bgcolor-dark":s.$q.dark.isActive},class:"tabs-tbl-sticky",style:Ce({"max-height":a.tabHeight}),rows:a.updates,columns:a.columns,pagination:a.pagination,"onUpdate:pagination":e[1]||(e[1]=n=>a.pagination=n),filter:a.filter,"row-key":"id","binary-state-sort":"","virtual-scroll":"",loading:a.loading,"rows-per-page-options":[0],"no-data-label":"No Windows Updates"},{top:l(()=>[t(L,{dense:"",flat:"",push:"",onClick:a.getUpdates,icon:"refresh",class:"q-mr-sm"},null,8,["onClick"]),t(L,{label:"Run Update Scan",dense:"",flat:"",push:"","no-caps":"",onClick:a.updateScan,class:"q-mr-sm"},null,8,["onClick"]),t(L,{label:"Install Approved Updates",dense:"",flat:"",push:"","no-caps":"",onClick:a.installUpdates,class:"q-mr-sm"},null,8,["onClick"]),t(le),t(ie,{modelValue:a.filter,"onUpdate:modelValue":e[0]||(e[0]=n=>a.filter=n),outlined:"",label:"Search",dense:"",clearable:"",class:"q-pr-sm"},{prepend:l(()=>[t(v,{name:"search",color:"primary"})]),_:1},8,["modelValue"]),t(c,{data:a.updates,columns:a.columns},null,8,["data","columns"])]),loading:l(()=>[t(Ae,{showing:"",color:"primary"})]),body:l(n=>[t(Ne,{props:n},{default:l(()=>[t(be,{"context-menu":""},{default:l(()=>[t(te,{dense:"",style:{"min-width":"100px"}},{default:l(()=>[n.row.installed?h("",!0):S((o(),r(p,{key:0,clickable:"",onClick:m=>a.editWinUpdate(n.row.id,"inherit")},{default:l(()=>[t(f,null,{default:l(()=>e[2]||(e[2]=[i("Inherit")])),_:1})]),_:2},1032,["onClick"])),[[q]]),n.row.installed?h("",!0):S((o(),r(p,{key:1,clickable:"",onClick:m=>a.editWinUpdate(n.row.id,"approve")},{default:l(()=>[t(f,null,{default:l(()=>e[3]||(e[3]=[i("Approve")])),_:1})]),_:2},1032,["onClick"])),[[q]]),n.row.installed?h("",!0):S((o(),r(p,{key:2,clickable:"",onClick:m=>a.editWinUpdate(n.row.id,"ignore")},{default:l(()=>[t(f,null,{default:l(()=>e[4]||(e[4]=[i("Ignore")])),_:1})]),_:2},1032,["onClick"])),[[q]]),n.row.installed?h("",!0):S((o(),r(p,{key:3,clickable:"",onClick:m=>a.editWinUpdate(n.row.id,"nothing")},{default:l(()=>[t(f,null,{default:l(()=>e[5]||(e[5]=[i("Do Nothing")])),_:1})]),_:2},1032,["onClick"])),[[q]])]),_:2},1024)]),_:2},1024),t(z,null,{default:l(()=>[n.row.action==="nothing"?(o(),r(v,{key:0,name:"fiber_manual_record",color:"grey"},{default:l(()=>[t(V,null,{default:l(()=>e[6]||(e[6]=[i("Do Nothing")])),_:1})]),_:1})):n.row.action==="approve"?(o(),r(v,{key:1,name:"fas fa-check",color:"primary"},{default:l(()=>[t(V,null,{default:l(()=>e[7]||(e[7]=[i("Approve")])),_:1})]),_:1})):n.row.action==="ignore"?(o(),r(v,{key:2,name:"fas fa-check",color:a.dash_negative_color},{default:l(()=>[t(V,null,{default:l(()=>e[8]||(e[8]=[i("Ignore")])),_:1})]),_:1},8,["color"])):n.row.action==="inherit"?(o(),r(v,{key:3,name:"fiber_manual_record",color:"accent"},{default:l(()=>[t(V,null,{default:l(()=>e[9]||(e[9]=[i("Inherit")])),_:1})]),_:1})):h("",!0)]),_:2},1024),t(z,null,{default:l(()=>[n.row.installed?(o(),r(v,{key:0,name:"fas fa-check",color:a.dash_positive_color},{default:l(()=>[t(V,null,{default:l(()=>e[10]||(e[10]=[i("Installed")])),_:1})]),_:1},8,["color"])):n.row.action=="approve"?(o(),r(v,{key:1,name:"fas fa-tasks",color:"primary"},{default:l(()=>[t(V,null,{default:l(()=>e[11]||(e[11]=[i("Pending")])),_:1})]),_:1})):n.row.action=="ignore"?(o(),r(v,{key:2,name:"fas fa-ban",color:a.dash_negative_color},{default:l(()=>[t(V,null,{default:l(()=>e[12]||(e[12]=[i("Ignored")])),_:1})]),_:1},8,["color"])):(o(),r(v,{key:3,name:"fas fa-exclamation",color:a.dash_warning_color},{default:l(()=>[t(V,null,{default:l(()=>e[13]||(e[13]=[i("Missing")])),_:1})]),_:1},8,["color"]))]),_:2},1024),t(z,null,{default:l(()=>[i(b(n.row.severity?n.row.severity:"Other"),1)]),_:2},1024),t(z,null,{default:l(()=>[i(b(a.truncateText(n.row.title,50)),1)]),_:2},1024),t(z,{onClick:m=>a.showUpdateDetails(n.row)},{default:l(()=>[g("span",pn,b(a.truncateText(n.row.description,50)),1)]),_:2},1032,["onClick"]),t(z,null,{default:l(()=>[i(b(a.formatDate(n.row.date_installed)),1)]),_:2},1024)]),_:2},1032,["props"])]),_:1},8,["table-class","style","rows","columns","pagination","filter","loading"])])):(o(),w("div",kn," No agent selected "))}var xn=J(hn,[["render",Cn]]);const Fe="/software";async function Sn(s={}){try{const{data:e}=await we.get(`${Fe}/chocos/`,{params:s});return e}catch(e){console.error(e)}}async function Vn(s,e={}){try{const{data:d}=await we.get(`${Fe}/${s}/`,{params:e});return d.software}catch(d){console.error(d)}}async function An(s,e){const{data:d}=await we.post(`${Fe}/${s}/`,e);return d}async function Tn(s){try{const{data:e}=await we.put(`${Fe}/${s}/`);return e}catch(e){console.error(e)}}const Pn=[{name:"install",align:"left",label:"Install",sortable:!1},{name:"name",align:"left",label:"Name",field:"name",sortable:!0}],Un={name:"InstallSoftware",emits:[...re.emits],props:{agent_id:!String},setup(s){const{dialogRef:e,onDialogHide:d}=re(),a=ke(),u=D([]),k=D(""),c=D({rowsPerPage:0,sortBy:"name",descending:!1});async function n(){u.value=Object.freeze(await Sn())}function m(O){window.open(`https://chocolatey.org/packages/${O}`,"_blank")}function _(O){const N={name:O};a.dialog({title:`Install ${O}?`,persistent:!0,ok:{label:"Install"},cancel:!0}).onOk(async()=>{a.loading.show();try{const H=await An(s.agent_id,N);d(),W(H,5e3)}catch(H){console.error(H)}a.loading.hide()})}return he(n),{chocos:u,filter:k,pagination:c,columns:Pn,getChocos:n,showDescription:m,installSoftware:_,onDialogHide:d,dialogRef:e}}},qn={style:{cursor:"pointer","text-decoration":"underline"}};function zn(s,e,d,a,u,k){return o(),r(pe,{ref:"dialogRef",onHide:a.onDialogHide},{default:l(()=>[t(ye,{class:"q-dialog-plugin",style:{width:"40vw","max-width":"50vw"}},{default:l(()=>[t(xe,null,{default:l(()=>[e[3]||(e[3]=i(" Install Software ")),t(le),S((o(),r(L,{dense:"",flat:"",icon:"close"},{default:l(()=>[t(V,{class:"bg-white text-primary"},{default:l(()=>e[2]||(e[2]=[i("Close")])),_:1})]),_:1})),[[q]])]),_:1}),t(M,null,{default:l(()=>[t(Ve,{class:"remote-bg-tbl-sticky","table-class":{"table-bgcolor":!s.$q.dark.isActive,"table-bgcolor-dark":s.$q.dark.isActive},dense:"",rows:a.chocos,columns:a.columns,pagination:a.pagination,"onUpdate:pagination":e[1]||(e[1]=c=>a.pagination=c),filter:a.filter,"binary-state-sort":"","hide-bottom":"","virtual-scroll":"","rows-per-page-options":[0],"row-key":"name"},{"top-left":l(()=>[t(ie,{modelValue:a.filter,"onUpdate:modelValue":e[0]||(e[0]=c=>a.filter=c),outlined:"",label:"Search",dense:"",clearable:""},{prepend:l(()=>[t(v,{name:"search"})]),_:1},8,["modelValue"])]),body:l(c=>[t(Ne,{props:c},{default:l(()=>[t(z,{"auto-width":""},{default:l(()=>[t(L,{dense:"",flat:"",push:"",icon:"add",onClick:n=>a.installSoftware(c.row.name)},null,8,["onClick"])]),_:2},1024),t(z,{onClick:n=>a.showDescription(c.row.name)},{default:l(()=>[g("span",qn,b(c.row.name),1)]),_:2},1032,["onClick"])]),_:2},1032,["props"])]),_:1},8,["table-class","rows","columns","pagination","filter"])]),_:1})]),_:1})]),_:1},8,["onHide"])}var Dn=J(Un,[["render",zn]]);const Rn=[{name:"name",align:"left",label:"Name",field:"name",sortable:!0},{name:"publisher",align:"left",label:"Publisher",field:"publisher",sortable:!0},{name:"install_date",align:"left",label:"Installed On",field:"install_date",sortable:!1,format:s=>s==="01/01/1"||s==="01-1-01"?"":s},{name:"size",align:"left",label:"Size",field:"size",sortable:!1},{name:"version",align:"left",label:"Version",field:"version",sortable:!1}],Mn={name:"SoftwareTab",components:{ExportTableBtn:He},setup(){const s=ke(),e=ae(),d=C(()=>e.state.selectedRow),a=C(()=>e.state.tabHeight),u=C(()=>e.state.agentPlatform),k=D([]),c=D(!1),n=D(""),m=D({rowsPerPage:0,sortBy:"name",descending:!1});async function _(){c.value=!0,k.value=await Vn(d.value),c.value=!1}async function O(){c.value=!0,await Tn(d.value),await _(),c.value=!1}function N(){s.dialog({component:Dn,componentProps:{agent_id:d.value}})}return ge(d,H=>{H&&_()}),he(()=>{d.value&&_()}),{software:k,loading:c,filter:n,pagination:m,selectedAgent:d,tabHeight:a,agentPlatform:u,columns:Rn,refreshSoftware:O,showInstallSoftwareModal:N}}},On={key:0,class:"q-pa-sm p-3 font-semibold"},Nn={key:1,class:"q-pa-sm"},Hn={key:2};function In(s,e,d,a,u,k){const c=E("export-table-btn");return a.selectedAgent?a.agentPlatform.toLowerCase()!=="windows"?(o(),w("div",Nn," Only supported for Windows Devices ")):(o(),w("div",Hn,[t(Ve,{"table-class":{"table-bgcolor":!s.$q.dark.isActive,"table-bgcolor-dark":s.$q.dark.isActive},class:"tabs-tbl-sticky",dense:"",rows:a.software,columns:a.columns,filter:a.filter,style:Ce({"max-height":a.tabHeight}),pagination:a.pagination,"onUpdate:pagination":e[1]||(e[1]=n=>a.pagination=n),"binary-state-sort":"","row-key":"id","virtual-scroll":"","rows-per-page-options":[0],loading:a.loading},{loading:l(()=>[t(Ae,{showing:"",color:"primary"})]),top:l(()=>[t(L,{class:"q-mr-sm",dense:"",flat:"",push:"",onClick:a.refreshSoftware,icon:"refresh"},null,8,["onClick"]),t(L,{icon:"add",label:"Install Software","no-caps":"",dense:"",flat:"",push:"",onClick:a.showInstallSoftwareModal},null,8,["onClick"]),t(le),t(ie,{modelValue:a.filter,"onUpdate:modelValue":e[0]||(e[0]=n=>a.filter=n),outlined:"",label:"Search",dense:"",clearable:"",class:"q-pr-sm"},{prepend:l(()=>[t(v,{name:"search",color:"primary"})]),_:1},8,["modelValue"]),t(c,{data:a.software,columns:a.columns},null,8,["data","columns"])]),_:1},8,["table-class","rows","columns","filter","style","pagination","loading"])])):(o(),w("div",On," No agent selected "))}var Fn=J(Mn,[["render",In]]);const Qn=[{name:"time",label:"Time",field:"time",align:"left",sortable:!0},{name:"type",label:"Action",field:"type",align:"left",sortable:!0,format:s=>Vt(s)},{name:"command",label:"Script/Command",field:s=>s.type==="script_run"?s.script_name:s.command,align:"left",sortable:!0,format:s=>qe(s,30)},{name:"username",label:"Initiated By",field:"username",align:"left",sortable:!0},{name:"output",label:"Output",field:"output",align:"left",sortable:!0}],En={name:"HistoryTab",components:{ExportTableBtn:He,Icon:Pe},setup(){const s=ke(),e=ae(),d=C(()=>e.state.selectedRow),a=C(()=>e.state.tabHeight),u=C(()=>e.getters.formatDate),k=D([]),c=D(!1),n=D("");async function m(){c.value=!0,k.value=await Zt(d.value),c.value=!1}ge(d,N=>{N&&m()});function _(N){if(!N){At.create({message:"No output is available yet",type:"negative"});return}s.dialog({component:Ge,componentProps:{scriptInfo:N}})}function O(N,H){s.dialog({title:N,style:"width: 70vw; max-width: 80vw",message:`<pre>${H}</pre>`,html:!0})}return he(()=>{d.value&&m()}),{history:k,loading:c,tabHeight:a,filter:n,columns:Qn,formatDate:u,showScriptOutput:_,showCommandOutput:O,getHistory:m,truncateText:qe,selectedAgent:d}}},Ln={key:0,class:"q-pa-sm p-3 font-semibold"},Wn={key:1},jn={class:"search-container"},Bn=["onClick"];function Gn(s,e,d,a,u,k){const c=E("Icon"),n=E("export-table-btn");return a.selectedAgent?(o(),w("div",Wn,[t(Ve,{"table-class":{"table-bgcolor":!s.$q.dark.isActive,"table-bgcolor-dark":s.$q.dark.isActive},rows:a.history,columns:a.columns,pagination:{sortBy:"time",descending:!0,rowsPerPage:0},style:Ce({"max-height":a.tabHeight}),loading:a.loading,"rows-per-page-options":[0],filter:a.filter,"virtual-scroll":"",dense:"","binary-state-sort":""},{top:l(()=>[g("button",{class:"btn btn-none-primary mr-2",onClick:e[0]||(e[0]=(...m)=>a.getHistory&&a.getHistory(...m))},[t(c,{icon:"lucide:rotate-cw",width:"20",height:"20",class:"icon mr-2"})]),t(le),g("div",jn,[t(c,{icon:"lucide:search",width:"20",height:"20",class:"search-icon"}),S(g("input",{class:"form-control search-form","onUpdate:modelValue":e[1]||(e[1]=m=>s.search=m),outlined:"",label:"Search",dense:"",clearable:"",style:{"padding-left":"35px","padding-right":"90px",width:"100%",height:"36px",border:"1px solid #ccc","border-radius":"4px"}},null,512),[[St,s.search]])]),t(n,{data:a.history,columns:a.columns},null,8,["data","columns"])]),loading:l(()=>[t(Ae,{showing:"",color:"primary"})]),"body-cell-output":l(m=>[t(z,{props:m},{default:l(()=>[g("span",{style:{cursor:"pointer","text-decoration":"underline"},class:"text-primary",onClick:_=>m.row.type==="cmd_run"?a.showCommandOutput(m.row.command,m.row.results):a.showScriptOutput(m.row.script_results)},"Output ",8,Bn)]),_:2},1032,["props"])]),"body-cell-time":l(m=>[t(z,{props:m},{default:l(()=>[i(b(a.formatDate(m.row.time)),1)]),_:2},1032,["props"])]),_:1},8,["table-class","rows","columns","style","loading","filter"])])):(o(),w("div",Ln," No agent selected "))}var Kn=J(En,[["render",Gn]]);const Xn={name:"AuditTab",components:{AuditManager:Pl},setup(){const s=ae(),e=C(()=>s.state.selectedRow),d=C(()=>s.state.tabHeight);return{selectedAgent:e,tabHeight:d}}},Yn={key:0,class:"q-pa-sm p-3 font-semibold"},Jn={key:1};function Zn(s,e,d,a,u,k){const c=E("AuditManager");return a.selectedAgent?(o(),w("div",Jn,[t(c,{agent:a.selectedAgent,tabHeight:a.tabHeight},null,8,["agent","tabHeight"])])):(o(),w("div",Yn," No agent selected "))}var $n=J(Xn,[["render",Zn]]);const eo={name:"DebugTab",components:{DebugLog:Ul},setup(){const s=ae(),e=C(()=>s.state.selectedRow),d=C(()=>s.state.tabHeight);return{selectedAgent:e,tabHeight:d}}},to={key:0,class:"q-pa-sm p-3 font-semibold"},lo={key:1};function ao(s,e,d,a,u,k){const c=E("DebugLog");return a.selectedAgent?(o(),w("div",lo,[t(c,{agent:a.selectedAgent,tabHeight:a.tabHeight},null,8,["agent","tabHeight"])])):(o(),w("div",to," No agent selected "))}var no=J(eo,[["render",ao]]);const oo={name:"WmiDetail",props:{info:!Object},setup(){const s=ae(),e=C(()=>s.state.tabHeight);function d(a){ol(a).then(()=>{W("Copied to clipboard")})}return{tabHeight:e,uid:Tt,copyValueToClip:d}}},so={class:"text-overline"};function io(s,e,d,a,u,k){return o(),w("div",{class:"scroll",style:Ce({"max-height":a.tabHeight-10})},[(o(!0),w(ue,null,de(d.info,c=>(o(),w("div",{key:c+a.uid()},[(o(!0),w(ue,null,de(c,n=>(o(),w("div",{key:n+a.uid()},[(o(!0),w(ue,null,de(n,(m,_)=>(o(),w("div",{key:m+a.uid()},[g("span",so,b(_)+":",1),t(lt,{color:"primary",class:"q-ml-sm text-caption"},{default:l(()=>[i(b(m),1)]),_:2},1024),m?(o(),r(L,{key:0,size:"sm",class:"q-ml-xs",flat:"",round:"",icon:"content_copy",onClick:O=>a.copyValueToClip(m)},{default:l(()=>[t(V,null,{default:l(()=>e[0]||(e[0]=[i("Copy to Clipboard")])),_:1})]),_:2},1032,["onClick"])):h("",!0)]))),128))]))),128)),d.info.length>1?(o(),r(ce,{key:0})):h("",!0)]))),128))],4)}var ro=J(oo,[["render",io]]);const uo={name:"AssetsTab",components:{WmiDetail:ro},setup(){const s=ae(),e=C(()=>s.state.selectedRow),d=C(()=>s.state.agentPlatform),a=D(!1),u=D({}),k=D("os");async function c(){a.value=!0;const{wmi_detail:n}=await Le(e.value);u.value=n,a.value=!1}return ge(e,n=>{n&&c()}),he(()=>{e.value&&c()}),{assets:u,tab:k,selectedAgent:e,agentPlatform:d}}},co={key:0,class:"q-pa-sm p-3 font-semibold"},mo={key:1,class:"q-pa-sm"},fo={key:2};function go(s,e,d,a,u,k){const c=E("WmiDetail");return a.selectedAgent?a.agentPlatform.toLowerCase()!=="windows"?(o(),w("div",mo," Only supported for Windows Devices ")):(o(),w("div",fo,[t($e,{modelValue:a.tab,"onUpdate:modelValue":e[0]||(e[0]=n=>a.tab=n),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":"","no-caps":""},{default:l(()=>[t($,{name:"os",label:"Operating System"}),t($,{name:"cpu",label:"CPU"}),t($,{name:"mem",label:"Memory"}),t($,{name:"usb",label:"USB"}),t($,{name:"bios",label:"Bios"}),t($,{name:"disk",label:"Disks"}),t($,{name:"comp_sys",label:"Computer System"}),t($,{name:"base_board",label:"Motherboard"}),t($,{name:"comp_sys_prod",label:"Computer System Product"}),t($,{name:"network_config",label:"Network Config"}),t($,{name:"graphics",label:"Graphics"}),t($,{name:"desktop_monitor",label:"Monitors"}),t($,{name:"network_adapter",label:"Network Adapters"})]),_:1},8,["modelValue"]),t(ce),t(Be,{modelValue:a.tab,"onUpdate:modelValue":e[1]||(e[1]=n=>a.tab=n)},{default:l(()=>[t(j,{name:"os"},{default:l(()=>[t(c,{info:a.assets.os},null,8,["info"])]),_:1}),t(j,{name:"cpu"},{default:l(()=>[t(c,{info:a.assets.cpu},null,8,["info"])]),_:1}),t(j,{name:"mem"},{default:l(()=>[t(c,{info:a.assets.mem},null,8,["info"])]),_:1}),t(j,{name:"usb"},{default:l(()=>[t(c,{info:a.assets.usb},null,8,["info"])]),_:1}),t(j,{name:"bios"},{default:l(()=>[t(c,{info:a.assets.bios},null,8,["info"])]),_:1}),t(j,{name:"disk"},{default:l(()=>[t(c,{info:a.assets.disk},null,8,["info"])]),_:1}),t(j,{name:"comp_sys"},{default:l(()=>[t(c,{info:a.assets.comp_sys},null,8,["info"])]),_:1}),t(j,{name:"base_board"},{default:l(()=>[t(c,{info:a.assets.base_board},null,8,["info"])]),_:1}),t(j,{name:"comp_sys_prod"},{default:l(()=>[t(c,{info:a.assets.comp_sys_prod},null,8,["info"])]),_:1}),t(j,{name:"network_config"},{default:l(()=>[t(c,{info:a.assets.network_config},null,8,["info"])]),_:1}),t(j,{name:"desktop_monitor"},{default:l(()=>[t(c,{info:a.assets.desktop_monitor},null,8,["info"])]),_:1}),t(j,{name:"graphics"},{default:l(()=>[t(c,{info:a.assets.graphics},null,8,["info"])]),_:1}),t(j,{name:"network_adapter"},{default:l(()=>[t(c,{info:a.assets.network_adapter},null,8,["info"])]),_:1})]),_:1},8,["modelValue"])])):(o(),w("div",co," No agent selected "))}var _o=J(uo,[["render",go]]);const bo=[{name:"entry_time",label:"Date",field:"entry_time"},{name:"username",label:"User",field:"username"},{name:"note",label:"Note",field:"note"}],yo={name:"NotesTab",components:{ExportTableBtn:He,Icon:Pe},setup(){const s=ae(),e=C(()=>s.state.selectedRow),d=C(()=>s.state.tabHeight),a=C(()=>s.getters.formatDate),u=ke(),k=D(""),c=D([]),n=D(!1),m=D({rowsPerPage:0,sortBy:"id",descending:!1});async function _(){n.value=!0,c.value=await $t(e.value),n.value=!1}function O(){k.value="",u.dialog({title:"Add Note",prompt:{model:k,type:"textarea",isValid:A=>!!A},style:"width: 90vw; max-width: 90vw",ok:{label:"Add"},cancel:!0}).onOk(async()=>{n.value=!0;try{const A=await el({agent_id:e.value,note:k.value});W(A),await _()}catch(A){console.error(A)}n.value=!1})}function N(A){u.dialog({title:"Edit Note",prompt:{model:A.note,type:"textarea",isValid:Q=>!!Q},style:"width: 90vw; max-width: 90vw",ok:{label:"Save"},cancel:!0}).onOk(async Q=>{n.value=!0;try{const K=await tl(A.pk,{note:Q});W(K),await _()}catch(K){console.error(K)}n.value=!1})}function H(A){u.dialog({title:"Delete note?",cancel:!0,ok:{label:"Delete",color:"negative"}}).onOk(async()=>{n.value=!0;try{const Q=await ll(A.pk);W(Q),await _()}catch(Q){console.error(Q)}n.value=!1})}return ge(e,A=>{A&&_()}),he(()=>{e.value&&_()}),{notes:c,loading:n,pagination:m,selectedAgent:e,tabHeight:d,noteText:k,columns:bo,formatDate:a,getNotes:_,addNote:O,editNote:N,deleteNote:H}}},ho={key:0,class:"q-pa-sm p-3 font-semibold"},ko={key:1},vo={class:"row"},wo={class:"col"},po={class:"text-subtitle2"},Co={class:"text-caption"},xo={class:"col-auto"};function So(s,e,d,a,u,k){const c=E("Icon"),n=E("export-table-btn");return a.selectedAgent?(o(),w("div",ko,[t(Ve,{grid:"",class:"tabs-tbl-sticky",style:Ce({"max-height":a.tabHeight}),rows:a.notes,columns:a.columns,pagination:a.pagination,"onUpdate:pagination":e[2]||(e[2]=m=>a.pagination=m),"row-key":"id","rows-per-page-options":[0],loading:a.loading,"hide-bottom":"","virtual-scroll":"","no-data-label":"No notes"},{top:l(()=>[g("button",{class:"btn btn-none-primary ac",onClick:e[0]||(e[0]=(...m)=>a.getNotes&&a.getNotes(...m))},[t(c,{icon:"lucide:rotate-cw",width:"20",height:"20",class:"icon"})]),g("button",{class:"btn btn-primary ac",onClick:e[1]||(e[1]=(...m)=>a.addNote&&a.addNote(...m))},[t(c,{icon:"lucide:plus",width:"20",height:"20",class:"icon mr-2"}),e[3]||(e[3]=i(" Add Note "))]),t(le),t(n,{data:a.notes,columns:a.columns},null,8,["data","columns"])]),loading:l(()=>[t(Ae,{showing:"",color:"primary"})]),item:l(m=>[t(ye,{class:"notes-card q-pa-none q-ma-xs",bordered:""},{default:l(()=>[t(M,null,{default:l(()=>[g("div",vo,[g("div",wo,[g("div",po,b(a.formatDate(m.row.entry_time)),1),g("div",Co,b(m.row.username),1)]),g("div",xo,[t(L,{color:"grey-7",round:"",flat:"",icon:"more_vert"},{default:l(()=>[t(be,{cover:"","auto-close":""},{default:l(()=>[t(te,{dense:""},{default:l(()=>[S((o(),r(p,{clickable:"",onClick:_=>a.editNote(m.row)},{default:l(()=>[t(f,{side:""},{default:l(()=>[t(v,{name:"edit"})]),_:1}),t(f,null,{default:l(()=>e[4]||(e[4]=[i("Edit")])),_:1})]),_:2},1032,["onClick"])),[[q]]),S((o(),r(p,{clickable:"",onClick:_=>a.deleteNote(m.row)},{default:l(()=>[t(f,{side:""},{default:l(()=>[t(v,{name:"delete"})]),_:1}),t(f,null,{default:l(()=>e[5]||(e[5]=[i("Delete")])),_:1})]),_:2},1032,["onClick"])),[[q]])]),_:2},1024)]),_:2},1024)]),_:2},1024)])])]),_:2},1024),t(M,{style:{"max-height":"20vh"},class:"scroll"},{default:l(()=>[g("pre",null,b(m.row.note),1)]),_:2},1024)]),_:2},1024)]),_:1},8,["style","rows","columns","pagination","loading"])])):(o(),w("div",ho," No agent selected "))}var Vo=J(yo,[["render",So],["__scopeId","data-v-5db5484a"]]);const Ao={name:"SubTableTabs",components:{SummaryTab:ja,ChecksTab:rn,AutomatedTasksTab:bn,WinUpdateTab:xn,SoftwareTab:Fn,HistoryTab:Kn,AuditTab:$n,DebugTab:no,AssetsTab:_o,NotesTab:Vo,Icon:Pe},props:{activeTabs:{type:Array,default:()=>["summary","checks","tasks","patches","software","history","notes","assets","debug","audit"]}},setup(s){return{subtab:D(s.activeTabs[0])}}},To={class:"sidebar-nav"};function Po(s,e,d,a,u,k){const c=E("Icon"),n=E("SummaryTab"),m=E("ChecksTab"),_=E("AutomatedTasksTab"),O=E("WinUpdateTab"),N=E("SoftwareTab"),H=E("HistoryTab"),A=E("NotesTab"),Q=E("AssetsTab"),K=E("DebugTab"),P=E("AuditTab");return o(),r(zt,{class:"tabs-container",container:"",view:"hHh lpr lfr"},{default:l(()=>[t(Pt,{class:"bg-transparent"},{default:l(()=>[g("div",To,[d.activeTabs.includes("summary")?(o(),w("div",{key:0,class:fe(["nav-item",{active:a.subtab==="summary"}]),onClick:e[0]||(e[0]=T=>a.subtab="summary")},[t(c,{icon:"lucide:house",width:"24",height:"24",class:"icon"}),e[11]||(e[11]=g("span",{class:"label"},"Home",-1))],2)):h("",!0),d.activeTabs.includes("checks")?(o(),w("div",{key:1,class:fe(["nav-item",{active:a.subtab==="checks"}]),onClick:e[1]||(e[1]=T=>a.subtab="checks")},[t(c,{width:"24",height:"24",icon:"lucide:check-check",class:"icon"}),e[12]||(e[12]=g("span",{class:"label"},"Checks",-1))],2)):h("",!0),d.activeTabs.includes("tasks")?(o(),w("div",{key:2,class:fe(["nav-item",{active:a.subtab==="tasks"}]),onClick:e[2]||(e[2]=T=>a.subtab="tasks")},[t(c,{icon:"lucide:logs",width:"24",height:"24",class:"icon"}),e[13]||(e[13]=g("span",{class:"label"},"Tasks",-1))],2)):h("",!0),d.activeTabs.includes("patches")?(o(),w("div",{key:3,class:fe(["nav-item",{active:a.subtab==="patches"}]),onClick:e[3]||(e[3]=T=>a.subtab="patches")},[t(c,{icon:"lucide:monitor-up",width:"24",height:"24",class:"icon"}),e[14]||(e[14]=g("span",{class:"label"},"Updates",-1))],2)):h("",!0),d.activeTabs.includes("software")?(o(),w("div",{key:4,class:fe(["nav-item",{active:a.subtab==="software"}]),onClick:e[4]||(e[4]=T=>a.subtab="software")},[t(c,{icon:"lucide:folder-code",width:"24",height:"24",class:"icon"}),e[15]||(e[15]=g("span",{class:"label"},"Software",-1))],2)):h("",!0),d.activeTabs.includes("history")?(o(),w("div",{key:5,class:fe(["nav-item",{active:a.subtab==="history"}]),onClick:e[5]||(e[5]=T=>a.subtab="history")},e[16]||(e[16]=[g("i",{class:"material-icons icon"},"history",-1),g("span",{class:"label"},"History",-1)]),2)):h("",!0),d.activeTabs.includes("notes")?(o(),w("div",{key:6,class:fe(["nav-item",{active:a.subtab==="notes"}]),onClick:e[6]||(e[6]=T=>a.subtab="notes")},e[17]||(e[17]=[g("i",{class:"far fa-sticky-note icon"},null,-1),g("span",{class:"label"},"Notes",-1)]),2)):h("",!0),d.activeTabs.includes("assets")?(o(),w("div",{key:7,class:fe(["nav-item",{active:a.subtab==="assets"}]),onClick:e[7]||(e[7]=T=>a.subtab="assets")},e[18]||(e[18]=[g("i",{class:"fas fa-barcode icon"},null,-1),g("span",{class:"label"},"Assets",-1)]),2)):h("",!0),d.activeTabs.includes("debug")?(o(),w("div",{key:8,class:fe(["nav-item",{active:a.subtab==="debug"}]),onClick:e[8]||(e[8]=T=>a.subtab="debug")},e[19]||(e[19]=[g("i",{class:"material-icons icon"},"bug_report",-1),g("span",{class:"label"},"Debug",-1)]),2)):h("",!0),d.activeTabs.includes("audit")?(o(),w("div",{key:9,class:fe(["nav-item",{active:a.subtab==="audit"}]),onClick:e[9]||(e[9]=T=>a.subtab="audit")},[t(c,{icon:"lucide:file",width:"24",height:"24",class:"icon"}),e[20]||(e[20]=g("span",{class:"label"},"Audits",-1))],2)):h("",!0)]),t(ce)]),_:1}),t(qt,null,{default:l(()=>[t(Be,{modelValue:a.subtab,"onUpdate:modelValue":e[10]||(e[10]=T=>a.subtab=T),animated:!1},{default:l(()=>[d.activeTabs.includes("summary")?(o(),r(j,{key:0,name:"summary",class:"q-pa-none"},{default:l(()=>[t(n)]),_:1})):h("",!0),d.activeTabs.includes("checks")?(o(),r(j,{key:1,name:"checks",class:"q-pa-none"},{default:l(()=>[t(m)]),_:1})):h("",!0),d.activeTabs.includes("tasks")?(o(),r(j,{key:2,name:"tasks",class:"q-pa-none"},{default:l(()=>[t(_)]),_:1})):h("",!0),d.activeTabs.includes("patches")?(o(),r(j,{key:3,name:"patches",class:"q-pa-none"},{default:l(()=>[t(O)]),_:1})):h("",!0),d.activeTabs.includes("software")?(o(),r(j,{key:4,name:"software",class:"q-pa-none"},{default:l(()=>[t(N)]),_:1})):h("",!0),d.activeTabs.includes("history")?(o(),r(j,{key:5,name:"history",class:"q-pa-none"},{default:l(()=>[t(H)]),_:1})):h("",!0),d.activeTabs.includes("notes")?(o(),r(j,{key:6,name:"notes",class:"q-pa-none"},{default:l(()=>[t(A)]),_:1})):h("",!0),d.activeTabs.includes("assets")?(o(),r(j,{key:7,name:"assets",class:"q-pa-none"},{default:l(()=>[t(Q)]),_:1})):h("",!0),d.activeTabs.includes("debug")?(o(),r(j,{key:8,name:"debug",class:"q-pa-none"},{default:l(()=>[t(K)]),_:1})):h("",!0),d.activeTabs.includes("audit")?(o(),r(j,{key:9,name:"audit",class:"q-pa-none"},{default:l(()=>[t(P)]),_:1})):h("",!0)]),_:1},8,["modelValue"])]),_:1})]),_:1})}var jo=J(Ao,[["render",Po]]);export{ma as A,$l as E,El as P,ja as S,da as _,jo as a};
