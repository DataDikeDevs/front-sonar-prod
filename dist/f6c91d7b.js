import{d as ae,r as C,w as re,_ as D,b as J,e as S,o as d,f,g as l,h as t,i,j as A,Q as x,k as H,l as Y,m as _,n as v,p as u,q as z,t as q,s as E,v as L,x as $,y as de,z as ue,A as G,F as ce,B as fe,C as me,D as pe,E as he,G as Q,H as I,I as ge,J as B,K as _e,L as W,u as ve,a as be,M as we,O as ke,R as P}from"./5ab24b2e.js";import{Q as Ce,a as ye,E as Ae}from"./a3499d7e.js";import{Q as y,a as b,b as U}from"./ecaf8470.js";import{Q as F,C as V}from"./cf5c9d2e.js";import{Q as T,a as k,b as X}from"./f74f6403.js";import{S as Ve,Q as ee,l as Se,r as xe,a as ze}from"./1914f3e5.js";import{Q as Re}from"./0f1df4e8.js";import{Q as qe,a as Te}from"./e97ed4ea.js";import{u as Ue}from"./996a7403.js";import{u as $e}from"./59ac3451.js";import{Q as te,o as De,a as Oe,n as oe}from"./2f13d940.js";import{I as le}from"./3d55f282.js";import{m as j}from"./6f88213c.js";import{Q as Qe,a as Z,u as K}from"./f0e6a650.js";import{O as se}from"./bf0c4274.js";import{Q as Me}from"./b10e6aed.js";import"./b24520dc.js";import"./1f4fe988.js";const Ie=ae("dashboard",()=>{const o=C(0),e=C(0),a=C(0),m=C(0),n=C(180),{data:r}=$e();return re(r,s=>{console.log("[WS] Nova mensagem recebida:",s);const p=s.data;o.value=p.total_server_count,e.value=p.total_server_offline_count,a.value=p.total_workstation_count,m.value=p.total_workstation_offline_count,n.value=p.days_until_cert_expires,console.log("[WS] Valores atualizados:"),console.log("  Servidores online:",o.value),console.log("  Servidores offline:",e.value),console.log("  Workstations online:",a.value),console.log("  Workstations offline:",m.value),console.log("  Dias at\xE9 expira\xE7\xE3o do cert:",n.value)}),{serverCount:o,serverOfflineCount:e,workstationCount:a,workstationOfflineCount:m,daysUntilCertExpires:n}}),Fe={name:"AlertsOverview",emits:["hide"],mixins:[j],setup(){const o=J();return{formatDate:S(()=>o.getters.formatDate)}},data(){return{alerts:[],selectedAlerts:[],severityFilter:[],clientFilter:[],timeFilter:30,includeResolved:!1,includeSnoozed:!1,searched:!1,clientsOptions:[],severityOptions:[{label:"Informational",value:"info"},{label:"Warning",value:"warning"},{label:"Error",value:"error"}],timeOptions:[{value:1,label:"1 Day Ago"},{value:7,label:"1 Week Ago"},{value:30,label:"30 Days Ago"},{value:90,label:"3 Months Ago"},{value:180,label:"6 Months Ago"},{value:365,label:"1 Year Ago"},{value:0,label:"Everything"}],columns:[{name:"alert_time",label:"Time",field:"alert_time",align:"left",sortable:!0,format:o=>this.formatDate(o)},{name:"client",label:"Client",field:"client",align:"left",sortable:!0},{name:"site",label:"Site",field:"site",align:"left",sortable:!0},{name:"hostname",label:"Agent",field:"hostname",align:"left",sortable:!0},{name:"alert_type",label:"Type",field:"alert_type",align:"left",sortable:!0,format:o=>this.capitalize(o,!0)},{name:"severity",label:"Severity",field:"severity",align:"left",sortable:!0},{name:"message",label:"Message",field:"message",align:"left",sortable:!0},{name:"resolved_on",label:"Resolved On",field:"resolved_on",align:"left",sortable:!0,format:o=>this.formatDate(o)},{name:"snoozed_until",label:"Snoozed Until",field:"snoozed_until",align:"left",sortable:!0,format:o=>this.formatDate(o)},{name:"actions",label:"Actions",align:"left"}],pagination:{rowsPerPage:50,sortBy:"alert_time",descending:!0}}},computed:{noDataText(){return this.searched?"No data found. Try to refine you search":"Click search to find alerts"},visibleColumns(){return this.columns.map(o=>{if(o.name==="snoozed_until"){if(this.includeSnoozed)return o.name}else if(o.name==="resolved_on"){if(this.includeResolved)return o.name}else return o.name})}},methods:{getClients(){this.$axios.get("/clients/").then(o=>{this.clientsOptions=Object.freeze(o.data.map(e=>({label:e.name,value:e.id})))})},search(){this.$q.loading.show(),this.selectedAlerts=[],this.searched=!0;let o={snoozedFilter:this.includeSnoozed,resolvedFilter:this.includeResolved};this.clientFilter.length>0&&(o.clientFilter=this.clientFilter),this.timeFilter&&(o.timeFilter=this.timeFilter),this.severityFilter.length>0&&(o.severityFilter=this.severityFilter),this.$axios.patch("/alerts/",o).then(e=>{this.$q.loading.hide(),this.alerts=Object.freeze(e.data)}).catch(()=>{this.$q.loading.hide()})},snoozeAlert(o){this.$q.dialog({title:"Snooze Alert",message:"How many days to snooze alert?",prompt:{model:"",type:"number",isValid:e=>!!e&&e>0&&e<9999},cancel:!0}).onOk(e=>{this.$q.loading.show();const a={id:o.id,type:"snooze",snooze_days:e};this.$axios.put(`alerts/${o.id}/`,a).then(()=>{this.search(),this.$q.loading.hide(),this.notifySuccess(`The alert has been snoozed for ${e} days`)}).catch(()=>{this.$q.loading.hide()})})},unsnoozeAlert(o){this.$q.loading.show();const e={id:o.id,type:"unsnooze"};this.$axios.put(`alerts/${o.id}/`,e).then(()=>{this.search(),this.$q.loading.hide(),this.notifySuccess("The alert has been unsnoozed")}).catch(()=>{this.$q.loading.hide()})},resolveAlert(o){this.$q.loading.show();const e={id:o.id,type:"resolve"};this.$axios.put(`alerts/${o.id}/`,e).then(()=>{this.search(),this.$q.loading.hide(),this.notifySuccess("The alert has been resolved")}).catch(()=>{this.$q.loading.hide()})},resolveAlertBulk(o){this.$q.loading.show();const e={alerts:o.map(a=>a.id),bulk_action:"resolve"};this.$axios.post("alerts/bulk/",e).then(()=>{this.search(),this.$q.loading.hide(),this.notifySuccess("Alerts were resolved")}).catch(()=>{this.$q.loading.hide()})},snoozeAlertBulk(o){this.$q.dialog({title:"Snooze Alert",message:"How many days to snooze alert?",prompt:{model:"",type:"number",isValid:e=>!!e&&e>0&&e<9999},cancel:!0}).onOk(e=>{this.$q.loading.show();const a={alerts:o.map(m=>m.id),bulk_action:"snooze",snooze_days:e};this.$axios.post("alerts/bulk/",a).then(()=>{this.search(),this.$q.loading.hide(),this.notifySuccess(`Alerts were snoozed for ${e} days`)}).catch(()=>{this.$q.loading.hide()})})},showScriptOutput(o,e=!1){let a={};e?(a.readable_desc=`${o.alert_type} failure action results`,a.execution_time=o.action_execution_time,a.retcode=o.action_retcode,a.stdout=o.action_stdout,a.errout=o.action_errout,a.last_run=o.action_run):(a.readable_desc=`${o.alert_type} resolved action results`,a.execution_time=o.resolved_action_execution_time,a.retcode=o.resolved_action_retcode,a.stdout=o.resolved_action_stdout,a.errout=o.resolved_action_errout,a.last_run=o.resolved_action_run),this.$q.dialog({component:Ve,componentProps:{scriptInfo:a}})},alertColor(o){if(o==="error")return"red";if(o==="warning")return"orange";if(o==="info")return"info"},show(){this.$refs.dialog.show()},hide(){this.$refs.dialog.hide()},onHide(){this.$emit("hide")}},mounted(){this.getClients()}},Le={class:"card-header ac jsb"},Be={class:"row ac"},Pe={class:"q-pa-sm col-3"},He={class:"q-pa-sm col-3"},Ge={class:"col-2 pr-1"},Ee={class:"col-2"},je={class:"q-pa-sm col-2"};function Ne(o,e,a,m,n,r){return d(),f(L,{ref:"dialog",onHide:r.onHide,maximized:"","transition-show":"slide-up","transition-hide":"slide-down"},{default:l(()=>[t(E,null,{default:l(()=>[i("div",Le,[e[10]||(e[10]=i("div",{class:"text-h6"},"Alerts",-1)),A(t(x,{dense:"",flat:"",icon:"close"},null,512),[[V]])]),e[19]||(e[19]=i("div",{class:"text-h6 q-pl-sm q-pt-sm"},"Filter",-1)),i("div",Be,[i("div",Pe,[t(T,{modelValue:n.clientFilter,"onUpdate:modelValue":e[0]||(e[0]=s=>n.clientFilter=s),options:n.clientsOptions,label:"Clients",multiple:"",outlined:"",dense:"","use-chips":"","map-options":"","emit-value":""},null,8,["modelValue","options"])]),i("div",He,[t(T,{modelValue:n.severityFilter,"onUpdate:modelValue":e[1]||(e[1]=s=>n.severityFilter=s),options:n.severityOptions,label:"Severity",multiple:"",outlined:"",dense:"","use-chips":"","map-options":"","emit-value":""},null,8,["modelValue","options"])]),i("div",Ge,[t(T,{outlined:"",dense:"",modelValue:n.timeFilter,"onUpdate:modelValue":e[2]||(e[2]=s=>n.timeFilter=s),label:"Time","emit-value":"","map-options":"",options:n.timeOptions},null,8,["modelValue","options"])]),i("div",Ee,[t(H,{outlined:"",dense:"",modelValue:n.includeSnoozed,"onUpdate:modelValue":e[3]||(e[3]=s=>n.includeSnoozed=s),label:"Include snoozed",class:"mr-2"},null,8,["modelValue"]),t(H,{outlined:"",dense:"",modelValue:n.includeResolved,"onUpdate:modelValue":e[4]||(e[4]=s=>n.includeResolved=s),label:"Include resolved",class:"ml-1"},null,8,["modelValue"])]),i("div",je,[i("button",{class:"btn btn-primary",onClick:e[5]||(e[5]=(...s)=>r.search&&r.search(...s))},"Search")])]),t(Y),t(_,null,{default:l(()=>[t(Qe,{"table-class":{"table-bgcolor":!o.$q.dark.isActive,"table-bgcolor-dark":o.$q.dark.isActive},class:"audit-mgr-tbl-sticky",rows:n.alerts,columns:n.columns,"rows-per-page-options":[25,50,100,500,1e3],pagination:n.pagination,"onUpdate:pagination":e[8]||(e[8]=s=>n.pagination=s),"no-data-label":r.noDataText,"visible-columns":r.visibleColumns,selected:n.selectedAlerts,"onUpdate:selected":e[9]||(e[9]=s=>n.selectedAlerts=s),selection:"multiple","binary-state-sort":"","row-key":"id",dense:"","virtual-scroll":""},{top:l(()=>[e[13]||(e[13]=i("div",{class:"col-1 q-table__title"},"Alerts",-1)),t(ee,{flat:"",label:"Bulk Actions",disable:n.selectedAlerts.length===0||n.includeResolved},{default:l(()=>[t(F,{dense:""},{default:l(()=>[A((d(),f(y,{clickable:"",onClick:e[6]||(e[6]=s=>r.snoozeAlertBulk(n.selectedAlerts))},{default:l(()=>[t(b,{avatar:""},{default:l(()=>[t(v,{name:"alarm_off"})]),_:1}),t(b,null,{default:l(()=>[t(U,null,{default:l(()=>e[11]||(e[11]=[u("Snooze alerts")])),_:1})]),_:1})]),_:1})),[[V]]),A((d(),f(y,{clickable:"",onClick:e[7]||(e[7]=s=>r.resolveAlertBulk(n.selectedAlerts))},{default:l(()=>[t(b,{avatar:""},{default:l(()=>[t(v,{name:"flag"})]),_:1}),t(b,null,{default:l(()=>[t(U,null,{default:l(()=>e[12]||(e[12]=[u("Resolve alerts")])),_:1})]),_:1})]),_:1})),[[V]])]),_:1})]),_:1},8,["disable"])]),"body-cell-actions":l(s=>[t(Z,{props:s},{default:l(()=>[s.row.action_run?(d(),f(v,{key:0,name:"mdi-archive-alert",size:"sm",class:"cursor-pointer",onClick:p=>r.showScriptOutput(s.row,!0)},{default:l(()=>[t(k,null,{default:l(()=>e[14]||(e[14]=[u("Show failure action run results")])),_:1})]),_:2},1032,["onClick"])):z("",!0),s.row.resolved_action_run?(d(),f(v,{key:1,name:"mdi-archive-check",size:"sm",class:"cursor-pointer",onClick:p=>r.showScriptOutput(s.row,!1)},{default:l(()=>[t(k,null,{default:l(()=>e[15]||(e[15]=[u("Show resolved action run results")])),_:1})]),_:2},1032,["onClick"])):z("",!0),!s.row.resolved&&!s.row.snoozed?(d(),f(v,{key:2,name:"snooze",size:"sm",class:"cursor-pointer",onClick:p=>r.snoozeAlert(s.row)},{default:l(()=>[t(k,null,{default:l(()=>e[16]||(e[16]=[u("Snooze alert")])),_:1})]),_:2},1032,["onClick"])):!s.row.resolved&&s.row.snoozed?(d(),f(v,{key:3,name:"alarm_off",size:"sm",class:"cursor-pointer",onClick:p=>r.unsnoozeAlert(s.row)},{default:l(()=>[t(k,null,{default:l(()=>e[17]||(e[17]=[u("Unsnooze alert")])),_:1})]),_:2},1032,["onClick"])):z("",!0),s.row.resolved?z("",!0):(d(),f(v,{key:4,name:"flag",size:"sm",class:"cursor-pointer",onClick:p=>r.resolveAlert(s.row)},{default:l(()=>[t(k,null,{default:l(()=>e[18]||(e[18]=[u("Resolve alert")])),_:1})]),_:2},1032,["onClick"]))]),_:2},1032,["props"])]),"body-cell-severity":l(s=>[t(Z,{props:s},{default:l(()=>[t(te,{color:r.alertColor(s.row.severity)},{default:l(()=>[u(q(o.capitalize(s.row.severity)),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),_:1},8,["table-class","rows","columns","pagination","no-data-label","visible-columns","selected"])]),_:1})]),_:1})]),_:1},8,["onHide"])}var We=D(Fe,[["render",Ne]]);const Ze={},Ke={fill:"currentcolor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"};function Je(o,e){return d(),$("svg",Ke,e[0]||(e[0]=[i("g",{id:"SVGRepo_bgCarrier","stroke-width":"0"},null,-1),i("g",{id:"SVGRepo_tracerCarrier","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),i("g",{id:"SVGRepo_iconCarrier"},[i("path",{d:"M10,21h4a2,2,0,0,1-4,0ZM3.076,18.383a1,1,0,0,1,.217-1.09L5,15.586V10a7.006,7.006,0,0,1,6-6.92V2a1,1,0,0,1,2,0V3.08A7.006,7.006,0,0,1,19,10v5.586l1.707,1.707A1,1,0,0,1,20,19H4A1,1,0,0,1,3.076,18.383ZM6.414,17H17.586l-.293-.293A1,1,0,0,1,17,16V10A5,5,0,0,0,7,10v6a1,1,0,0,1-.293.707Z"})],-1)]))}var Ye=D(Ze,[["render",Je]]);const Xe={name:"AlertsIcon",components:{OnlySonar:se,BellIcon:Ye,Icon:le},mixins:[j],setup(){return{getTimeLapse:de}},data(){return{alertsCount:0,topAlerts:[],poll:null}},computed:{...ue(["dash_info_color","dash_warning_color","dash_negative_color"]),badgeColor(){const o=this.topAlerts.map(e=>e.severity);return o.includes("error")?this.dash_negative_color:o.includes("warning")?this.dash_warning_color:this.dash_info_color}},methods:{getAlerts(){this.$axios.patch("alerts/",{top:10}).then(o=>{this.alertsCount=o.data.alerts_count,this.topAlerts=o.data.alerts})},showOverview(){this.$q.dialog({component:We}).onDismiss(()=>{this.getAlerts()})},snoozeAlert(o){this.$q.dialog({title:"Snooze Alert",message:"How many days to snooze alert?",prompt:{model:"",type:"number",isValid:e=>!!e&&e>0&&e<9999},cancel:!0}).onOk(e=>{this.$q.loading.show();const a={id:o.id,type:"snooze",snooze_days:e};this.$axios.put(`alerts/${o.id}/`,a).then(()=>{this.getAlerts(),this.$q.loading.hide(),this.notifySuccess(`The alert has been snoozed for ${e} days`)}).catch(()=>{this.$q.loading.hide()})})},resolveAlert(o){this.$q.loading.show();const e={id:o.id,type:"resolve"};this.$axios.put(`alerts/${o.id}/`,e).then(()=>{this.getAlerts(),this.$q.loading.hide(),this.notifySuccess("The alert has been resolved")}).catch(()=>{this.$q.loading.hide()})},alertIconColor(o){return o==="error"?this.dash_negative_color:o==="warning"?this.dash_warning_color:this.dash_info_color},alertsCountText(){return this.alertsCount>99?"99+":this.alertsCount},pollAlerts(){this.poll=setInterval(()=>{this.getAlerts()},60*1*1e3)}},mounted(){this.getAlerts(),this.pollAlerts()},beforeUnmount(){clearInterval(this.poll)}},et={class:"mr-0 p-0 ac gap-1"};function tt(o,e,a,m,n,r){const s=G("Icon"),p=G("router-link");return d(),$("button",et,[t(s,{width:"20",height:"20",icon:"lucide:bell",class:"header-icon"}),n.alertsCount>0?(d(),f(te,{key:0,color:r.badgeColor,floating:"",transparent:""},{default:l(()=>[u(q(r.alertsCountText()),1)]),_:1},8,["color"])):z("",!0),t(X,{style:pe({"max-height":`${o.$q.screen.height-100}px`})},{default:l(()=>[t(F,{separator:""},{default:l(()=>[n.alertsCount===0?(d(),f(y,{key:0,class:"acc-item ac"},{default:l(()=>e[0]||(e[0]=[u("No Alerts")])),_:1})):z("",!0),(d(!0),$(ce,null,fe(n.topAlerts,h=>(d(),f(y,{class:"acc-item ac",key:h.id},{default:l(()=>[t(b,null,{default:l(()=>[t(U,{overline:""},{default:l(()=>[t(p,{to:`/agents/${h.agent_id}`},{default:l(()=>[u(q(h.client)+" - "+q(h.site)+" - "+q(h.hostname),1)]),_:2},1032,["to"])]),_:2},1024),t(U,{lines:"1"},{default:l(()=>[t(v,{size:"xs",class:me(`text-${r.alertIconColor(h.severity)}`),name:h.severity},null,8,["class","name"]),u(" "+q(h.message),1)]),_:2},1024)]),_:2},1024),t(b,{side:"",top:""},{default:l(()=>[t(U,{caption:""},{default:l(()=>[u(q(m.getTimeLapse(h.alert_time)),1)]),_:2},1024),t(U,null,{default:l(()=>[A((d(),f(v,{name:"snooze",size:"xs",class:"cursor-pointer",onClick:O=>r.snoozeAlert(h)},{default:l(()=>[t(k,null,{default:l(()=>e[1]||(e[1]=[u("Snooze alert")])),_:1})]),_:2},1032,["onClick"])),[[V]]),A((d(),f(v,{name:"flag",size:"xs",class:"cursor-pointer",onClick:O=>r.resolveAlert(h)},{default:l(()=>[t(k,null,{default:l(()=>e[2]||(e[2]=[u("Resolve alert")])),_:1})]),_:2},1032,["onClick"])),[[V]])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),A((d(),f(y,{class:"acc-item ac",clickable:"",onClick:r.showOverview},{default:l(()=>[u("View All Alerts ("+q(n.alertsCount)+")",1)]),_:1},8,["onClick"])),[[V]])]),_:1})]),_:1},8,["style"]),e[3]||(e[3]=u(" Notifications "))])}var ot=D(Xe,[["render",tt]]);const lt={name:"UserPreferences",emits:["hide","ok","cancel"],mixins:[j],data(){return{loadingBarColors:Se,agentDblClickAction:"",defaultAgentTblTab:"",clientTreeSort:"",url_action:null,tab:"ui",splitterModel:20,loading_bar_color:"",dash_info_color:"",dash_positive_color:"",dash_negative_color:"",dash_warning_color:"",urlActions:[],clear_search_when_switching:!0,date_format:"",quasar_color_url:"https://quasar.dev/style/color-palette",clientTreeSortOptions:[{label:"Sort alphabetically, moving failing clients to the top",value:"alphafail"},{label:"Sort alphabetically only",value:"alpha"}],agentDblClickOptions:[{label:"Edit Agent",value:"editagent"},{label:"Take Control",value:"takecontrol"},{label:"Remote Background",value:"remotebg"},{label:"Run URL Action",value:"urlaction"}],defaultAgentTblTabOptions:[{label:"Servers",value:"server"},{label:"Workstations",value:"workstation"},{label:"Mixed",value:"mixed"}]}},watch:{agentDblClickAction(o){o==="urlaction"&&this.getURLActions()}},methods:{openURL(o){De(o)},getURLActions(){this.$axios.get("/core/urlaction/").then(o=>{this.urlActions=o.data.filter(e=>e.action_type==="web").sort((e,a)=>e.name.localeCompare(a.name)).map(e=>({label:e.name,value:e.id})),this.urlActions.length===0&&this.notifyWarning("No URL Actions configured. Go to Sonar Management > General Settings > URL Actions")})},getUserPrefs(){this.$axios.get("/core/dashinfo/").then(o=>{this.agentDblClickAction=o.data.dbl_click_action,this.url_action=o.data.url_action,this.defaultAgentTblTab=o.data.default_agent_tbl_tab,this.clientTreeSort=o.data.client_tree_sort,this.loading_bar_color=o.data.loading_bar_color,this.dash_info_color=o.data.dash_info_color,this.dash_positive_color=o.data.dash_positive_color,this.dash_negative_color=o.data.dash_negative_color,this.dash_warning_color=o.data.dash_warning_color,this.clear_search_when_switching=o.data.clear_search_when_switching,this.date_format=o.data.date_format})},editUserPrefs(){if(this.agentDblClickAction==="urlaction"&&this.url_action===null){this.notifyError("Select a URL Action");return}const o={agent_dblclick_action:this.agentDblClickAction,url_action:this.url_action,default_agent_tbl_tab:this.defaultAgentTblTab,client_tree_sort:this.clientTreeSort,loading_bar_color:this.loading_bar_color,dash_info_color:this.dash_info_color,dash_positive_color:this.dash_positive_color,dash_negative_color:this.dash_negative_color,dash_warning_color:this.dash_warning_color,clear_search_when_switching:this.clear_search_when_switching,date_format:this.date_format};this.$axios.patch("/accounts/users/ui/",o).then(()=>{this.notifySuccess("Preferences were saved!"),this.$store.dispatch("loadTree"),this.onOk()})},show(){this.$refs.dialog.show()},hide(){this.$refs.dialog.hide()},onHide(){this.$emit("hide")},onOk(){this.$emit("ok"),this.hide()}},mounted(){this.getUserPrefs()}};function st(o,e,a,m,n,r){return d(),f(L,{ref:"dialog",onHide:r.onHide},{default:l(()=>[t(E,{class:"q-dialog-plugin p-4",style:{"min-width":"60vw"}},{default:l(()=>[t(Me,{onSubmit:he(r.editUserPrefs,["prevent"])},{default:l(()=>[t(_,{class:"row items-center"},{default:l(()=>[e[15]||(e[15]=i("div",{class:"text-h6"},"Preferences",-1)),t(Oe),A(t(x,{icon:"close",flat:"",round:"",dense:""},null,512),[[V]])]),_:1}),t(Y),t(_,{class:"row"},{default:l(()=>[e[16]||(e[16]=i("div",{class:"col-6"},"Agent double-click action:",-1)),e[17]||(e[17]=i("div",{class:"col-2"},null,-1)),t(T,{"map-options":"","emit-value":"",outlined:"",dense:"","options-dense":"",modelValue:n.agentDblClickAction,"onUpdate:modelValue":[e[0]||(e[0]=s=>n.agentDblClickAction=s),e[1]||(e[1]=s=>n.url_action=null)],options:n.agentDblClickOptions,class:"col-4"},null,8,["modelValue","options"])]),_:1}),n.agentDblClickAction==="urlaction"?(d(),f(_,{key:0,class:"row"},{default:l(()=>[e[18]||(e[18]=i("div",{class:"col-6"},"URL Action:",-1)),e[19]||(e[19]=i("div",{class:"col-2"},null,-1)),t(T,{"map-options":"","emit-value":"",outlined:"",dense:"","options-dense":"",modelValue:n.url_action,"onUpdate:modelValue":e[2]||(e[2]=s=>n.url_action=s),options:n.urlActions,class:"col-4"},null,8,["modelValue","options"])]),_:1})):z("",!0),t(_,{class:"row"},{default:l(()=>[e[20]||(e[20]=i("div",{class:"col-6"},"Agent table default tab:",-1)),e[21]||(e[21]=i("div",{class:"col-2"},null,-1)),t(T,{"map-options":"","emit-value":"",outlined:"",dense:"","options-dense":"",modelValue:n.defaultAgentTblTab,"onUpdate:modelValue":e[3]||(e[3]=s=>n.defaultAgentTblTab=s),options:n.defaultAgentTblTabOptions,class:"col-4"},null,8,["modelValue","options"])]),_:1}),t(_,{class:"row"},{default:l(()=>[e[22]||(e[22]=i("div",{class:"col-4"},"Loading Bar Color:",-1)),e[23]||(e[23]=i("div",{class:"col-4"},null,-1)),t(T,{outlined:"",dense:"","options-dense":"",modelValue:n.loading_bar_color,"onUpdate:modelValue":e[4]||(e[4]=s=>n.loading_bar_color=s),options:n.loadingBarColors,class:"col-4"},null,8,["modelValue","options"])]),_:1}),t(_,{class:"row"},{default:l(()=>[e[25]||(e[25]=i("div",{class:"col-2"},"Dashboard Info Color:",-1)),e[26]||(e[26]=i("div",{class:"col-2"},null,-1)),t(Q,{outlined:"",dense:"",modelValue:n.dash_info_color,"onUpdate:modelValue":e[6]||(e[6]=s=>n.dash_info_color=s),class:"col-8"},{after:l(()=>[t(x,{round:"",dense:"",flat:"",size:"sm",icon:"info",onClick:e[5]||(e[5]=s=>r.openURL(n.quasar_color_url))},{default:l(()=>[t(k,null,{default:l(()=>e[24]||(e[24]=[u("Click to see color options")])),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(_,{class:"row"},{default:l(()=>[e[28]||(e[28]=i("div",{class:"col-2"},"Dashboard Positive Color:",-1)),e[29]||(e[29]=i("div",{class:"col-2"},null,-1)),t(Q,{outlined:"",dense:"",modelValue:n.dash_positive_color,"onUpdate:modelValue":e[8]||(e[8]=s=>n.dash_positive_color=s),class:"col-8"},{after:l(()=>[t(x,{round:"",dense:"",flat:"",size:"sm",icon:"info",onClick:e[7]||(e[7]=s=>r.openURL(n.quasar_color_url))},{default:l(()=>[t(k,null,{default:l(()=>e[27]||(e[27]=[u("Click to see color options")])),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(_,{class:"row"},{default:l(()=>[e[31]||(e[31]=i("div",{class:"col-2"},"Dashboard Negative Color:",-1)),e[32]||(e[32]=i("div",{class:"col-2"},null,-1)),t(Q,{outlined:"",dense:"",modelValue:n.dash_negative_color,"onUpdate:modelValue":e[10]||(e[10]=s=>n.dash_negative_color=s),class:"col-8"},{after:l(()=>[t(x,{round:"",dense:"",flat:"",size:"sm",icon:"info",onClick:e[9]||(e[9]=s=>r.openURL(n.quasar_color_url))},{default:l(()=>[t(k,null,{default:l(()=>e[30]||(e[30]=[u("Click to see color options")])),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(_,{class:"row"},{default:l(()=>[e[34]||(e[34]=i("div",{class:"col-2"},"Dashboard Warning Color:",-1)),e[35]||(e[35]=i("div",{class:"col-2"},null,-1)),t(Q,{outlined:"",dense:"",modelValue:n.dash_warning_color,"onUpdate:modelValue":e[12]||(e[12]=s=>n.dash_warning_color=s),class:"col-8"},{after:l(()=>[t(x,{round:"",dense:"",flat:"",size:"sm",icon:"info",onClick:e[11]||(e[11]=s=>r.openURL(n.quasar_color_url))},{default:l(()=>[t(k,null,{default:l(()=>e[33]||(e[33]=[u("Click to see color options")])),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(_,{class:"row"},{default:l(()=>[e[36]||(e[36]=i("div",{class:"col-2"},"Client Sort:",-1)),e[37]||(e[37]=i("div",{class:"col-2"},null,-1)),t(T,{"map-options":"","emit-value":"",outlined:"",dense:"","options-dense":"",modelValue:n.clientTreeSort,"onUpdate:modelValue":e[13]||(e[13]=s=>n.clientTreeSort=s),options:n.clientTreeSortOptions,class:"col-8"},null,8,["modelValue","options"])]),_:1}),t(_,{class:"row"},{default:l(()=>[t(H,{modelValue:n.clear_search_when_switching,"onUpdate:modelValue":e[14]||(e[14]=s=>n.clear_search_when_switching=s),label:"Clear search field when switching client/site"},null,8,["modelValue"])]),_:1}),e[38]||(e[38]=i("div",{class:"ac justify-end p-3 top-border"},[i("button",{class:"btn btn-primary",type:"submit"},"Save")],-1))]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["onHide"])}var nt=D(lt,[["render",st]]);const it={class:"col-9"},at={class:"col-9"},rt={__name:"ResetPass",emits:[...K.emits],setup(o){const e=C(""),a=C(""),m=C(!0),{dialogRef:n,onDialogHide:r,onDialogOK:s,onDialogCancel:p}=K();async function h(){const O=await xe(e.value);oe(O),s()}return(O,g)=>(d(),f(L,{ref_key:"dialogRef",ref:n,onHide:I(r)},{default:l(()=>[t(E,{class:"q-dialog-plugin",style:{width:"60vw"}},{default:l(()=>[t(_,{class:"row"},{default:l(()=>[g[4]||(g[4]=i("div",{class:"col-3"},"New password:",-1)),i("div",it,[t(Q,{outlined:"",dense:"",modelValue:e.value,"onUpdate:modelValue":g[1]||(g[1]=w=>e.value=w),type:m.value?"password":"text",rules:[w=>!!w||"*Required"]},{append:l(()=>[t(v,{name:m.value?"visibility_off":"visibility",class:"cursor-pointer",onClick:g[0]||(g[0]=w=>m.value=!m.value)},null,8,["name"])]),_:1},8,["modelValue","type","rules"])]),g[5]||(g[5]=i("div",{class:"col-3"},"Confirm password:",-1)),i("div",at,[t(Q,{outlined:"",dense:"",modelValue:a.value,"onUpdate:modelValue":g[3]||(g[3]=w=>a.value=w),type:m.value?"password":"text",rules:[w=>w===e.value||"Passwords do not match"]},{append:l(()=>[t(v,{name:m.value?"visibility_off":"visibility",class:"cursor-pointer",onClick:g[2]||(g[2]=w=>m.value=!m.value)},null,8,["name"])]),_:1},8,["modelValue","type","rules"])])]),_:1}),t(ge,{align:"right"},{default:l(()=>[t(x,{color:"primary",label:"Reset",onClick:h,disable:!e.value||e.value!==a.value},null,8,["disable"]),t(x,{color:"negative",label:"Cancel",onClick:I(p)},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}},dt={},ut={viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function ct(o,e){return d(),$("svg",ut,e[0]||(e[0]=[B('<g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><circle cx="12" cy="9" r="3" stroke="currentcolor" stroke-width="1.5"></circle> <path d="M17.9691 20C17.81 17.1085 16.9247 15 11.9999 15C7.07521 15 6.18991 17.1085 6.03076 20" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round"></path> <path d="M7 3.33782C8.47087 2.48697 10.1786 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 10.1786 2.48697 8.47087 3.33782 7" stroke="currentcolor" stroke-width="1.5" stroke-linecap="round"></path></g>',3)]))}var ft=D(dt,[["render",ct]]);const mt={},pt={viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function ht(o,e){return d(),$("svg",pt,e[0]||(e[0]=[B('<g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M6 5V20" stroke="currentcolor" stroke-width="2" stroke-linecap="round"></path><path d="M12 5V20" stroke="currentcolor" stroke-width="2" stroke-linecap="round"></path><path d="M18 5V20" stroke="currentcolor" stroke-width="2" stroke-linecap="round"></path><path d="M8.5 16C8.5 17.3807 7.38071 18.5 6 18.5C4.61929 18.5 3.5 17.3807 3.5 16C3.5 14.6193 4.61929 13.5 6 13.5C7.38071 13.5 8.5 14.6193 8.5 16Z" fill="currentcolor"></path><path d="M14.5 9C14.5 10.3807 13.3807 11.5 12 11.5C10.6193 11.5 9.5 10.3807 9.5 9C9.5 7.61929 10.6193 6.5 12 6.5C13.3807 6.5 14.5 7.61929 14.5 9Z" fill="currentcolor"></path><path d="M20.5 16C20.5 17.3807 19.3807 18.5 18 18.5C16.6193 18.5 15.5 17.3807 15.5 16C15.5 14.6193 16.6193 13.5 18 13.5C19.3807 13.5 20.5 14.6193 20.5 16Z" fill="currentcolor"></path></g>',3)]))}var gt=D(mt,[["render",ht]]);const _t={},vt={viewBox:"0 0 24 24",id:"Layer_1","data-name":"Layer 1",xmlns:"http://www.w3.org/2000/svg",fill:"currentcolor"};function bt(o,e){return d(),$("svg",vt,e[0]||(e[0]=[B('<g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><defs></defs><circle class="cls-1" cx="12" cy="7.25" r="5.73"></circle><path class="cls-1" d="M1.5,23.48l.37-2.05A10.3,10.3,0,0,1,12,13h0a10.3,10.3,0,0,1,10.13,8.45l.37,2.05"></path></g>',3)]))}var wt=D(_t,[["render",bt]]);const kt={},Ct={viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function yt(o,e){return d(),$("svg",Ct,e[0]||(e[0]=[B('<g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M21 12L13 12" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> <path d="M18 15L20.913 12.087V12.087C20.961 12.039 20.961 11.961 20.913 11.913V11.913L18 9" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> <path d="M16 5V4.5V4.5C16 3.67157 15.3284 3 14.5 3H5C3.89543 3 3 3.89543 3 5V19C3 20.1046 3.89543 21 5 21H14.5C15.3284 21 16 20.3284 16 19.5V19.5V19" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></g>',3)]))}var At=D(kt,[["render",yt]]);const Vt={class:"logo-container"},St={class:"ac"},xt={class:"header-btn"},zt={class:"display-name-container"},Rt={class:"ac"},qt={class:"ac"},Tt={class:"ac"},Kt=_e({__name:"MainLayout",setup(o){const e=J(),a=Ue();function m(){s.value=!s.value}W(Ie());const{displayName:n}=W(ve()),r=C(!1),s=S({get:()=>a.dark.isActive,set:R=>{be.patch("/accounts/users/ui/",{dark_mode:R}),a.dark.set(R)}});S({get:()=>e.state.sidebarOpen,set:R=>e.commit("setSidebarOpen",R)}),S(()=>e.state.currentTRMMVersion),S(()=>e.state.latestTRMMVersion);const p=S(()=>e.state.hosted),h=S(()=>e.state.tokenExpired);S(()=>e.state.dash_warning_color),S(()=>e.state.dash_negative_color);function O(){a.dialog({component:nt}).onOk(()=>e.dispatch("getDashInfo"))}function g(){a.dialog({component:rt})}function w(){a.dialog({title:"Reset 2FA",message:"Are you sure you would like to reset your 2FA token?",cancel:!0,persistent:!0}).onOk(async()=>{try{const R=await ze();oe(R,3e3)}catch{}})}const N=C(null);function ne(){N.value=setInterval(()=>{e.dispatch("checkVer"),e.dispatch("getDashInfo",!1)},60*4*1e3)}return we(()=>{e.dispatch("getDashInfo"),e.dispatch("checkVer"),ne()}),ke(()=>{clearInterval(N.value)}),(R,c)=>{const ie=G("router-view");return d(),f(Te,{view:"hHh lpR fFf"},{default:l(()=>[t(Re,{elevated:"",class:"header text-white"},{default:l(()=>[!p.value&&h.value?(d(),f(Ce,{key:0,"inline-actions":"",class:"bg-yellow text-black text-center"},{default:l(()=>[t(v,{size:"xl",name:"warning"}),c[4]||(c[4]=i("span",null," code not valid ",-1)),t(x,{color:"dark",icon:"refresh",label:"Refresh",onClick:c[0]||(c[0]=M=>R.$store.dispatch("reload"))})]),_:1})):z("",!0),t(ye,{class:"jsb"},{default:l(()=>[i("div",Vt,[t(se,{class:"onlysonar-header cursor-pointer",onClick:m}),c[5]||(c[5]=i("span",{class:"sonar-title-header"}," SONAR",-1))]),i("div",St,[i("button",xt,[t(ot,{class:""})]),p.value?z("",!0):(d(),$("button",{key:0,onClick:c[1]||(c[1]=M=>r.value=!0),class:"header-btn"},[t(I(le),{width:"20",height:"20",icon:"lucide:settings",class:"header-icon mr-1"}),c[6]||(c[6]=u(" General Settings "))])),i("div",zt,[t(ft,{class:"user-icon"}),t(ee,{class:"display-name",flat:"","no-caps":"",stretch:"",label:I(n)||""},{default:l(()=>[t(F,{class:"acc-list"},{default:l(()=>[A((d(),f(y,{class:"acc-item",clickable:"",onClick:O},{default:l(()=>[t(b,null,{default:l(()=>[i("div",Rt,[t(gt,{class:"acc-drop-icon"}),t(b,null,{default:l(()=>c[7]||(c[7]=[u("Preferences")])),_:1})])]),_:1})]),_:1})),[[P],[V]]),t(y,{class:"acc-item",clickable:""},{default:l(()=>[i("div",qt,[t(wt,{class:"acc-drop-icon"}),t(b,null,{default:l(()=>c[8]||(c[8]=[u("Account")])),_:1})]),t(X,{anchor:"top end",self:"top start"},{default:l(()=>[t(F,null,{default:l(()=>[A((d(),f(y,{clickable:"",onClick:g},{default:l(()=>[t(b,null,{default:l(()=>[t(U,null,{default:l(()=>c[9]||(c[9]=[u("Reset Password")])),_:1})]),_:1})]),_:1})),[[P],[V]]),A((d(),f(y,{clickable:"",onClick:w},{default:l(()=>[t(b,null,{default:l(()=>[t(U,null,{default:l(()=>c[10]||(c[10]=[u("Reset 2FA")])),_:1})]),_:1})]),_:1})),[[P],[V]])]),_:1})]),_:1})]),_:1}),t(y,{class:"acc-item",to:"/expired",exact:""},{default:l(()=>[t(b,null,{default:l(()=>[i("div",Tt,[t(At,{class:"acc-drop-icon logout-icon"}),t(b,null,{default:l(()=>c[11]||(c[11]=[u("Logout")])),_:1})])]),_:1})]),_:1})]),_:1})]),_:1},8,["label"])])])]),_:1})]),_:1}),t(qe,null,{default:l(()=>[t(ie)]),_:1}),t(L,{modelValue:r.value,"onUpdate:modelValue":c[3]||(c[3]=M=>r.value=M)},{default:l(()=>[t(Ae,{onClose:c[2]||(c[2]=M=>r.value=!1)})]),_:1},8,["modelValue"])]),_:1})}}});export{Kt as default};
